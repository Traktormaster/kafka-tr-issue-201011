/home/joe/PycharmProjects/.venv/kafka-tr-issue-201011/bin/python /home/joe/PycharmProjects/kafka-tr-issue-201011/demo.py -b 172.31.31.3:9092 -t demoinput1602442758 -o demooutput1602442758 -s
Running in SERIAL mode
The input producer will wait for the reply of the transactor before producing the next message.
Processing took 0.32412052154541016

Send offset times: [0.03687405586242676, 0.0046939849853515625, 0.0030994415283203125, 0.0032117366790771484, 0.0028638839721679688, 0.0030596256256103516, 0.0029315948486328125, 0.0023801326751708984, 0.0024466514587402344, 0.0022928714752197266, 0.0023708343505859375, 0.0023012161254882812, 0.0021407604217529297, 0.002429485321044922, 0.0028045177459716797, 0.003144979476928711, 0.002744436264038086, 0.002740144729614258, 0.0024566650390625, 0.0027399063110351562]
Send offset times average: 0.004486346244812011

Relevant log snippet from the middle:
:DEMO:START 1602442831.653425
%7|1602442831.653|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442831.653|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442831.653|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 34)
%7|1602442831.654|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442831.654|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 34, rtt 0.88ms)
%7|1602442831.654|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 35)
%7|1602442831.654|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 29)
%7|1602442831.655|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 35, rtt 1.14ms)
%7|1602442831.655|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442831.655|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442831.655|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.655|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.655|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 29, rtt 1.28ms)
%7|1602442831.655|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
:DEMO:END   1602442831.6557958 0.0023708343505859375

Full output of the transactor:
%7|1602442828.463|MEMBERID|rdkafka#consumer-1| [thrd:app]: Group "kafka-tr-issue-201011-tr": updating member id "(not-set)" -> ""
%7|1602442828.463|WAKEUPFD|rdkafka#consumer-1| [thrd:app]: GroupCoordinator: Enabled low-latency ops queue wake-ups
%7|1602442828.463|BROKER|rdkafka#consumer-1| [thrd:app]: GroupCoordinator: Added new broker with NodeId -1
%7|1602442828.463|BRKMAIN|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator: Enter main broker thread
%7|1602442828.463|WAKEUPFD|rdkafka#consumer-1| [thrd:app]: 172.31.31.3:9092/bootstrap: Enabled low-latency ops queue wake-ups
%7|1602442828.463|BRKMAIN|rdkafka#consumer-1| [thrd::0/internal]: :0/internal: Enter main broker thread
%7|1602442828.463|BROKER|rdkafka#consumer-1| [thrd:app]: 172.31.31.3:9092/bootstrap: Added new broker with NodeId -1
%7|1602442828.463|BRKMAIN|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enter main broker thread
%7|1602442828.463|INIT|rdkafka#consumer-1| [thrd:app]: librdkafka v1.5.0 (0x10500ff) rdkafka#consumer-1 initialized (builtin.features gzip,snappy,ssl,sasl,regex,lz4,sasl_plain,sasl_scram,plugins,zstd,sasl_oauthbearer, STATIC_LINKING GCC GXX PKGCONFIG INSTALL GNULD LDS LIBDL PLUGINS STATIC_LIB_zlib ZLIB STATIC_LIB_libcrypto STATIC_LIB_libssl SSL STATIC_LIB_libzstd ZSTD HDRHISTOGRAM SYSLOG SNAPPY SOCKEM SASL_SCRAM SASL_OAUTHBEARER CRC32C_HW, debug 0xfffff)
%7|1602442828.463|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op ASSIGN (v0) in state init (join state init, v1 vs 0)
%7|1602442828.463|ASSIGN|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr": new assignment of 1 partition(s) in join state init
%7|1602442828.463|TOPIC|rdkafka#consumer-1| [thrd:main]: New local topic: demoinput1602442758
%7|1602442828.463|TOPPARNEW|rdkafka#consumer-1| [thrd:main]: NEW demoinput1602442758 [-1] 0x7f1834003050 (at rd_kafka_topic_new0:441)
%7|1602442828.463|TOPPARNEW|rdkafka#consumer-1| [thrd:main]: NEW demoinput1602442758 [0] 0x7f18340035b0 (at rd_kafka_toppar_desired_add:618)
%7|1602442828.463|DESIRED|rdkafka#consumer-1| [thrd:main]: demoinput1602442758 [0]: marking as DESIRED
%7|1602442828.463|DESIRED|rdkafka#consumer-1| [thrd:main]: demoinput1602442758 [0]: adding to DESIRED list
%7|1602442828.463|BARRIER|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr": rd_kafka_cgrp_assign:2600: new version barrier v2
%7|1602442828.463|ASSIGN|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr": assigning 1 partition(s) in join state init
%7|1602442828.463|CGRPJOINSTATE|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" changed join state init -> assigned (v2, state init)
%7|1602442828.463|BARRIER|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr": rd_kafka_cgrp_partitions_fetch_start0:1878: new version barrier v3
%7|1602442828.463|FETCHSTART|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr": starting fetchers for 1 assigned partition(s) in join-state assigned (usable_offsets=no, v3, line 2651)
%7|1602442828.463|FETCHSTART|rdkafka#consumer-1| [thrd:main]: List with 1 partition(s):
%7|1602442828.463|FETCHSTART|rdkafka#consumer-1| [thrd:main]:  demoinput1602442758 [0] offset INVALID
%7|1602442828.463|OFFSETFETCH|rdkafka#consumer-1| [thrd:main]: List with 1 partition(s):
%7|1602442828.463|OFFSETFETCH|rdkafka#consumer-1| [thrd:main]:  demoinput1602442758 [0] offset INVALID
%7|1602442828.463|OFFSET|rdkafka#consumer-1| [thrd:main]: Offset fetch error: Local: Waiting for coordinator
%7|1602442828.463|CGRPSTATE|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" changed state init -> query-coord (v3, join-state assigned)
%7|1602442828.463|BROADCAST|rdkafka#consumer-1| [thrd:main]: Broadcasting state change
%7|1602442828.463|CONNECT|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/bootstrap: Selected for cluster connection: coordinator query (broker has 0 connection attempt(s))
%7|1602442828.463|CGRPQUERY|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr": no broker available for coordinator query: intervaled in state query-coord
%7|1602442828.463|CONNECT|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Received CONNECT op
%7|1602442828.463|STATE|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Broker changed state INIT -> TRY_CONNECT
%7|1602442828.463|BROADCAST|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442828.463|CONNECT|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: broker in state TRY_CONNECT connecting
%7|1602442828.463|STATE|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Broker changed state TRY_CONNECT -> CONNECT
%7|1602442828.463|BROADCAST|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442828.464|WAKEUPFD|rdkafka#producer-2| [thrd:main]: TxnCoordinator: Enabled low-latency ops queue wake-ups
%7|1602442828.464|BROKER|rdkafka#producer-2| [thrd:main]: TxnCoordinator: Added new broker with NodeId -1
%7|1602442828.464|WAKEUPFD|rdkafka#producer-2| [thrd:app]: 172.31.31.3:9092/bootstrap: Enabled low-latency ops queue wake-ups
%7|1602442828.464|BRKMAIN|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator: Enter main broker thread
%7|1602442828.464|STATE|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator: Broker changed state INIT -> TRY_CONNECT
%7|1602442828.464|BROADCAST|rdkafka#producer-2| [thrd:TxnCoordinator]: Broadcasting state change
%7|1602442828.464|CONNECT|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator: broker in state TRY_CONNECT connecting
%7|1602442828.464|CONNECT|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator: broker has no address yet: postponing connect
%7|1602442828.464|BROKER|rdkafka#producer-2| [thrd:app]: 172.31.31.3:9092/bootstrap: Added new broker with NodeId -1
%7|1602442828.464|CONNECT|rdkafka#producer-2| [thrd:app]: 172.31.31.3:9092/bootstrap: Selected for cluster connection: bootstrap servers added (broker has 0 connection attempt(s))
%7|1602442828.464|INIT|rdkafka#producer-2| [thrd:app]: librdkafka v1.5.0 (0x10500ff) rdkafka#producer-2 initialized (builtin.features gzip,snappy,ssl,sasl,regex,lz4,sasl_plain,sasl_scram,plugins,zstd,sasl_oauthbearer, STATIC_LINKING GCC GXX PKGCONFIG INSTALL GNULD LDS LIBDL PLUGINS STATIC_LIB_zlib ZLIB STATIC_LIB_libcrypto STATIC_LIB_libssl SSL STATIC_LIB_libzstd ZSTD HDRHISTOGRAM SYSLOG SNAPPY SOCKEM SASL_SCRAM SASL_OAUTHBEARER CRC32C_HW, debug 0xfffff)
%7|1602442828.464|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: init_transactions
%7|1602442828.464|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Init -> WaitPID
%7|1602442828.464|IDEMPSTATE|rdkafka#producer-2| [thrd:main]: Idempotent producer state change Init -> RequestPID
%7|1602442828.464|TXN|rdkafka#producer-2| [thrd:main]: Starting PID FSM timer (fire immediately): Starting idempotent producer
%7|1602442828.464|CONNECT|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Connecting to ipv4#172.31.31.3:9092 (plaintext) with socket 9
%7|1602442828.464|CONNECT|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Connected to ipv4#172.31.31.3:9092
%7|1602442828.464|CONNECTED|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Connected (#1)
%7|1602442828.464|FEATURE|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Updated enabled protocol features +ApiVersion to ApiVersion
%7|1602442828.464|STATE|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Broker changed state CONNECT -> APIVERSION_QUERY
%7|1602442828.464|BROADCAST|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442828.464|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Sent ApiVersionRequest (v3, 66 bytes @ 0, CorrId 1)
%7|1602442828.464|BRKMAIN|rdkafka#producer-2| [thrd::0/internal]: :0/internal: Enter main broker thread
%7|1602442828.464|BRKMAIN|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enter main broker thread
%7|1602442828.464|CONNECT|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Received CONNECT op
%7|1602442828.464|STATE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Broker changed state INIT -> TRY_CONNECT
%7|1602442828.464|BROADCAST|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442828.464|CONNECT|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: broker in state TRY_CONNECT connecting
%7|1602442828.464|STATE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Broker changed state TRY_CONNECT -> CONNECT
%7|1602442828.464|BROADCAST|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442828.464|CONNECT|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Connecting to ipv4#172.31.31.3:9092 (plaintext) with socket 14
%7|1602442828.464|CONNECT|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Connected to ipv4#172.31.31.3:9092
%7|1602442828.464|CONNECTED|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Connected (#1)
%7|1602442828.464|FEATURE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Updated enabled protocol features +ApiVersion to ApiVersion
%7|1602442828.464|STATE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Broker changed state CONNECT -> APIVERSION_QUERY
%7|1602442828.464|BROADCAST|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442828.464|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Sent ApiVersionRequest (v3, 66 bytes @ 0, CorrId 1)
%7|1602442828.465|CONNECT|rdkafka#producer-2| [thrd:main]: Not selecting any broker for cluster connection: still suppressed for 48ms: acquire ProducerID
%7|1602442828.465|PIDBROKER|rdkafka#producer-2| [thrd:main]: No brokers available for Transactions (2 broker(s) known)
%7|1602442828.465|TXNCOORD|rdkafka#producer-2| [thrd:main]: Unable to query for transaction coordinator: No brokers available for Transactions (2 broker(s) known)
%7|1602442828.466|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Received ApiVersionResponse (v3, 344 bytes, CorrId 1, rtt 2.24ms)
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Broker API support:
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Produce (0) Versions 0..8
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Fetch (1) Versions 0..11
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Offset (2) Versions 0..5
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Metadata (3) Versions 0..9
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey LeaderAndIsr (4) Versions 0..4
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey StopReplica (5) Versions 0..2
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey UpdateMetadata (6) Versions 0..6
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey ControlledShutdown (7) Versions 0..3
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey OffsetCommit (8) Versions 0..8
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey OffsetFetch (9) Versions 0..7
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey FindCoordinator (10) Versions 0..3
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey JoinGroup (11) Versions 0..7
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Heartbeat (12) Versions 0..4
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey LeaveGroup (13) Versions 0..4
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey SyncGroup (14) Versions 0..5
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DescribeGroups (15) Versions 0..5
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey ListGroups (16) Versions 0..3
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey SaslHandshake (17) Versions 0..1
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey ApiVersion (18) Versions 0..3
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey CreateTopics (19) Versions 0..5
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DeleteTopics (20) Versions 0..4
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DeleteRecords (21) Versions 0..1
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey InitProducerId (22) Versions 0..3
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey OffsetForLeaderEpoch (23) Versions 0..3
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey AddPartitionsToTxn (24) Versions 0..1
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey AddOffsetsToTxn (25) Versions 0..1
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey EndTxn (26) Versions 0..1
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey WriteTxnMarkers (27) Versions 0..0
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey TxnOffsetCommit (28) Versions 0..3
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DescribeAcls (29) Versions 0..2
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey CreateAcls (30) Versions 0..2
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DeleteAcls (31) Versions 0..2
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DescribeConfigs (32) Versions 0..2
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey AlterConfigs (33) Versions 0..1
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey AlterReplicaLogDirs (34) Versions 0..1
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DescribeLogDirs (35) Versions 0..1
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey SaslAuthenticate (36) Versions 0..2
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey CreatePartitions (37) Versions 0..2
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey CreateDelegationToken (38) Versions 0..2
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey RenewDelegationToken (39) Versions 0..2
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey ExpireDelegationToken (40) Versions 0..2
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DescribeDelegationToken (41) Versions 0..2
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DeleteGroups (42) Versions 0..2
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Unknown-43? (43) Versions 0..2
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Unknown-44? (44) Versions 0..1
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Unknown-45? (45) Versions 0..0
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Unknown-46? (46) Versions 0..0
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Unknown-47? (47) Versions 0..0
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature MsgVer1: Produce (2..2) supported by broker
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature MsgVer1: Fetch (2..2) supported by broker
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature MsgVer1
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature MsgVer2: Produce (3..3) supported by broker
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature MsgVer2: Fetch (4..4) supported by broker
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature MsgVer2
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature ApiVersion: ApiVersion (0..0) supported by broker
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature ApiVersion
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerGroupCoordinator: FindCoordinator (0..0) supported by broker
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature BrokerGroupCoordinator
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: FindCoordinator (0..0) supported by broker
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: OffsetCommit (1..2) supported by broker
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: OffsetFetch (1..1) supported by broker
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: JoinGroup (0..0) supported by broker
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: SyncGroup (0..0) supported by broker
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: Heartbeat (0..0) supported by broker
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: LeaveGroup (0..0) supported by broker
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature BrokerBalancedConsumer
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature ThrottleTime: Produce (1..2) supported by broker
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature ThrottleTime: Fetch (1..2) supported by broker
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature ThrottleTime
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature Sasl: JoinGroup (0..0) supported by broker
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature Sasl
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature SaslHandshake: SaslHandshake (0..0) supported by broker
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature SaslHandshake
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature LZ4: FindCoordinator (0..0) supported by broker
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature LZ4
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature OffsetTime: Offset (1..1) supported by broker
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature OffsetTime
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature IdempotentProducer: InitProducerId (0..0) supported by broker
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature IdempotentProducer
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature ZSTD: Produce (7..7) supported by broker
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature ZSTD: Fetch (10..10) supported by broker
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature ZSTD
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature SaslAuthReq: SaslHandshake (1..1) supported by broker
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature SaslAuthReq: SaslAuthenticate (0..0) supported by broker
%7|1602442828.466|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature SaslAuthReq
%7|1602442828.466|FEATURE|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Updated enabled protocol features to MsgVer1,ApiVersion,BrokerBalancedConsumer,ThrottleTime,Sasl,SaslHandshake,BrokerGroupCoordinator,LZ4,OffsetTime,MsgVer2,IdempotentProducer,ZSTD,SaslAuthReq
%7|1602442828.466|STATE|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Broker changed state APIVERSION_QUERY -> UP
%7|1602442828.466|BROADCAST|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442828.466|METADATA|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Hinted cache of 1/1 topic(s) being queried
%7|1602442828.466|METADATA|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Requesting metadata for 1/1 topics: connected
%7|1602442828.466|METADATA|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Request metadata for 1 topic(s): connected
%7|1602442828.466|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Sent MetadataRequest (v4, 54 bytes @ 0, CorrId 2)
%7|1602442828.466|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Received ApiVersionResponse (v3, 344 bytes, CorrId 1, rtt 2.10ms)
%7|1602442828.466|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Broker API support:
%7|1602442828.466|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Produce (0) Versions 0..8
%7|1602442828.466|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Fetch (1) Versions 0..11
%7|1602442828.466|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Offset (2) Versions 0..5
%7|1602442828.466|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Metadata (3) Versions 0..9
%7|1602442828.466|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey LeaderAndIsr (4) Versions 0..4
%7|1602442828.466|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey StopReplica (5) Versions 0..2
%7|1602442828.466|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey UpdateMetadata (6) Versions 0..6
%7|1602442828.466|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey ControlledShutdown (7) Versions 0..3
%7|1602442828.466|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey OffsetCommit (8) Versions 0..8
%7|1602442828.466|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey OffsetFetch (9) Versions 0..7
%7|1602442828.466|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey FindCoordinator (10) Versions 0..3
%7|1602442828.466|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey JoinGroup (11) Versions 0..7
%7|1602442828.466|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Heartbeat (12) Versions 0..4
%7|1602442828.466|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey LeaveGroup (13) Versions 0..4
%7|1602442828.466|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey SyncGroup (14) Versions 0..5
%7|1602442828.466|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DescribeGroups (15) Versions 0..5
%7|1602442828.466|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey ListGroups (16) Versions 0..3
%7|1602442828.466|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey SaslHandshake (17) Versions 0..1
%7|1602442828.466|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey ApiVersion (18) Versions 0..3
%7|1602442828.466|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey CreateTopics (19) Versions 0..5
%7|1602442828.466|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DeleteTopics (20) Versions 0..4
%7|1602442828.466|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DeleteRecords (21) Versions 0..1
%7|1602442828.466|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey InitProducerId (22) Versions 0..3
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey OffsetForLeaderEpoch (23) Versions 0..3
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey AddPartitionsToTxn (24) Versions 0..1
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey AddOffsetsToTxn (25) Versions 0..1
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey EndTxn (26) Versions 0..1
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey WriteTxnMarkers (27) Versions 0..0
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey TxnOffsetCommit (28) Versions 0..3
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DescribeAcls (29) Versions 0..2
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey CreateAcls (30) Versions 0..2
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DeleteAcls (31) Versions 0..2
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DescribeConfigs (32) Versions 0..2
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey AlterConfigs (33) Versions 0..1
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey AlterReplicaLogDirs (34) Versions 0..1
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DescribeLogDirs (35) Versions 0..1
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey SaslAuthenticate (36) Versions 0..2
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey CreatePartitions (37) Versions 0..2
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey CreateDelegationToken (38) Versions 0..2
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey RenewDelegationToken (39) Versions 0..2
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey ExpireDelegationToken (40) Versions 0..2
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DescribeDelegationToken (41) Versions 0..2
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DeleteGroups (42) Versions 0..2
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Unknown-43? (43) Versions 0..2
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Unknown-44? (44) Versions 0..1
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Unknown-45? (45) Versions 0..0
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Unknown-46? (46) Versions 0..0
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Unknown-47? (47) Versions 0..0
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature MsgVer1: Produce (2..2) supported by broker
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature MsgVer1: Fetch (2..2) supported by broker
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature MsgVer1
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature MsgVer2: Produce (3..3) supported by broker
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature MsgVer2: Fetch (4..4) supported by broker
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature MsgVer2
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature ApiVersion: ApiVersion (0..0) supported by broker
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature ApiVersion
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerGroupCoordinator: FindCoordinator (0..0) supported by broker
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature BrokerGroupCoordinator
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: FindCoordinator (0..0) supported by broker
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: OffsetCommit (1..2) supported by broker
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: OffsetFetch (1..1) supported by broker
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: JoinGroup (0..0) supported by broker
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: SyncGroup (0..0) supported by broker
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: Heartbeat (0..0) supported by broker
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: LeaveGroup (0..0) supported by broker
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature BrokerBalancedConsumer
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature ThrottleTime: Produce (1..2) supported by broker
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature ThrottleTime: Fetch (1..2) supported by broker
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature ThrottleTime
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature Sasl: JoinGroup (0..0) supported by broker
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature Sasl
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature SaslHandshake: SaslHandshake (0..0) supported by broker
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature SaslHandshake
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature LZ4: FindCoordinator (0..0) supported by broker
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature LZ4
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature OffsetTime: Offset (1..1) supported by broker
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature OffsetTime
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature IdempotentProducer: InitProducerId (0..0) supported by broker
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature IdempotentProducer
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature ZSTD: Produce (7..7) supported by broker
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature ZSTD: Fetch (10..10) supported by broker
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature ZSTD
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature SaslAuthReq: SaslHandshake (1..1) supported by broker
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature SaslAuthReq: SaslAuthenticate (0..0) supported by broker
%7|1602442828.467|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature SaslAuthReq
%7|1602442828.467|FEATURE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Updated enabled protocol features to MsgVer1,ApiVersion,BrokerBalancedConsumer,ThrottleTime,Sasl,SaslHandshake,BrokerGroupCoordinator,LZ4,OffsetTime,MsgVer2,IdempotentProducer,ZSTD,SaslAuthReq
%7|1602442828.467|STATE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Broker changed state APIVERSION_QUERY -> UP
%7|1602442828.467|BROADCAST|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442828.467|METADATA|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Request metadata for brokers only: connected
%7|1602442828.467|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Sent MetadataRequest (v4, 26 bytes @ 0, CorrId 2)
%7|1602442828.467|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Received MetadataResponse (v4, 124 bytes, CorrId 2, rtt 1.03ms)
%7|1602442828.467|METADATA|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/bootstrap: ===== Received metadata (for 1 requested topics): connected =====
%7|1602442828.467|METADATA|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/bootstrap: ClusterId: P3Dm2isBTn-IXhcu_D5JSw, ControllerId: 1001
%7|1602442828.467|METADATA|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/bootstrap: 1 brokers, 1 topics
%7|1602442828.467|METADATA|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/bootstrap:   Broker #0/1: 172.31.31.3:9092 NodeId 1001
%7|1602442828.467|METADATA|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/bootstrap:   Topic #0/1: demoinput1602442758 with 1 partitions
%7|1602442828.467|STATE|rdkafka#consumer-1| [thrd:main]: Topic demoinput1602442758 changed state unknown -> exists
%7|1602442828.467|PARTCNT|rdkafka#consumer-1| [thrd:main]: Topic demoinput1602442758 partition count changed from 0 to 1
%7|1602442828.467|METADATA|rdkafka#consumer-1| [thrd:main]:   Topic demoinput1602442758 partition 0 Leader 1001
%7|1602442828.467|BRKDELGT|rdkafka#consumer-1| [thrd:main]: demoinput1602442758 [0]: delegate to broker (none) (rktp 0x7f18340035b0, term 0, ref 3)
%7|1602442828.467|BRKDELGT|rdkafka#consumer-1| [thrd:main]: demoinput1602442758 [0]: delegating to broker :0/internal for partition with 0 messages (0 bytes) queued
%7|1602442828.467|BRKMIGR|rdkafka#consumer-1| [thrd:main]: Migrating topic demoinput1602442758 [0] 0x7f18340035b0 from (none) to :0/internal (sending PARTITION_JOIN to :0/internal)
%7|1602442828.467|METADATA|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/bootstrap: 1/1 requested topic(s) seen in metadata
%7|1602442828.467|CLUSTERID|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/bootstrap: ClusterId update "" -> "P3Dm2isBTn-IXhcu_D5JSw"
%7|1602442828.467|CONTROLLERID|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/bootstrap: ControllerId update -1 -> 1001
%7|1602442828.467|BROADCAST|rdkafka#consumer-1| [thrd:main]: Broadcasting state change
%7|1602442828.467|TOPBRK|rdkafka#consumer-1| [thrd::0/internal]: :0/internal: Topic demoinput1602442758 [0]: joining broker (rktp 0x7f18340035b0, 0 message(s) queued)
%7|1602442828.467|BROADCAST|rdkafka#consumer-1| [thrd::0/internal]: Broadcasting state change
%7|1602442828.467|UPDATE|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: NodeId changed from -1 to 1001
%7|1602442828.467|UPDATE|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Name changed from 172.31.31.3:9092/bootstrap to 172.31.31.3:9092/1001
%7|1602442828.467|TOPICUPD|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Topic demoinput1602442758 [0]: migrating from broker -1 to 1001 (leader is 1001): broker node information updated
%7|1602442828.467|BRKDELGT|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: demoinput1602442758 [0]: delegate to broker 172.31.31.3:9092/1001 (rktp 0x7f18340035b0, term 0, ref 3)
%7|1602442828.467|BRKDELGT|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: demoinput1602442758 [0]: no longer delegated to broker :0/internal
%7|1602442828.467|BRKDELGT|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: demoinput1602442758 [0]: delegating to broker 172.31.31.3:9092/1001 for partition with 0 messages (0 bytes) queued
%7|1602442828.467|BRKMIGR|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Migrating topic demoinput1602442758 [0] 0x7f18340035b0 from :0/internal to 172.31.31.3:9092/1001 (sending PARTITION_LEAVE to :0/internal)
%7|1602442828.467|LEADER|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Mapped 1 partition(s) to broker
%7|1602442828.467|STATE|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Broker changed state UP -> UPDATE
%7|1602442828.467|BROADCAST|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442828.467|BROADCAST|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442828.467|STATE|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Broker changed state UPDATE -> UP
%7|1602442828.467|TOPBRK|rdkafka#consumer-1| [thrd::0/internal]: :0/internal: Topic demoinput1602442758 [0]: leaving broker (0 messages in xmitq, next broker 172.31.31.3:9092/1001, rktp 0x7f18340035b0)
%7|1602442828.467|CGRPQUERY|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/bootstrap: Group "kafka-tr-issue-201011-tr": querying for coordinator: intervaled in state query-coord
%7|1602442828.467|BROADCAST|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442828.467|BROADCAST|rdkafka#consumer-1| [thrd::0/internal]: Broadcasting state change
%7|1602442828.467|TOPBRK|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0]: joining broker (rktp 0x7f18340035b0, 0 message(s) queued)
%7|1602442828.467|BROADCAST|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442828.467|CGRPSTATE|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" changed state query-coord -> wait-coord (v3, join-state assigned)
%7|1602442828.467|BROADCAST|rdkafka#consumer-1| [thrd:main]: Broadcasting state change
%7|1602442828.467|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FindCoordinatorRequest (v2, 48 bytes @ 0, CorrId 3)
%7|1602442828.468|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Received MetadataResponse (v4, 63 bytes, CorrId 2, rtt 1.23ms)
%7|1602442828.468|METADATA|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/bootstrap: ===== Received metadata: connected =====
%7|1602442828.468|METADATA|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/bootstrap: ClusterId: P3Dm2isBTn-IXhcu_D5JSw, ControllerId: 1001
%7|1602442828.468|METADATA|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/bootstrap: 1 brokers, 0 topics
%7|1602442828.468|METADATA|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/bootstrap:   Broker #0/1: 172.31.31.3:9092 NodeId 1001
%7|1602442828.468|CLUSTERID|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/bootstrap: ClusterId update "" -> "P3Dm2isBTn-IXhcu_D5JSw"
%7|1602442828.468|CONTROLLERID|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/bootstrap: ControllerId update -1 -> 1001
%7|1602442828.468|BROADCAST|rdkafka#producer-2| [thrd:main]: Broadcasting state change
%7|1602442828.468|UPDATE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: NodeId changed from -1 to 1001
%7|1602442828.468|UPDATE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Name changed from 172.31.31.3:9092/bootstrap to 172.31.31.3:9092/1001
%7|1602442828.468|LEADER|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Mapped 0 partition(s) to broker
%7|1602442828.468|STATE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Broker changed state UP -> UPDATE
%7|1602442828.468|BROADCAST|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442828.468|BROADCAST|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442828.468|STATE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Broker changed state UPDATE -> UP
%7|1602442828.468|BROADCAST|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442828.468|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FindCoordinatorRequest (v2, 43 bytes @ 0, CorrId 3)
%7|1602442828.474|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FindCoordinatorResponse (v2, 51 bytes, CorrId 3, rtt 6.39ms)
%7|1602442828.474|CGRPCOORD|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/1001: Group "kafka-tr-issue-201011-tr" FindCoordinator response error: COORDINATOR_NOT_AVAILABLE: The coordinator is not available.
%7|1602442828.474|CGRPSTATE|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" changed state wait-coord -> query-coord (v3, join-state assigned)
%7|1602442828.474|BROADCAST|rdkafka#consumer-1| [thrd:main]: Broadcasting state change
%7|1602442828.497|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FindCoordinatorResponse (v2, 51 bytes, CorrId 3, rtt 28.88ms)
%7|1602442828.497|TXNCOORD|rdkafka#producer-2| [thrd:main]: Failed to find transaction coordinator: COORDINATOR_NOT_AVAILABLE: The coordinator is not available.
%7|1602442828.997|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FindCoordinatorRequest (v2, 43 bytes @ 0, CorrId 4)
%7|1602442829.001|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FindCoordinatorResponse (v2, 51 bytes, CorrId 4, rtt 4.20ms)
%7|1602442829.001|TXNCOORD|rdkafka#producer-2| [thrd:main]: Failed to find transaction coordinator: COORDINATOR_NOT_AVAILABLE: The coordinator is not available.
%7|1602442829.463|CGRPQUERY|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/1001: Group "kafka-tr-issue-201011-tr": querying for coordinator: intervaled in state query-coord
%7|1602442829.463|CGRPSTATE|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" changed state query-coord -> wait-coord (v3, join-state assigned)
%7|1602442829.463|BROADCAST|rdkafka#consumer-1| [thrd:main]: Broadcasting state change
%7|1602442829.463|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FindCoordinatorRequest (v2, 48 bytes @ 0, CorrId 4)
%7|1602442829.464|CONNECT|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator: broker in state TRY_CONNECT connecting
%7|1602442829.464|CONNECT|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator: broker has no address yet: postponing connect
%7|1602442829.464|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FindCoordinatorResponse (v2, 33 bytes, CorrId 4, rtt 1.37ms)
%7|1602442829.464|CGRPCOORD|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/1001: Group "kafka-tr-issue-201011-tr" coordinator is 172.31.31.3:9092 id 1001
%7|1602442829.464|CGRPCOORD|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" changing coordinator -1 -> 1001
%7|1602442829.464|COORDSET|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" coordinator set to broker 172.31.31.3:9092/1001
%7|1602442829.464|CGRPSTATE|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" changed state wait-coord -> wait-broker-transport (v3, join-state assigned)
%7|1602442829.464|BROADCAST|rdkafka#consumer-1| [thrd:main]: Broadcasting state change
%7|1602442829.464|NODENAME|rdkafka#consumer-1| [thrd:main]: GroupCoordinator: Broker nodename changed from "" to "172.31.31.3:9092"
%7|1602442829.464|CONNECT|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator: Received CONNECT op
%7|1602442829.464|STATE|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator: Broker changed state INIT -> TRY_CONNECT
%7|1602442829.464|BROADCAST|rdkafka#consumer-1| [thrd:GroupCoordinator]: Broadcasting state change
%7|1602442829.464|CGRPQUERY|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/1001: Group "kafka-tr-issue-201011-tr": querying for coordinator: intervaled in state wait-broker-transport
%7|1602442829.464|FAIL|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Closing connection due to nodename change (after 0ms in state TRY_CONNECT) (_TRANSPORT)
%7|1602442829.464|STATE|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator: Broker changed state TRY_CONNECT -> DOWN
%7|1602442829.464|BROADCAST|rdkafka#consumer-1| [thrd:GroupCoordinator]: Broadcasting state change
%7|1602442829.464|BUFQ|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Purging bufq with 0 buffers
%7|1602442829.464|BUFQ|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Purging bufq with 0 buffers
%7|1602442829.464|BUFQ|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Updating 0 buffers on connection reset
%7|1602442829.464|STATE|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator: Broker changed state DOWN -> INIT
%7|1602442829.464|BROADCAST|rdkafka#consumer-1| [thrd:GroupCoordinator]: Broadcasting state change
%7|1602442829.464|STATE|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator: Broker changed state INIT -> TRY_CONNECT
%7|1602442829.464|BROADCAST|rdkafka#consumer-1| [thrd:GroupCoordinator]: Broadcasting state change
%7|1602442829.464|CONNECT|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: broker in state TRY_CONNECT connecting
%7|1602442829.464|STATE|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator: Broker changed state TRY_CONNECT -> CONNECT
%7|1602442829.464|BROADCAST|rdkafka#consumer-1| [thrd:GroupCoordinator]: Broadcasting state change
%7|1602442829.464|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FindCoordinatorRequest (v2, 48 bytes @ 0, CorrId 5)
%7|1602442829.464|CONNECT|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Connecting to ipv4#172.31.31.3:9092 (plaintext) with socket 17
%7|1602442829.465|CONNECT|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Connected to ipv4#172.31.31.3:9092
%7|1602442829.465|CONNECTED|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Connected (#1)
%7|1602442829.465|FEATURE|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Updated enabled protocol features +ApiVersion to ApiVersion
%7|1602442829.465|STATE|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator: Broker changed state CONNECT -> APIVERSION_QUERY
%7|1602442829.465|BROADCAST|rdkafka#consumer-1| [thrd:GroupCoordinator]: Broadcasting state change
%7|1602442829.465|SEND|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Sent ApiVersionRequest (v3, 66 bytes @ 0, CorrId 1)
%7|1602442829.466|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FindCoordinatorResponse (v2, 33 bytes, CorrId 5, rtt 1.08ms)
%7|1602442829.466|CGRPCOORD|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/1001: Group "kafka-tr-issue-201011-tr" coordinator is 172.31.31.3:9092 id 1001
%7|1602442829.466|RECV|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Received ApiVersionResponse (v3, 344 bytes, CorrId 1, rtt 1.47ms)
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Broker API support:
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey Produce (0) Versions 0..8
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey Fetch (1) Versions 0..11
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey Offset (2) Versions 0..5
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey Metadata (3) Versions 0..9
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey LeaderAndIsr (4) Versions 0..4
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey StopReplica (5) Versions 0..2
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey UpdateMetadata (6) Versions 0..6
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey ControlledShutdown (7) Versions 0..3
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey OffsetCommit (8) Versions 0..8
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey OffsetFetch (9) Versions 0..7
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey FindCoordinator (10) Versions 0..3
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey JoinGroup (11) Versions 0..7
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey Heartbeat (12) Versions 0..4
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey LeaveGroup (13) Versions 0..4
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey SyncGroup (14) Versions 0..5
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey DescribeGroups (15) Versions 0..5
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey ListGroups (16) Versions 0..3
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey SaslHandshake (17) Versions 0..1
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey ApiVersion (18) Versions 0..3
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey CreateTopics (19) Versions 0..5
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey DeleteTopics (20) Versions 0..4
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey DeleteRecords (21) Versions 0..1
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey InitProducerId (22) Versions 0..3
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey OffsetForLeaderEpoch (23) Versions 0..3
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey AddPartitionsToTxn (24) Versions 0..1
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey AddOffsetsToTxn (25) Versions 0..1
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey EndTxn (26) Versions 0..1
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey WriteTxnMarkers (27) Versions 0..0
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey TxnOffsetCommit (28) Versions 0..3
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey DescribeAcls (29) Versions 0..2
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey CreateAcls (30) Versions 0..2
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey DeleteAcls (31) Versions 0..2
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey DescribeConfigs (32) Versions 0..2
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey AlterConfigs (33) Versions 0..1
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey AlterReplicaLogDirs (34) Versions 0..1
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey DescribeLogDirs (35) Versions 0..1
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey SaslAuthenticate (36) Versions 0..2
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey CreatePartitions (37) Versions 0..2
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey CreateDelegationToken (38) Versions 0..2
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey RenewDelegationToken (39) Versions 0..2
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey ExpireDelegationToken (40) Versions 0..2
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey DescribeDelegationToken (41) Versions 0..2
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey DeleteGroups (42) Versions 0..2
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey Unknown-43? (43) Versions 0..2
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey Unknown-44? (44) Versions 0..1
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey Unknown-45? (45) Versions 0..0
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey Unknown-46? (46) Versions 0..0
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey Unknown-47? (47) Versions 0..0
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature MsgVer1: Produce (2..2) supported by broker
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature MsgVer1: Fetch (2..2) supported by broker
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature MsgVer1
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature MsgVer2: Produce (3..3) supported by broker
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature MsgVer2: Fetch (4..4) supported by broker
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature MsgVer2
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature ApiVersion: ApiVersion (0..0) supported by broker
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature ApiVersion
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature BrokerGroupCoordinator: FindCoordinator (0..0) supported by broker
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature BrokerGroupCoordinator
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature BrokerBalancedConsumer: FindCoordinator (0..0) supported by broker
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature BrokerBalancedConsumer: OffsetCommit (1..2) supported by broker
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature BrokerBalancedConsumer: OffsetFetch (1..1) supported by broker
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature BrokerBalancedConsumer: JoinGroup (0..0) supported by broker
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature BrokerBalancedConsumer: SyncGroup (0..0) supported by broker
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature BrokerBalancedConsumer: Heartbeat (0..0) supported by broker
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature BrokerBalancedConsumer: LeaveGroup (0..0) supported by broker
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature BrokerBalancedConsumer
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature ThrottleTime: Produce (1..2) supported by broker
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature ThrottleTime: Fetch (1..2) supported by broker
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature ThrottleTime
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature Sasl: JoinGroup (0..0) supported by broker
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature Sasl
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature SaslHandshake: SaslHandshake (0..0) supported by broker
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature SaslHandshake
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature LZ4: FindCoordinator (0..0) supported by broker
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature LZ4
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature OffsetTime: Offset (1..1) supported by broker
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature OffsetTime
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature IdempotentProducer: InitProducerId (0..0) supported by broker
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature IdempotentProducer
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature ZSTD: Produce (7..7) supported by broker
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature ZSTD: Fetch (10..10) supported by broker
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature ZSTD
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature SaslAuthReq: SaslHandshake (1..1) supported by broker
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature SaslAuthReq: SaslAuthenticate (0..0) supported by broker
%7|1602442829.466|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature SaslAuthReq
%7|1602442829.466|FEATURE|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Updated enabled protocol features to MsgVer1,ApiVersion,BrokerBalancedConsumer,ThrottleTime,Sasl,SaslHandshake,BrokerGroupCoordinator,LZ4,OffsetTime,MsgVer2,IdempotentProducer,ZSTD,SaslAuthReq
%7|1602442829.466|STATE|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator: Broker changed state APIVERSION_QUERY -> UP
%7|1602442829.466|BROADCAST|rdkafka#consumer-1| [thrd:GroupCoordinator]: Broadcasting state change
%7|1602442829.466|METADATA|rdkafka#consumer-1| [thrd:GroupCoordinator]: Skipping metadata refresh of 1 topic(s): connected: already being requested
%7|1602442829.501|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FindCoordinatorRequest (v2, 43 bytes @ 0, CorrId 5)
%7|1602442829.505|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FindCoordinatorResponse (v2, 51 bytes, CorrId 5, rtt 3.78ms)
%7|1602442829.505|TXNCOORD|rdkafka#producer-2| [thrd:main]: Failed to find transaction coordinator: COORDINATOR_NOT_AVAILABLE: The coordinator is not available.
%7|1602442830.005|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FindCoordinatorRequest (v2, 43 bytes @ 0, CorrId 6)
%7|1602442830.006|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FindCoordinatorResponse (v2, 33 bytes, CorrId 6, rtt 1.20ms)
%7|1602442830.006|TXNCOORD|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: FindCoordinator response: Transaction coordinator is broker 1001 (172.31.31.3:9092)
%7|1602442830.006|TXNCOORD|rdkafka#producer-2| [thrd:main]: Transaction coordinator changed from (none) -> 172.31.31.3:9092/1001: FindCoordinator response
%7|1602442830.006|NODENAME|rdkafka#producer-2| [thrd:main]: TxnCoordinator: Broker nodename changed from "" to "172.31.31.3:9092"
%7|1602442830.006|IDEMPSTATE|rdkafka#producer-2| [thrd:main]: Idempotent producer state change RequestPID -> WaitTransport
%7|1602442830.006|TXN|rdkafka#producer-2| [thrd:main]: Starting PID FSM timer: No broker available
%7|1602442830.006|FAIL|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Closing connection due to nodename change (after 1542ms in state TRY_CONNECT) (_TRANSPORT)
%7|1602442830.006|STATE|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator: Broker changed state TRY_CONNECT -> DOWN
%7|1602442830.007|BROADCAST|rdkafka#producer-2| [thrd:TxnCoordinator]: Broadcasting state change
%7|1602442830.007|BUFQ|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Purging bufq with 0 buffers
%7|1602442830.007|BUFQ|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Purging bufq with 0 buffers
%7|1602442830.007|BUFQ|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Updating 0 buffers on connection reset
%7|1602442830.007|STATE|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator: Broker changed state DOWN -> INIT
%7|1602442830.007|BROADCAST|rdkafka#producer-2| [thrd:TxnCoordinator]: Broadcasting state change
%7|1602442830.007|STATE|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator: Broker changed state INIT -> TRY_CONNECT
%7|1602442830.007|BROADCAST|rdkafka#producer-2| [thrd:TxnCoordinator]: Broadcasting state change
%7|1602442830.007|CONNECT|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: broker in state TRY_CONNECT connecting
%7|1602442830.007|STATE|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator: Broker changed state TRY_CONNECT -> CONNECT
%7|1602442830.007|BROADCAST|rdkafka#producer-2| [thrd:TxnCoordinator]: Broadcasting state change
%7|1602442830.007|CONNECT|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Connecting to ipv4#172.31.31.3:9092 (plaintext) with socket 18
%7|1602442830.007|CONNECT|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Connected to ipv4#172.31.31.3:9092
%7|1602442830.007|CONNECTED|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Connected (#1)
%7|1602442830.007|FEATURE|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Updated enabled protocol features +ApiVersion to ApiVersion
%7|1602442830.007|STATE|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator: Broker changed state CONNECT -> APIVERSION_QUERY
%7|1602442830.007|BROADCAST|rdkafka#producer-2| [thrd:TxnCoordinator]: Broadcasting state change
%7|1602442830.007|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent ApiVersionRequest (v3, 66 bytes @ 0, CorrId 1)
%7|1602442830.008|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received ApiVersionResponse (v3, 344 bytes, CorrId 1, rtt 1.38ms)
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Broker API support:
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey Produce (0) Versions 0..8
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey Fetch (1) Versions 0..11
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey Offset (2) Versions 0..5
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey Metadata (3) Versions 0..9
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey LeaderAndIsr (4) Versions 0..4
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey StopReplica (5) Versions 0..2
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey UpdateMetadata (6) Versions 0..6
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey ControlledShutdown (7) Versions 0..3
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey OffsetCommit (8) Versions 0..8
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey OffsetFetch (9) Versions 0..7
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey FindCoordinator (10) Versions 0..3
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey JoinGroup (11) Versions 0..7
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey Heartbeat (12) Versions 0..4
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey LeaveGroup (13) Versions 0..4
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey SyncGroup (14) Versions 0..5
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey DescribeGroups (15) Versions 0..5
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey ListGroups (16) Versions 0..3
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey SaslHandshake (17) Versions 0..1
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey ApiVersion (18) Versions 0..3
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey CreateTopics (19) Versions 0..5
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey DeleteTopics (20) Versions 0..4
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey DeleteRecords (21) Versions 0..1
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey InitProducerId (22) Versions 0..3
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey OffsetForLeaderEpoch (23) Versions 0..3
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey AddPartitionsToTxn (24) Versions 0..1
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey AddOffsetsToTxn (25) Versions 0..1
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey EndTxn (26) Versions 0..1
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey WriteTxnMarkers (27) Versions 0..0
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey TxnOffsetCommit (28) Versions 0..3
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey DescribeAcls (29) Versions 0..2
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey CreateAcls (30) Versions 0..2
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey DeleteAcls (31) Versions 0..2
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey DescribeConfigs (32) Versions 0..2
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey AlterConfigs (33) Versions 0..1
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey AlterReplicaLogDirs (34) Versions 0..1
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey DescribeLogDirs (35) Versions 0..1
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey SaslAuthenticate (36) Versions 0..2
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey CreatePartitions (37) Versions 0..2
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey CreateDelegationToken (38) Versions 0..2
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey RenewDelegationToken (39) Versions 0..2
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey ExpireDelegationToken (40) Versions 0..2
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey DescribeDelegationToken (41) Versions 0..2
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey DeleteGroups (42) Versions 0..2
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey Unknown-43? (43) Versions 0..2
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey Unknown-44? (44) Versions 0..1
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey Unknown-45? (45) Versions 0..0
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey Unknown-46? (46) Versions 0..0
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey Unknown-47? (47) Versions 0..0
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature MsgVer1: Produce (2..2) supported by broker
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature MsgVer1: Fetch (2..2) supported by broker
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature MsgVer1
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature MsgVer2: Produce (3..3) supported by broker
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature MsgVer2: Fetch (4..4) supported by broker
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature MsgVer2
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature ApiVersion: ApiVersion (0..0) supported by broker
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature ApiVersion
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature BrokerGroupCoordinator: FindCoordinator (0..0) supported by broker
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature BrokerGroupCoordinator
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature BrokerBalancedConsumer: FindCoordinator (0..0) supported by broker
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature BrokerBalancedConsumer: OffsetCommit (1..2) supported by broker
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature BrokerBalancedConsumer: OffsetFetch (1..1) supported by broker
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature BrokerBalancedConsumer: JoinGroup (0..0) supported by broker
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature BrokerBalancedConsumer: SyncGroup (0..0) supported by broker
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature BrokerBalancedConsumer: Heartbeat (0..0) supported by broker
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature BrokerBalancedConsumer: LeaveGroup (0..0) supported by broker
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature BrokerBalancedConsumer
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature ThrottleTime: Produce (1..2) supported by broker
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature ThrottleTime: Fetch (1..2) supported by broker
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature ThrottleTime
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature Sasl: JoinGroup (0..0) supported by broker
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature Sasl
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature SaslHandshake: SaslHandshake (0..0) supported by broker
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature SaslHandshake
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature LZ4: FindCoordinator (0..0) supported by broker
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature LZ4
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature OffsetTime: Offset (1..1) supported by broker
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature OffsetTime
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature IdempotentProducer: InitProducerId (0..0) supported by broker
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature IdempotentProducer
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature ZSTD: Produce (7..7) supported by broker
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature ZSTD: Fetch (10..10) supported by broker
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature ZSTD
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature SaslAuthReq: SaslHandshake (1..1) supported by broker
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature SaslAuthReq: SaslAuthenticate (0..0) supported by broker
%7|1602442830.008|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature SaslAuthReq
%7|1602442830.008|FEATURE|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Updated enabled protocol features to MsgVer1,ApiVersion,BrokerBalancedConsumer,ThrottleTime,Sasl,SaslHandshake,BrokerGroupCoordinator,LZ4,OffsetTime,MsgVer2,IdempotentProducer,ZSTD,SaslAuthReq
%7|1602442830.008|STATE|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator: Broker changed state APIVERSION_QUERY -> UP
%7|1602442830.008|BROADCAST|rdkafka#producer-2| [thrd:TxnCoordinator]: Broadcasting state change
%7|1602442830.008|METADATA|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Request metadata for brokers only: connected
%7|1602442830.008|COORD|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Transaction coordinator is now up
%7|1602442830.008|GETPID|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Acquiring ProducerId
%7|1602442830.008|IDEMPSTATE|rdkafka#producer-2| [thrd:main]: Idempotent producer state change WaitTransport -> WaitPID
%7|1602442830.008|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent MetadataRequest (v4, 26 bytes @ 0, CorrId 2)
%7|1602442830.008|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent InitProducerIdRequest (v1, 46 bytes @ 0, CorrId 3)
%7|1602442830.009|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received MetadataResponse (v4, 63 bytes, CorrId 2, rtt 0.88ms)
%7|1602442830.009|METADATA|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: ===== Received metadata: connected =====
%7|1602442830.009|METADATA|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: ClusterId: P3Dm2isBTn-IXhcu_D5JSw, ControllerId: 1001
%7|1602442830.009|METADATA|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: 1 brokers, 0 topics
%7|1602442830.009|METADATA|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001:   Broker #0/1: 172.31.31.3:9092 NodeId 1001
%7|1602442830.025|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received InitProducerIdResponse (v1, 16 bytes, CorrId 3, rtt 16.16ms)
%7|1602442830.025|GETPID|rdkafka#producer-2| [thrd:main]: Acquired PID{Id:0,Epoch:0}
%7|1602442830.025|IDEMPSTATE|rdkafka#producer-2| [thrd:main]: Idempotent producer state change WaitPID -> Assigned
%7|1602442830.025|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change WaitPID -> ReadyNotAcked
%7|1602442830.025|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: init_transactions
%7|1602442830.025|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442830.025|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442830.025|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change ReadyNotAcked -> Ready
%7|1602442830.025|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442830.025|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442830.025|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
=== Starting Consume-Transform-Process loop ===
%7|1602442830.463|CGRPSTATE|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" changed state wait-broker-transport -> up (v3, join-state assigned)
%7|1602442830.463|BROADCAST|rdkafka#consumer-1| [thrd:main]: Broadcasting state change
%7|1602442830.463|BARRIER|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr": rd_kafka_cgrp_partitions_fetch_start0:1878: new version barrier v4
%7|1602442830.463|FETCHSTART|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr": starting fetchers for 1 assigned partition(s) in join-state assigned (usable_offsets=no, v4, line 3431)
%7|1602442830.463|FETCHSTART|rdkafka#consumer-1| [thrd:main]: List with 1 partition(s):
%7|1602442830.463|FETCHSTART|rdkafka#consumer-1| [thrd:main]:  demoinput1602442758 [0] offset INVALID
%7|1602442830.463|OFFSET|rdkafka#consumer-1| [thrd:main]: GroupCoordinator/1001: OffsetFetchRequest(v1) for 1/1 partition(s)
%7|1602442830.463|OFFSET|rdkafka#consumer-1| [thrd:main]: GroupCoordinator/1001: Fetch committed offsets for 1/1 partition(s)
%7|1602442830.463|SEND|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Sent OffsetFetchRequest (v1, 87 bytes @ 0, CorrId 2)
%7|1602442830.464|RECV|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Received OffsetFetchResponse (v1, 52 bytes, CorrId 2, rtt 1.07ms)
%7|1602442830.464|OFFSETFETCH|rdkafka#consumer-1| [thrd:main]: List with 1 partition(s):
%7|1602442830.464|OFFSETFETCH|rdkafka#consumer-1| [thrd:main]:  demoinput1602442758 [0] offset INVALID
%7|1602442830.464|OFFSET|rdkafka#consumer-1| [thrd:main]: Topic demoinput1602442758 [0]: setting default offset INVALID
%7|1602442830.464|OFFSETFETCH|rdkafka#consumer-1| [thrd:main]: GroupCoordinator/1001: OffsetFetchResponse: demoinput1602442758 [0] offset -1, metadata 0 byte(s)
%7|1602442830.464|OFFFETCH|rdkafka#consumer-1| [thrd:main]: GroupCoordinator/1001: OffsetFetch for 1/1 partition(s) returned Success
%7|1602442830.464|BARRIER|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr": rd_kafka_cgrp_partitions_fetch_start0:1878: new version barrier v5
%7|1602442830.464|FETCHSTART|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr": starting fetchers for 1 assigned partition(s) in join-state assigned (usable_offsets=yes, v5, line 1810)
%7|1602442830.464|FETCHSTART|rdkafka#consumer-1| [thrd:main]: List with 1 partition(s):
%7|1602442830.464|FETCHSTART|rdkafka#consumer-1| [thrd:main]:  demoinput1602442758 [0] offset INVALID
%7|1602442830.464|CGRPJOINSTATE|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" changed join state assigned -> started (v5, state up)
%7|1602442830.464|BARRIER|rdkafka#consumer-1| [thrd:main]: demoinput1602442758 [0]: rd_kafka_toppar_op_fetch_start:2299: new version barrier v2
%7|1602442830.464|CONSUMER|rdkafka#consumer-1| [thrd:main]: Start consuming demoinput1602442758 [0] at offset INVALID (v2)
%7|1602442830.464|OP|rdkafka#consumer-1| [thrd:main]: demoinput1602442758 [0] received op FETCH_START (v2) in fetch-state none (opv1)
%7|1602442830.464|FETCH|rdkafka#consumer-1| [thrd:main]: Start fetch for demoinput1602442758 [0] in state none at offset INVALID (v2)
%7|1602442830.464|PARTSTATE|rdkafka#consumer-1| [thrd:main]: Partition demoinput1602442758 [0] changed fetch state none -> offset-query
%7|1602442830.464|OFFSET|rdkafka#consumer-1| [thrd:main]: demoinput1602442758 [0]: offset reset (at offset INVALID) to BEGINNING: no previously committed offset available: Local: No offset stored
%7|1602442830.464|OFFSET|rdkafka#consumer-1| [thrd:main]: demoinput1602442758 [0]: backoff: (re)starting offset query timer for offset BEGINNING
%7|1602442830.464|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op PARTITION_JOIN in state up (join state started, v5) for demoinput1602442758 [0]
%7|1602442830.464|PARTADD|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr": add demoinput1602442758 [0]
%7|1602442830.564|OFFSET|rdkafka#consumer-1| [thrd:main]: Topic demoinput1602442758 [0]: timed offset query for BEGINNING in state offset-query
%7|1602442830.564|OFFREQ|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/1001: Partition demoinput1602442758 [0]: querying for logical offset BEGINNING (opv 2)
%7|1602442830.564|OFFSET|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/1001: OffsetRequest (v0, opv 0) for 1 topic(s) and 1 partition(s)
%7|1602442830.564|PARTSTATE|rdkafka#consumer-1| [thrd:main]: Partition demoinput1602442758 [0] changed fetch state offset-query -> offset-wait
%7|1602442830.564|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent OffsetRequest (v0, 77 bytes @ 0, CorrId 6)
%7|1602442830.565|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received OffsetResponse (v0, 54 bytes, CorrId 6, rtt 0.89ms)
%7|1602442830.565|OFFSET|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/1001: Offset reply for topic demoinput1602442758 [0] (v2 vs v2)
%7|1602442830.565|OFFSET|rdkafka#consumer-1| [thrd:main]: Offset BEGINNING request for demoinput1602442758 [0] returned offset 0 (0)
%7|1602442830.565|PARTSTATE|rdkafka#consumer-1| [thrd:main]: Partition demoinput1602442758 [0] changed fetch state offset-wait -> active
%7|1602442830.565|FETCH|rdkafka#consumer-1| [thrd:main]: Partition demoinput1602442758 [0] start fetching at offset 0
%7|1602442830.565|WAKEUP|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442830.565|FETCHDEC|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Topic demoinput1602442758 [0]: fetch decide: updating to version 2 (was 0) at offset 0 (was 0)
%7|1602442830.565|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] in state active at offset 0 (0/100000 msgs, 0/65536 kb queued, opv 2) is fetchable
%7|1602442830.565|FETCHADD|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Added demoinput1602442758 [0] to fetch list (1 entries, opv 2, 0 messages queued): fetchable
%7|1602442830.565|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 0 (v2)
%7|1602442830.565|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442830.565|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 7)
%7|1602442830.578|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 159 bytes, CorrId 7, rtt 13.16ms)
%7|1602442830.578|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 71, error "Success", MaxOffset 1, LSO 1, Ver 2/2
%7|1602442830.578|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (3 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 0, 0 ctrl msgs, uncompressed)
%7|1602442830.578|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 1 (v2)
%7|1602442830.578|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442830.578|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 8)
%7|1602442830.579|TOPIC|rdkafka#producer-2| [thrd:app]: New local topic: demooutput1602442758
%7|1602442830.579|TOPPARNEW|rdkafka#producer-2| [thrd:app]: NEW demooutput1602442758 [-1] 0x55d321c3d550 (at rd_kafka_topic_new0:441)
=== Committing transaction with 1 messages at input offset 0 ===
:DEMO:START 1602442830.5790138
%7|1602442830.579|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442830.579|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442830.579|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 4)
%7|1602442830.582|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 4, rtt 3.48ms)
%7|1602442830.582|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FindCoordinatorRequest (v2, 48 bytes @ 0, CorrId 7)
%7|1602442830.583|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FindCoordinatorResponse (v2, 33 bytes, CorrId 7, rtt 0.76ms)
%7|1602442830.583|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 8)
%7|1602442830.615|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 8, rtt 32.38ms)
:DEMO:END   1602442830.6158879 0.03687405586242676
%7|1602442830.615|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442830.615|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442830.615|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 1 outstanding message(s) prior to commit
%7|1602442831.080|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 88 bytes, CorrId 8, rtt 501.23ms)
%7|1602442831.080|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 0, error "Success", MaxOffset 1, LSO 1, Ver 2/2
%7|1602442831.080|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 1 (v2)
%7|1602442831.080|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442831.080|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 9)
%7|1602442831.463|NOINFO|rdkafka#producer-2| [thrd:main]: Topic demooutput1602442758 metadata information unknown
%7|1602442831.464|NOINFO|rdkafka#producer-2| [thrd:main]: Topic demooutput1602442758 partition count is zero: should refresh metadata
%7|1602442831.464|METADATA|rdkafka#producer-2| [thrd:main]: Requesting metadata for 1/1 topics: refresh unavailable topics
%7|1602442831.464|METADATA|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Request metadata for 1 topic(s): refresh unavailable topics
%7|1602442831.464|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent MetadataRequest (v4, 54 bytes @ 0, CorrId 9)
%7|1602442831.465|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received MetadataResponse (v4, 124 bytes, CorrId 9, rtt 1.16ms)
%7|1602442831.465|METADATA|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: ===== Received metadata (for 1 requested topics): refresh unavailable topics =====
%7|1602442831.465|METADATA|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: ClusterId: P3Dm2isBTn-IXhcu_D5JSw, ControllerId: 1001
%7|1602442831.465|METADATA|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: 1 brokers, 1 topics
%7|1602442831.465|METADATA|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001:   Broker #0/1: 172.31.31.3:9092 NodeId 1001
%7|1602442831.465|METADATA|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001:   Topic #0/1: demooutput1602442758 with 1 partitions
%7|1602442831.465|STATE|rdkafka#producer-2| [thrd:main]: Topic demooutput1602442758 changed state unknown -> exists
%7|1602442831.465|PARTCNT|rdkafka#producer-2| [thrd:main]: Topic demooutput1602442758 partition count changed from 0 to 1
%7|1602442831.465|TOPPARNEW|rdkafka#producer-2| [thrd:main]: NEW demooutput1602442758 [0] 0x7f18240053e0 (at rd_kafka_topic_partition_cnt_update:750)
%7|1602442831.465|METADATA|rdkafka#producer-2| [thrd:main]:   Topic demooutput1602442758 partition 0 Leader 1001
%7|1602442831.465|BRKDELGT|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0]: delegate to broker 172.31.31.3:9092/1001 (rktp 0x7f18240053e0, term 0, ref 2)
%7|1602442831.465|BRKDELGT|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0]: delegating to broker 172.31.31.3:9092/1001 for partition with 0 messages (0 bytes) queued
%7|1602442831.465|BRKMIGR|rdkafka#producer-2| [thrd:main]: Migrating topic demooutput1602442758 [0] 0x7f18240053e0 from (none) to 172.31.31.3:9092/1001 (sending PARTITION_JOIN to 172.31.31.3:9092/1001)
%7|1602442831.465|PARTCNT|rdkafka#producer-2| [thrd:main]: Partitioning 1 unassigned messages in topic demooutput1602442758 to 1 partitions
%7|1602442831.465|UAS|rdkafka#producer-2| [thrd:main]: 1/1 messages were partitioned in topic demooutput1602442758
%7|1602442831.465|METADATA|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: 1/1 requested topic(s) seen in metadata
%7|1602442831.465|TOPBRK|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demooutput1602442758 [0]: joining broker (rktp 0x7f18240053e0, 1 message(s) queued)
%7|1602442831.465|FETCHADD|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Added demooutput1602442758 [0] to active list (1 entries, opv 0, 1 messages queued): joining
%7|1602442831.465|DRAIN|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: demooutput1602442758 [0] beginning partition drain: wait for outstanding requests to finish before producing to new leader
%7|1602442831.465|BROADCAST|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442831.465|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] all in-flight requests drained from queue
%7|1602442831.466|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442831.466|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 5)
%7|1602442831.471|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 5, rtt 4.91ms)
%7|1602442831.471|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442831.471|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.471|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.471|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442831.471|NEWPID|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: demooutput1602442758 [0] changed PID{Invalid} -> PID{Id:0,Epoch:0} with base MsgId 1
%7|1602442831.471|RESETSEQ|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: demooutput1602442758 [0] resetting epoch base seq from 0 to 1
%7|1602442831.471|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 1, BaseSeq 0, PID{Id:0,Epoch:0}, uncompressed)
%7|1602442831.471|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 10)
%7|1602442831.473|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 10, rtt 2.10ms)
%7|1602442831.473|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 1, BaseSeq 0) delivered
%7|1602442831.473|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442831.473|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442831.473|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 6)
%7|1602442831.478|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 6, rtt 4.90ms)
%7|1602442831.478|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442831.478|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442831.478|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442831.478|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.478|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
=== Reached the end of demoinput1602442758 [0] at 1====
%7|1602442831.478|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
=== Reached end of input ===
%7|1602442831.500|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 159 bytes, CorrId 9, rtt 419.94ms)
%7|1602442831.500|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 71, error "Success", MaxOffset 2, LSO 2, Ver 2/2
%7|1602442831.500|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (3 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 1, 0 ctrl msgs, uncompressed)
%7|1602442831.500|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 2 (v2)
%7|1602442831.500|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442831.500|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 10)
=== Committing transaction with 1 messages at input offset 1 ===
:DEMO:START 1602442831.5002084
%7|1602442831.500|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442831.500|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442831.500|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 7)
%7|1602442831.501|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 8)
%7|1602442831.501|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442831.502|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 7, rtt 1.53ms)
%7|1602442831.502|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 11)
%7|1602442831.504|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 11, rtt 2.68ms)
:DEMO:END   1602442831.5049024 0.0046939849853515625
%7|1602442831.504|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442831.504|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442831.504|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 1 outstanding message(s) prior to commit
%7|1602442831.504|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 8, rtt 3.77ms)
%7|1602442831.505|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442831.505|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.505|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442831.505|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.506|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
%7|1602442831.506|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 2, BaseSeq 1, PID{Id:0,Epoch:0}, uncompressed)
%7|1602442831.506|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 12)
%7|1602442831.507|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 12, rtt 1.78ms)
%7|1602442831.507|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 2, BaseSeq 1) delivered
%7|1602442831.507|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442831.507|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442831.508|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 9)
%7|1602442831.509|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 9, rtt 1.47ms)
%7|1602442831.509|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442831.509|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442831.509|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442831.509|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.509|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.519|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 159 bytes, CorrId 10, rtt 19.08ms)
%7|1602442831.519|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 71, error "Success", MaxOffset 3, LSO 3, Ver 2/2
%7|1602442831.519|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (3 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 2, 0 ctrl msgs, uncompressed)
%7|1602442831.519|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 3 (v2)
%7|1602442831.519|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442831.519|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 11)
=== Committing transaction with 1 messages at input offset 2 ===
:DEMO:START 1602442831.5193865
%7|1602442831.519|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442831.519|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442831.519|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 10)
%7|1602442831.520|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442831.520|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 11)
%7|1602442831.520|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 10, rtt 1.47ms)
%7|1602442831.521|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 13)
%7|1602442831.522|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 13, rtt 1.44ms)
%7|1602442831.522|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 11, rtt 2.07ms)
:DEMO:END   1602442831.522486 0.0030994415283203125
%7|1602442831.522|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442831.522|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442831.522|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442831.522|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.522|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.522|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442831.522|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 1 outstanding message(s) prior to commit
%7|1602442831.524|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
%7|1602442831.524|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 3, BaseSeq 2, PID{Id:0,Epoch:0}, uncompressed)
%7|1602442831.524|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 14)
%7|1602442831.525|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 14, rtt 1.14ms)
%7|1602442831.525|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 3, BaseSeq 2) delivered
%7|1602442831.525|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442831.525|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442831.525|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 12)
%7|1602442831.527|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 12, rtt 1.16ms)
%7|1602442831.527|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442831.527|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442831.527|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442831.527|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.527|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.536|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 159 bytes, CorrId 11, rtt 17.29ms)
%7|1602442831.536|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 71, error "Success", MaxOffset 4, LSO 4, Ver 2/2
%7|1602442831.536|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (3 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 3, 0 ctrl msgs, uncompressed)
%7|1602442831.536|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 4 (v2)
%7|1602442831.536|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442831.536|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 12)
=== Committing transaction with 1 messages at input offset 3 ===
:DEMO:START 1602442831.5367544
%7|1602442831.536|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442831.536|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442831.536|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 13)
%7|1602442831.537|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442831.537|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 14)
%7|1602442831.538|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 13, rtt 1.34ms)
%7|1602442831.538|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 15)
%7|1602442831.539|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 15, rtt 1.64ms)
:DEMO:END   1602442831.539966 0.0032117366790771484
%7|1602442831.539|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442831.539|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 14, rtt 2.22ms)
%7|1602442831.539|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442831.539|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442831.540|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 1 outstanding message(s) prior to commit
%7|1602442831.540|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.540|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.540|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442831.542|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
%7|1602442831.542|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 4, BaseSeq 3, PID{Id:0,Epoch:0}, uncompressed)
%7|1602442831.542|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 16)
%7|1602442831.543|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 16, rtt 1.44ms)
%7|1602442831.543|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 4, BaseSeq 3) delivered
%7|1602442831.543|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442831.543|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442831.543|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 15)
%7|1602442831.544|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 15, rtt 0.79ms)
%7|1602442831.544|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442831.544|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442831.544|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442831.544|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.544|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.552|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 159 bytes, CorrId 12, rtt 15.89ms)
%7|1602442831.552|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 71, error "Success", MaxOffset 5, LSO 5, Ver 2/2
%7|1602442831.552|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (3 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 4, 0 ctrl msgs, uncompressed)
%7|1602442831.552|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 5 (v2)
%7|1602442831.552|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442831.552|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 13)
=== Committing transaction with 1 messages at input offset 4 ===
:DEMO:START 1602442831.55272
%7|1602442831.552|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442831.552|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442831.552|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 16)
%7|1602442831.553|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442831.553|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 17)
%7|1602442831.554|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 16, rtt 1.23ms)
%7|1602442831.554|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 17)
%7|1602442831.555|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 17, rtt 1.67ms)
%7|1602442831.555|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442831.555|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442831.555|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.555|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.555|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 17, rtt 1.38ms)
%7|1602442831.555|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
:DEMO:END   1602442831.555584 0.0028638839721679688
%7|1602442831.555|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442831.555|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442831.555|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 1 outstanding message(s) prior to commit
%7|1602442831.558|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
%7|1602442831.558|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 5, BaseSeq 4, PID{Id:0,Epoch:0}, uncompressed)
%7|1602442831.558|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 18)
%7|1602442831.559|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 18, rtt 0.93ms)
%7|1602442831.559|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 5, BaseSeq 4) delivered
%7|1602442831.559|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442831.559|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 18)
%7|1602442831.559|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442831.560|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 18, rtt 0.89ms)
%7|1602442831.560|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442831.560|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442831.560|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442831.560|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.560|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.569|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 159 bytes, CorrId 13, rtt 16.64ms)
%7|1602442831.569|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 71, error "Success", MaxOffset 6, LSO 6, Ver 2/2
%7|1602442831.569|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (3 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 5, 0 ctrl msgs, uncompressed)
%7|1602442831.569|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 6 (v2)
%7|1602442831.569|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442831.569|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 14)
=== Committing transaction with 1 messages at input offset 5 ===
:DEMO:START 1602442831.569445
%7|1602442831.569|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442831.569|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442831.569|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 19)
%7|1602442831.570|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 20)
%7|1602442831.570|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442831.571|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 19, rtt 1.45ms)
%7|1602442831.571|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 19)
%7|1602442831.572|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 19, rtt 1.36ms)
%7|1602442831.572|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 20, rtt 2.02ms)
%7|1602442831.572|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
:DEMO:END   1602442831.5725045 0.0030596256256103516
%7|1602442831.572|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442831.572|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442831.572|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.572|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.572|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442831.572|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 1 outstanding message(s) prior to commit
%7|1602442831.574|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
%7|1602442831.574|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 6, BaseSeq 5, PID{Id:0,Epoch:0}, uncompressed)
%7|1602442831.574|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 20)
%7|1602442831.575|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 20, rtt 1.03ms)
%7|1602442831.575|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 6, BaseSeq 5) delivered
%7|1602442831.575|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442831.575|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442831.575|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 21)
%7|1602442831.577|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 21, rtt 1.20ms)
%7|1602442831.577|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442831.577|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442831.577|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442831.577|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.577|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.585|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 159 bytes, CorrId 14, rtt 16.52ms)
%7|1602442831.585|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 71, error "Success", MaxOffset 7, LSO 7, Ver 2/2
%7|1602442831.585|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (3 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 6, 0 ctrl msgs, uncompressed)
%7|1602442831.585|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 7 (v2)
%7|1602442831.585|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442831.585|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 15)
=== Committing transaction with 1 messages at input offset 6 ===
:DEMO:START 1602442831.5860312
%7|1602442831.586|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442831.586|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442831.586|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 22)
%7|1602442831.587|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442831.587|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 23)
%7|1602442831.587|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 22, rtt 1.44ms)
%7|1602442831.587|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 21)
%7|1602442831.588|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 21, rtt 1.28ms)
:DEMO:END   1602442831.5889628 0.0029315948486328125
%7|1602442831.588|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442831.588|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442831.588|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 1 outstanding message(s) prior to commit
%7|1602442831.589|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 23, rtt 2.18ms)
%7|1602442831.589|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442831.589|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442831.589|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.589|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.591|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
%7|1602442831.591|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 7, BaseSeq 6, PID{Id:0,Epoch:0}, uncompressed)
%7|1602442831.591|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 22)
%7|1602442831.592|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 22, rtt 1.05ms)
%7|1602442831.592|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 7, BaseSeq 6) delivered
%7|1602442831.592|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442831.592|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 24)
%7|1602442831.592|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442831.593|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 24, rtt 0.99ms)
%7|1602442831.593|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442831.593|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442831.593|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442831.593|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.593|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.602|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 159 bytes, CorrId 15, rtt 16.52ms)
%7|1602442831.602|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 71, error "Success", MaxOffset 8, LSO 8, Ver 2/2
%7|1602442831.602|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (3 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 7, 0 ctrl msgs, uncompressed)
%7|1602442831.602|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 8 (v2)
%7|1602442831.602|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442831.602|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 16)
=== Committing transaction with 1 messages at input offset 7 ===
:DEMO:START 1602442831.6028187
%7|1602442831.602|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442831.602|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442831.602|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 25)
%7|1602442831.603|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 25, rtt 0.80ms)
%7|1602442831.603|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 23)
%7|1602442831.603|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 26)
%7|1602442831.603|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442831.605|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 23, rtt 1.33ms)
:DEMO:END   1602442831.6051989 0.0023801326751708984
%7|1602442831.605|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442831.605|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442831.605|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 1 outstanding message(s) prior to commit
%7|1602442831.605|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 26, rtt 1.45ms)
%7|1602442831.605|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442831.605|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.605|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.605|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442831.608|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
%7|1602442831.608|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 8, BaseSeq 7, PID{Id:0,Epoch:0}, uncompressed)
%7|1602442831.608|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 24)
%7|1602442831.609|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 24, rtt 1.12ms)
%7|1602442831.609|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 8, BaseSeq 7) delivered
%7|1602442831.609|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442831.609|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442831.609|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 27)
%7|1602442831.610|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 27, rtt 1.10ms)
%7|1602442831.610|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442831.610|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442831.610|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442831.610|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.610|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.619|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 159 bytes, CorrId 16, rtt 17.12ms)
%7|1602442831.619|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 71, error "Success", MaxOffset 9, LSO 9, Ver 2/2
%7|1602442831.619|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (3 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 8, 0 ctrl msgs, uncompressed)
%7|1602442831.619|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 9 (v2)
%7|1602442831.619|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442831.619|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 17)
=== Committing transaction with 1 messages at input offset 8 ===
:DEMO:START 1602442831.619795
%7|1602442831.619|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442831.619|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442831.619|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 28)
%7|1602442831.620|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442831.620|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 29)
%7|1602442831.620|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 28, rtt 0.97ms)
%7|1602442831.620|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 25)
%7|1602442831.622|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 29, rtt 1.26ms)
%7|1602442831.622|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442831.622|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442831.622|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.622|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.622|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 25, rtt 1.26ms)
%7|1602442831.622|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
:DEMO:END   1602442831.6222417 0.0024466514587402344
%7|1602442831.622|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442831.622|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442831.622|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 1 outstanding message(s) prior to commit
%7|1602442831.625|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
%7|1602442831.625|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 9, BaseSeq 8, PID{Id:0,Epoch:0}, uncompressed)
%7|1602442831.625|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 26)
%7|1602442831.627|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 26, rtt 1.68ms)
%7|1602442831.627|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 9, BaseSeq 8) delivered
%7|1602442831.627|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442831.627|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442831.627|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 30)
%7|1602442831.628|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 30, rtt 0.95ms)
%7|1602442831.628|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442831.628|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442831.628|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442831.628|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.628|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.637|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 159 bytes, CorrId 17, rtt 17.36ms)
%7|1602442831.637|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 71, error "Success", MaxOffset 10, LSO 10, Ver 2/2
%7|1602442831.637|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (3 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 9, 0 ctrl msgs, uncompressed)
%7|1602442831.637|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 10 (v2)
%7|1602442831.637|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442831.637|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 18)
=== Committing transaction with 1 messages at input offset 9 ===
:DEMO:START 1602442831.6371942
%7|1602442831.637|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442831.637|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442831.637|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 31)
%7|1602442831.638|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 32)
%7|1602442831.638|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442831.638|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 31, rtt 0.96ms)
%7|1602442831.638|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 27)
%7|1602442831.639|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 27, rtt 1.14ms)
:DEMO:END   1602442831.639487 0.0022928714752197266
%7|1602442831.639|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442831.639|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 32, rtt 1.30ms)
%7|1602442831.639|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442831.639|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 1 outstanding message(s) prior to commit
%7|1602442831.639|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442831.639|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.639|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442831.639|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.642|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
%7|1602442831.642|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 10, BaseSeq 9, PID{Id:0,Epoch:0}, uncompressed)
%7|1602442831.642|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 28)
%7|1602442831.643|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 28, rtt 0.88ms)
%7|1602442831.643|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 10, BaseSeq 9) delivered
%7|1602442831.643|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442831.643|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 33)
%7|1602442831.643|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442831.644|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 33, rtt 1.04ms)
%7|1602442831.644|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442831.644|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442831.644|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442831.644|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.644|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.653|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 160 bytes, CorrId 18, rtt 16.17ms)
%7|1602442831.653|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 72, error "Success", MaxOffset 11, LSO 11, Ver 2/2
%7|1602442831.653|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (4 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 10, 0 ctrl msgs, uncompressed)
%7|1602442831.653|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 11 (v2)
%7|1602442831.653|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442831.653|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 19)
=== Committing transaction with 1 messages at input offset 10 ===
:DEMO:START 1602442831.653425
%7|1602442831.653|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442831.653|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442831.653|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 34)
%7|1602442831.654|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442831.654|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 34, rtt 0.88ms)
%7|1602442831.654|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 35)
%7|1602442831.654|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 29)
%7|1602442831.655|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 35, rtt 1.14ms)
%7|1602442831.655|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442831.655|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442831.655|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.655|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.655|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 29, rtt 1.28ms)
%7|1602442831.655|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
:DEMO:END   1602442831.6557958 0.0023708343505859375
%7|1602442831.655|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442831.655|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442831.655|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 1 outstanding message(s) prior to commit
%7|1602442831.658|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
%7|1602442831.658|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 11, BaseSeq 10, PID{Id:0,Epoch:0}, uncompressed)
%7|1602442831.658|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 30)
%7|1602442831.659|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 30, rtt 1.10ms)
%7|1602442831.659|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 11, BaseSeq 10) delivered
%7|1602442831.660|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442831.660|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442831.660|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 36)
%7|1602442831.661|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 36, rtt 1.29ms)
%7|1602442831.661|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442831.661|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442831.661|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442831.661|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.661|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.670|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 160 bytes, CorrId 19, rtt 17.03ms)
%7|1602442831.670|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 72, error "Success", MaxOffset 12, LSO 12, Ver 2/2
%7|1602442831.670|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (4 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 11, 0 ctrl msgs, uncompressed)
%7|1602442831.670|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 12 (v2)
%7|1602442831.670|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442831.670|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 20)
=== Committing transaction with 1 messages at input offset 11 ===
:DEMO:START 1602442831.6705155
%7|1602442831.670|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442831.670|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442831.670|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 37)
%7|1602442831.671|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442831.671|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 38)
%7|1602442831.671|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 37, rtt 1.12ms)
%7|1602442831.671|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 31)
%7|1602442831.672|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 31, rtt 0.94ms)
:DEMO:END   1602442831.6728168 0.0023012161254882812
%7|1602442831.672|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442831.672|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442831.672|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 1 outstanding message(s) prior to commit
%7|1602442831.672|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 38, rtt 1.38ms)
%7|1602442831.672|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442831.672|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.672|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442831.672|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.676|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
%7|1602442831.676|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 12, BaseSeq 11, PID{Id:0,Epoch:0}, uncompressed)
%7|1602442831.676|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 32)
%7|1602442831.677|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 32, rtt 1.03ms)
%7|1602442831.677|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 12, BaseSeq 11) delivered
%7|1602442831.677|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442831.677|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442831.677|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 39)
%7|1602442831.678|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 39, rtt 0.84ms)
%7|1602442831.678|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442831.678|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442831.678|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442831.678|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.678|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.686|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 160 bytes, CorrId 20, rtt 16.29ms)
%7|1602442831.686|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 72, error "Success", MaxOffset 13, LSO 13, Ver 2/2
%7|1602442831.686|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (4 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 12, 0 ctrl msgs, uncompressed)
%7|1602442831.686|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 13 (v2)
%7|1602442831.686|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442831.686|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 21)
=== Committing transaction with 1 messages at input offset 12 ===
:DEMO:START 1602442831.6868896
%7|1602442831.686|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442831.686|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442831.687|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 40)
%7|1602442831.687|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 40, rtt 0.83ms)
%7|1602442831.687|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442831.687|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 33)
%7|1602442831.687|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 41)
%7|1602442831.688|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 33, rtt 1.07ms)
:DEMO:END   1602442831.6890304 0.0021407604217529297
%7|1602442831.689|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442831.689|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442831.689|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 1 outstanding message(s) prior to commit
%7|1602442831.689|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 41, rtt 1.36ms)
%7|1602442831.689|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442831.689|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.689|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442831.689|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.692|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
%7|1602442831.692|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 13, BaseSeq 12, PID{Id:0,Epoch:0}, uncompressed)
%7|1602442831.692|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 34)
%7|1602442831.700|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 34, rtt 7.87ms)
%7|1602442831.700|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 13, BaseSeq 12) delivered
%7|1602442831.700|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442831.700|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442831.700|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 42)
%7|1602442831.701|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 42, rtt 0.91ms)
%7|1602442831.701|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442831.701|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442831.701|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442831.701|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.701|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.710|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 160 bytes, CorrId 21, rtt 23.26ms)
%7|1602442831.710|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 72, error "Success", MaxOffset 14, LSO 14, Ver 2/2
%7|1602442831.710|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (4 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 13, 0 ctrl msgs, uncompressed)
%7|1602442831.710|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 14 (v2)
%7|1602442831.710|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442831.710|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 22)
=== Committing transaction with 1 messages at input offset 13 ===
:DEMO:START 1602442831.7101958
%7|1602442831.710|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442831.710|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442831.710|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 43)
%7|1602442831.711|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442831.711|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 44)
%7|1602442831.711|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 43, rtt 0.98ms)
%7|1602442831.711|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 35)
%7|1602442831.712|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 44, rtt 1.24ms)
%7|1602442831.712|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442831.712|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.712|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442831.712|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.712|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 35, rtt 1.27ms)
%7|1602442831.712|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
:DEMO:END   1602442831.7126253 0.002429485321044922
%7|1602442831.712|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442831.712|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442831.712|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 1 outstanding message(s) prior to commit
%7|1602442831.715|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
%7|1602442831.715|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 14, BaseSeq 13, PID{Id:0,Epoch:0}, uncompressed)
%7|1602442831.715|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 36)
%7|1602442831.716|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 36, rtt 0.93ms)
%7|1602442831.716|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 14, BaseSeq 13) delivered
%7|1602442831.716|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442831.716|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442831.716|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 45)
%7|1602442831.717|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 45, rtt 1.11ms)
%7|1602442831.717|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442831.717|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442831.717|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442831.717|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.717|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.726|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 160 bytes, CorrId 22, rtt 16.18ms)
%7|1602442831.726|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 72, error "Success", MaxOffset 15, LSO 15, Ver 2/2
%7|1602442831.726|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (4 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 14, 0 ctrl msgs, uncompressed)
%7|1602442831.726|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 15 (v2)
%7|1602442831.726|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442831.726|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 23)
=== Committing transaction with 1 messages at input offset 14 ===
:DEMO:START 1602442831.7264616
%7|1602442831.726|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442831.726|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442831.726|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 46)
%7|1602442831.727|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 47)
%7|1602442831.727|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442831.727|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 46, rtt 1.31ms)
%7|1602442831.727|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 37)
%7|1602442831.729|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 47, rtt 1.55ms)
%7|1602442831.729|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442831.729|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.729|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442831.729|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.729|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 37, rtt 1.28ms)
%7|1602442831.729|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
:DEMO:END   1602442831.7292662 0.0028045177459716797
%7|1602442831.729|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442831.729|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442831.729|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 1 outstanding message(s) prior to commit
%7|1602442831.732|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
%7|1602442831.732|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 15, BaseSeq 14, PID{Id:0,Epoch:0}, uncompressed)
%7|1602442831.732|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 38)
%7|1602442831.733|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 38, rtt 0.88ms)
%7|1602442831.733|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 15, BaseSeq 14) delivered
%7|1602442831.733|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442831.733|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442831.733|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 48)
%7|1602442831.734|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 48, rtt 0.83ms)
%7|1602442831.734|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442831.734|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442831.734|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442831.734|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.734|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.742|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 160 bytes, CorrId 23, rtt 16.05ms)
%7|1602442831.742|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 72, error "Success", MaxOffset 16, LSO 16, Ver 2/2
%7|1602442831.742|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (4 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 15, 0 ctrl msgs, uncompressed)
%7|1602442831.742|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 16 (v2)
%7|1602442831.742|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442831.742|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 24)
=== Committing transaction with 1 messages at input offset 15 ===
:DEMO:START 1602442831.7425978
%7|1602442831.742|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442831.742|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442831.742|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 49)
%7|1602442831.743|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442831.743|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 50)
%7|1602442831.744|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 49, rtt 1.44ms)
%7|1602442831.744|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 39)
%7|1602442831.745|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 50, rtt 1.97ms)
%7|1602442831.745|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442831.745|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.745|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442831.745|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.745|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 39, rtt 1.50ms)
%7|1602442831.745|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
:DEMO:END   1602442831.7457428 0.003144979476928711
%7|1602442831.745|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442831.745|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442831.745|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 1 outstanding message(s) prior to commit
%7|1602442831.747|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
%7|1602442831.747|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 16, BaseSeq 15, PID{Id:0,Epoch:0}, uncompressed)
%7|1602442831.747|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 40)
%7|1602442831.748|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 40, rtt 1.10ms)
%7|1602442831.748|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 16, BaseSeq 15) delivered
%7|1602442831.748|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442831.749|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442831.749|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 51)
%7|1602442831.749|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 51, rtt 0.92ms)
%7|1602442831.749|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442831.749|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442831.750|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442831.750|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.750|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.758|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 160 bytes, CorrId 24, rtt 15.83ms)
%7|1602442831.758|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 72, error "Success", MaxOffset 17, LSO 17, Ver 2/2
%7|1602442831.758|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (4 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 16, 0 ctrl msgs, uncompressed)
%7|1602442831.758|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 17 (v2)
%7|1602442831.758|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442831.758|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 25)
=== Committing transaction with 1 messages at input offset 16 ===
:DEMO:START 1602442831.7585008
%7|1602442831.758|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442831.758|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442831.758|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 52)
%7|1602442831.759|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442831.759|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 53)
%7|1602442831.759|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 52, rtt 1.12ms)
%7|1602442831.759|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 41)
%7|1602442831.761|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 53, rtt 1.48ms)
%7|1602442831.761|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442831.761|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.761|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442831.761|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.761|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 41, rtt 1.43ms)
%7|1602442831.761|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
:DEMO:END   1602442831.7612453 0.002744436264038086
%7|1602442831.761|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442831.761|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442831.761|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 1 outstanding message(s) prior to commit
%7|1602442831.764|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
%7|1602442831.764|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 17, BaseSeq 16, PID{Id:0,Epoch:0}, uncompressed)
%7|1602442831.764|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 42)
%7|1602442831.765|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 42, rtt 1.01ms)
%7|1602442831.765|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 17, BaseSeq 16) delivered
%7|1602442831.765|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442831.765|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442831.765|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 54)
%7|1602442831.766|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 54, rtt 0.98ms)
%7|1602442831.766|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442831.766|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442831.766|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442831.766|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.766|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.774|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 160 bytes, CorrId 25, rtt 16.44ms)
%7|1602442831.774|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 72, error "Success", MaxOffset 18, LSO 18, Ver 2/2
%7|1602442831.774|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (4 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 17, 0 ctrl msgs, uncompressed)
%7|1602442831.774|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 18 (v2)
%7|1602442831.774|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442831.774|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 26)
=== Committing transaction with 1 messages at input offset 17 ===
:DEMO:START 1602442831.7750068
%7|1602442831.775|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442831.775|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442831.775|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 55)
%7|1602442831.775|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442831.776|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 56)
%7|1602442831.776|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 55, rtt 0.94ms)
%7|1602442831.776|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 43)
%7|1602442831.777|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 56, rtt 1.21ms)
%7|1602442831.777|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442831.777|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.777|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442831.777|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.777|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 43, rtt 1.55ms)
%7|1602442831.777|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
:DEMO:END   1602442831.777747 0.002740144729614258
%7|1602442831.777|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442831.777|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442831.777|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 1 outstanding message(s) prior to commit
%7|1602442831.780|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
%7|1602442831.780|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 18, BaseSeq 17, PID{Id:0,Epoch:0}, uncompressed)
%7|1602442831.780|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 44)
%7|1602442831.781|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 44, rtt 0.83ms)
%7|1602442831.781|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 18, BaseSeq 17) delivered
%7|1602442831.781|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442831.781|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442831.781|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 57)
%7|1602442831.782|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 57, rtt 0.86ms)
%7|1602442831.782|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442831.782|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442831.782|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442831.782|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.782|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.791|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 160 bytes, CorrId 26, rtt 16.22ms)
%7|1602442831.791|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 72, error "Success", MaxOffset 19, LSO 19, Ver 2/2
%7|1602442831.791|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (4 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 18, 0 ctrl msgs, uncompressed)
%7|1602442831.791|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 19 (v2)
%7|1602442831.791|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442831.791|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 27)
=== Committing transaction with 1 messages at input offset 18 ===
:DEMO:START 1602442831.791261
%7|1602442831.791|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442831.791|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442831.791|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 58)
%7|1602442831.792|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442831.792|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 58, rtt 0.89ms)
%7|1602442831.792|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 59)
%7|1602442831.792|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 45)
%7|1602442831.793|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 59, rtt 1.22ms)
%7|1602442831.793|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442831.793|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.793|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442831.793|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.793|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 45, rtt 1.34ms)
%7|1602442831.793|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
:DEMO:END   1602442831.7937176 0.0024566650390625
%7|1602442831.793|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442831.793|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442831.793|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 1 outstanding message(s) prior to commit
%7|1602442831.796|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
%7|1602442831.796|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 19, BaseSeq 18, PID{Id:0,Epoch:0}, uncompressed)
%7|1602442831.796|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 46)
%7|1602442831.797|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 46, rtt 0.97ms)
%7|1602442831.797|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 19, BaseSeq 18) delivered
%7|1602442831.797|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442831.797|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442831.797|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 60)
%7|1602442831.798|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 60, rtt 0.88ms)
%7|1602442831.798|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442831.798|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442831.798|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442831.798|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.798|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.807|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 160 bytes, CorrId 27, rtt 16.29ms)
%7|1602442831.807|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 72, error "Success", MaxOffset 20, LSO 20, Ver 2/2
%7|1602442831.807|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (4 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 19, 0 ctrl msgs, uncompressed)
%7|1602442831.807|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 20 (v2)
%7|1602442831.807|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442831.807|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 28)
=== Committing transaction with 1 messages at input offset 19 ===
:DEMO:START 1602442831.807602
%7|1602442831.807|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442831.807|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442831.807|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 61)
%7|1602442831.808|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 62)
%7|1602442831.808|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442831.808|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 61, rtt 0.97ms)
%7|1602442831.808|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 47)
%7|1602442831.810|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 62, rtt 1.48ms)
%7|1602442831.810|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442831.810|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.810|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 47, rtt 1.55ms)
%7|1602442831.810|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442831.810|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442831.810|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
:DEMO:END   1602442831.8103418 0.0027399063110351562
%7|1602442831.810|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442831.810|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442831.810|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 1 outstanding message(s) prior to commit
%7|1602442831.813|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
%7|1602442831.813|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 20, BaseSeq 19, PID{Id:0,Epoch:0}, uncompressed)
%7|1602442831.813|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 48)
%7|1602442831.814|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 48, rtt 0.87ms)
%7|1602442831.814|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 20, BaseSeq 19) delivered
%7|1602442831.814|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442831.814|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442831.814|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 63)
%7|1602442831.815|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 63, rtt 0.83ms)
%7|1602442831.815|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442831.815|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442831.815|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442831.815|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442831.815|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up


Process finished with exit code 0
