/home/joe/PycharmProjects/.venv/kafka-tr-issue-201011/bin/python /home/joe/PycharmProjects/kafka-tr-issue-201011/demo.py -b 172.31.31.3:9092 -t demoinput1602442758 -o demooutput1602442758
Running in PARALLEL mode
The input producer will produce all messages in parallel (at once) after the first message.
Processing took 1.8955812454223633

Send offset times: [0.0027625560760498047, 0.0019762516021728516, 0.10375642776489258, 0.10460805892944336, 0.10369443893432617, 0.10310721397399902, 0.1026458740234375, 0.10383033752441406, 0.1045694351196289, 0.10415911674499512, 0.10245347023010254, 0.10347795486450195, 0.10364031791687012, 0.10359859466552734, 0.10380077362060547, 0.10238766670227051, 0.10335779190063477, 0.10341238975524902, 0.10306930541992188, 0.10412240028381348]
Send offset times average: 0.09342151880264282

Relevant log snippet from the middle:
:DEMO:START 1602442988.8928254
%7|1602442988.892|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442988.892|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442988.892|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 50)
%7|1602442988.893|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 50, rtt 0.23ms)
%7|1602442988.893|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Retrying AddOffsetsToTxnRequest (v0, 78 bytes, retry 1/3, prev CorrId 50) in 100ms
%7|1602442988.893|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442988.893|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 51)
%7|1602442988.894|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 51, rtt 0.26ms)
%7|1602442988.894|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: AddPartitionsToTxn response: partition "demooutput1602442758": [0]: Broker: Producer attempted to update a transaction while another concurrent operation on the same transaction was ongoing
%7|1602442988.914|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442988.914|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 52)
%7|1602442988.915|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 52, rtt 1.01ms)
%7|1602442988.915|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442988.915|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442988.915|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442988.915|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442988.915|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 11, BaseSeq 10, PID{Id:0,Epoch:3}, uncompressed)
%7|1602442988.915|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 27)
%7|1602442988.916|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 27, rtt 0.88ms)
%7|1602442988.916|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 11, BaseSeq 10) delivered
%7|1602442988.993|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Moved 1 retry buffer(s) to output queue
%7|1602442988.993|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 53)
%7|1602442988.994|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 53, rtt 0.97ms)
%7|1602442988.994|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 28)
%7|1602442988.995|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 28, rtt 0.73ms)
:DEMO:END   1602442988.9952788 0.10245347023010254

Full output of the transactor:
%7|1602442986.034|MEMBERID|rdkafka#consumer-1| [thrd:app]: Group "kafka-tr-issue-201011-tr": updating member id "(not-set)" -> ""
%7|1602442986.034|WAKEUPFD|rdkafka#consumer-1| [thrd:app]: GroupCoordinator: Enabled low-latency ops queue wake-ups
%7|1602442986.034|BROKER|rdkafka#consumer-1| [thrd:app]: GroupCoordinator: Added new broker with NodeId -1
%7|1602442986.034|WAKEUPFD|rdkafka#consumer-1| [thrd:app]: 172.31.31.3:9092/bootstrap: Enabled low-latency ops queue wake-ups
%7|1602442986.034|BRKMAIN|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator: Enter main broker thread
%7|1602442986.034|BRKMAIN|rdkafka#consumer-1| [thrd::0/internal]: :0/internal: Enter main broker thread
%7|1602442986.035|BROKER|rdkafka#consumer-1| [thrd:app]: 172.31.31.3:9092/bootstrap: Added new broker with NodeId -1
%7|1602442986.035|INIT|rdkafka#consumer-1| [thrd:app]: librdkafka v1.5.0 (0x10500ff) rdkafka#consumer-1 initialized (builtin.features gzip,snappy,ssl,sasl,regex,lz4,sasl_plain,sasl_scram,plugins,zstd,sasl_oauthbearer, STATIC_LINKING GCC GXX PKGCONFIG INSTALL GNULD LDS LIBDL PLUGINS STATIC_LIB_zlib ZLIB STATIC_LIB_libcrypto STATIC_LIB_libssl SSL STATIC_LIB_libzstd ZSTD HDRHISTOGRAM SYSLOG SNAPPY SOCKEM SASL_SCRAM SASL_OAUTHBEARER CRC32C_HW, debug 0xfffff)
%7|1602442986.035|BRKMAIN|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enter main broker thread
%7|1602442986.035|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op ASSIGN (v0) in state init (join state init, v1 vs 0)
%7|1602442986.035|ASSIGN|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr": new assignment of 1 partition(s) in join state init
%7|1602442986.035|TOPIC|rdkafka#consumer-1| [thrd:main]: New local topic: demoinput1602442758
%7|1602442986.035|TOPPARNEW|rdkafka#consumer-1| [thrd:main]: NEW demoinput1602442758 [-1] 0x7f4ea4003050 (at rd_kafka_topic_new0:441)
%7|1602442986.035|TOPPARNEW|rdkafka#consumer-1| [thrd:main]: NEW demoinput1602442758 [0] 0x7f4ea40035b0 (at rd_kafka_toppar_desired_add:618)
%7|1602442986.035|DESIRED|rdkafka#consumer-1| [thrd:main]: demoinput1602442758 [0]: marking as DESIRED
%7|1602442986.035|DESIRED|rdkafka#consumer-1| [thrd:main]: demoinput1602442758 [0]: adding to DESIRED list
%7|1602442986.035|BARRIER|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr": rd_kafka_cgrp_assign:2600: new version barrier v2
%7|1602442986.035|ASSIGN|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr": assigning 1 partition(s) in join state init
%7|1602442986.035|CGRPJOINSTATE|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" changed join state init -> assigned (v2, state init)
%7|1602442986.035|BARRIER|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr": rd_kafka_cgrp_partitions_fetch_start0:1878: new version barrier v3
%7|1602442986.035|FETCHSTART|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr": starting fetchers for 1 assigned partition(s) in join-state assigned (usable_offsets=no, v3, line 2651)
%7|1602442986.035|FETCHSTART|rdkafka#consumer-1| [thrd:main]: List with 1 partition(s):
%7|1602442986.035|FETCHSTART|rdkafka#consumer-1| [thrd:main]:  demoinput1602442758 [0] offset INVALID
%7|1602442986.035|OFFSETFETCH|rdkafka#consumer-1| [thrd:main]: List with 1 partition(s):
%7|1602442986.035|OFFSETFETCH|rdkafka#consumer-1| [thrd:main]:  demoinput1602442758 [0] offset INVALID
%7|1602442986.035|OFFSET|rdkafka#consumer-1| [thrd:main]: Offset fetch error: Local: Waiting for coordinator
%7|1602442986.035|CGRPSTATE|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" changed state init -> query-coord (v3, join-state assigned)
%7|1602442986.035|BROADCAST|rdkafka#consumer-1| [thrd:main]: Broadcasting state change
%7|1602442986.035|CONNECT|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/bootstrap: Selected for cluster connection: coordinator query (broker has 0 connection attempt(s))
%7|1602442986.035|CGRPQUERY|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr": no broker available for coordinator query: intervaled in state query-coord
%7|1602442986.035|CONNECT|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Received CONNECT op
%7|1602442986.035|STATE|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Broker changed state INIT -> TRY_CONNECT
%7|1602442986.035|BROADCAST|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442986.035|CONNECT|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: broker in state TRY_CONNECT connecting
%7|1602442986.035|STATE|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Broker changed state TRY_CONNECT -> CONNECT
%7|1602442986.035|BROADCAST|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442986.035|WAKEUPFD|rdkafka#producer-2| [thrd:main]: TxnCoordinator: Enabled low-latency ops queue wake-ups
%7|1602442986.035|BRKMAIN|rdkafka#producer-2| [thrd::0/internal]: :0/internal: Enter main broker thread
%7|1602442986.035|CONNECT|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Connecting to ipv4#172.31.31.3:9092 (plaintext) with socket 11
%7|1602442986.035|BROKER|rdkafka#producer-2| [thrd:main]: TxnCoordinator: Added new broker with NodeId -1
%7|1602442986.035|WAKEUPFD|rdkafka#producer-2| [thrd:app]: 172.31.31.3:9092/bootstrap: Enabled low-latency ops queue wake-ups
%7|1602442986.035|BRKMAIN|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator: Enter main broker thread
%7|1602442986.035|STATE|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator: Broker changed state INIT -> TRY_CONNECT
%7|1602442986.035|BROKER|rdkafka#producer-2| [thrd:app]: 172.31.31.3:9092/bootstrap: Added new broker with NodeId -1
%7|1602442986.035|BROADCAST|rdkafka#producer-2| [thrd:TxnCoordinator]: Broadcasting state change
%7|1602442986.035|CONNECT|rdkafka#producer-2| [thrd:app]: 172.31.31.3:9092/bootstrap: Selected for cluster connection: bootstrap servers added (broker has 0 connection attempt(s))
%7|1602442986.035|CONNECT|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator: broker in state TRY_CONNECT connecting
%7|1602442986.035|CONNECT|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator: broker has no address yet: postponing connect
%7|1602442986.035|INIT|rdkafka#producer-2| [thrd:app]: librdkafka v1.5.0 (0x10500ff) rdkafka#producer-2 initialized (builtin.features gzip,snappy,ssl,sasl,regex,lz4,sasl_plain,sasl_scram,plugins,zstd,sasl_oauthbearer, STATIC_LINKING GCC GXX PKGCONFIG INSTALL GNULD LDS LIBDL PLUGINS STATIC_LIB_zlib ZLIB STATIC_LIB_libcrypto STATIC_LIB_libssl SSL STATIC_LIB_libzstd ZSTD HDRHISTOGRAM SYSLOG SNAPPY SOCKEM SASL_SCRAM SASL_OAUTHBEARER CRC32C_HW, debug 0xfffff)
%7|1602442986.035|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: init_transactions
%7|1602442986.035|BRKMAIN|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enter main broker thread
%7|1602442986.035|CONNECT|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Received CONNECT op
%7|1602442986.035|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Init -> WaitPID
%7|1602442986.035|STATE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Broker changed state INIT -> TRY_CONNECT
%7|1602442986.035|IDEMPSTATE|rdkafka#producer-2| [thrd:main]: Idempotent producer state change Init -> RequestPID
%7|1602442986.035|TXN|rdkafka#producer-2| [thrd:main]: Starting PID FSM timer (fire immediately): Starting idempotent producer
%7|1602442986.035|BROADCAST|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442986.035|CONNECT|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: broker in state TRY_CONNECT connecting
%7|1602442986.035|STATE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Broker changed state TRY_CONNECT -> CONNECT
%7|1602442986.035|CONNECT|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Connected to ipv4#172.31.31.3:9092
%7|1602442986.035|CONNECTED|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Connected (#1)
%7|1602442986.035|BROADCAST|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442986.035|FEATURE|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Updated enabled protocol features +ApiVersion to ApiVersion
%7|1602442986.035|STATE|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Broker changed state CONNECT -> APIVERSION_QUERY
%7|1602442986.035|BROADCAST|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442986.035|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Sent ApiVersionRequest (v3, 66 bytes @ 0, CorrId 1)
%7|1602442986.035|CONNECT|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Connecting to ipv4#172.31.31.3:9092 (plaintext) with socket 16
%7|1602442986.035|CONNECT|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Connected to ipv4#172.31.31.3:9092
%7|1602442986.035|CONNECTED|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Connected (#1)
%7|1602442986.035|FEATURE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Updated enabled protocol features +ApiVersion to ApiVersion
%7|1602442986.035|STATE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Broker changed state CONNECT -> APIVERSION_QUERY
%7|1602442986.035|BROADCAST|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442986.035|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Sent ApiVersionRequest (v3, 66 bytes @ 0, CorrId 1)
%7|1602442986.036|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Received ApiVersionResponse (v3, 344 bytes, CorrId 1, rtt 0.88ms)
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Broker API support:
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Produce (0) Versions 0..8
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Fetch (1) Versions 0..11
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Offset (2) Versions 0..5
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Metadata (3) Versions 0..9
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey LeaderAndIsr (4) Versions 0..4
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey StopReplica (5) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey UpdateMetadata (6) Versions 0..6
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey ControlledShutdown (7) Versions 0..3
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey OffsetCommit (8) Versions 0..8
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey OffsetFetch (9) Versions 0..7
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey FindCoordinator (10) Versions 0..3
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey JoinGroup (11) Versions 0..7
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Heartbeat (12) Versions 0..4
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey LeaveGroup (13) Versions 0..4
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey SyncGroup (14) Versions 0..5
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DescribeGroups (15) Versions 0..5
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey ListGroups (16) Versions 0..3
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey SaslHandshake (17) Versions 0..1
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey ApiVersion (18) Versions 0..3
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey CreateTopics (19) Versions 0..5
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DeleteTopics (20) Versions 0..4
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DeleteRecords (21) Versions 0..1
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey InitProducerId (22) Versions 0..3
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey OffsetForLeaderEpoch (23) Versions 0..3
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey AddPartitionsToTxn (24) Versions 0..1
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey AddOffsetsToTxn (25) Versions 0..1
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey EndTxn (26) Versions 0..1
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey WriteTxnMarkers (27) Versions 0..0
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey TxnOffsetCommit (28) Versions 0..3
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DescribeAcls (29) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey CreateAcls (30) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DeleteAcls (31) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DescribeConfigs (32) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey AlterConfigs (33) Versions 0..1
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey AlterReplicaLogDirs (34) Versions 0..1
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DescribeLogDirs (35) Versions 0..1
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey SaslAuthenticate (36) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey CreatePartitions (37) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey CreateDelegationToken (38) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey RenewDelegationToken (39) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey ExpireDelegationToken (40) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DescribeDelegationToken (41) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DeleteGroups (42) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Unknown-43? (43) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Unknown-44? (44) Versions 0..1
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Unknown-45? (45) Versions 0..0
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Unknown-46? (46) Versions 0..0
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Unknown-47? (47) Versions 0..0
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature MsgVer1: Produce (2..2) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature MsgVer1: Fetch (2..2) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature MsgVer1
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature MsgVer2: Produce (3..3) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature MsgVer2: Fetch (4..4) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature MsgVer2
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature ApiVersion: ApiVersion (0..0) supported by broker
%7|1602442986.036|CONNECT|rdkafka#producer-2| [thrd:main]: Not selecting any broker for cluster connection: still suppressed for 48ms: acquire ProducerID
%7|1602442986.036|PIDBROKER|rdkafka#producer-2| [thrd:main]: No brokers available for Transactions (2 broker(s) known)
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature ApiVersion
%7|1602442986.036|TXNCOORD|rdkafka#producer-2| [thrd:main]: Unable to query for transaction coordinator: No brokers available for Transactions (2 broker(s) known)
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerGroupCoordinator: FindCoordinator (0..0) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature BrokerGroupCoordinator
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: FindCoordinator (0..0) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: OffsetCommit (1..2) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: OffsetFetch (1..1) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: JoinGroup (0..0) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: SyncGroup (0..0) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: Heartbeat (0..0) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: LeaveGroup (0..0) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature BrokerBalancedConsumer
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature ThrottleTime: Produce (1..2) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature ThrottleTime: Fetch (1..2) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature ThrottleTime
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature Sasl: JoinGroup (0..0) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature Sasl
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature SaslHandshake: SaslHandshake (0..0) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature SaslHandshake
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature LZ4: FindCoordinator (0..0) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature LZ4
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature OffsetTime: Offset (1..1) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature OffsetTime
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature IdempotentProducer: InitProducerId (0..0) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature IdempotentProducer
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature ZSTD: Produce (7..7) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature ZSTD: Fetch (10..10) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature ZSTD
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature SaslAuthReq: SaslHandshake (1..1) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature SaslAuthReq: SaslAuthenticate (0..0) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature SaslAuthReq
%7|1602442986.036|FEATURE|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Updated enabled protocol features to MsgVer1,ApiVersion,BrokerBalancedConsumer,ThrottleTime,Sasl,SaslHandshake,BrokerGroupCoordinator,LZ4,OffsetTime,MsgVer2,IdempotentProducer,ZSTD,SaslAuthReq
%7|1602442986.036|STATE|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Broker changed state APIVERSION_QUERY -> UP
%7|1602442986.036|BROADCAST|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442986.036|METADATA|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Hinted cache of 1/1 topic(s) being queried
%7|1602442986.036|METADATA|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Requesting metadata for 1/1 topics: connected
%7|1602442986.036|METADATA|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Request metadata for 1 topic(s): connected
%7|1602442986.036|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Received ApiVersionResponse (v3, 344 bytes, CorrId 1, rtt 0.90ms)
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Broker API support:
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Produce (0) Versions 0..8
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Fetch (1) Versions 0..11
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Offset (2) Versions 0..5
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Metadata (3) Versions 0..9
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey LeaderAndIsr (4) Versions 0..4
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey StopReplica (5) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey UpdateMetadata (6) Versions 0..6
%7|1602442986.036|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Sent MetadataRequest (v4, 54 bytes @ 0, CorrId 2)
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey ControlledShutdown (7) Versions 0..3
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey OffsetCommit (8) Versions 0..8
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey OffsetFetch (9) Versions 0..7
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey FindCoordinator (10) Versions 0..3
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey JoinGroup (11) Versions 0..7
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Heartbeat (12) Versions 0..4
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey LeaveGroup (13) Versions 0..4
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey SyncGroup (14) Versions 0..5
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DescribeGroups (15) Versions 0..5
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey ListGroups (16) Versions 0..3
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey SaslHandshake (17) Versions 0..1
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey ApiVersion (18) Versions 0..3
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey CreateTopics (19) Versions 0..5
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DeleteTopics (20) Versions 0..4
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DeleteRecords (21) Versions 0..1
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey InitProducerId (22) Versions 0..3
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey OffsetForLeaderEpoch (23) Versions 0..3
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey AddPartitionsToTxn (24) Versions 0..1
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey AddOffsetsToTxn (25) Versions 0..1
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey EndTxn (26) Versions 0..1
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey WriteTxnMarkers (27) Versions 0..0
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey TxnOffsetCommit (28) Versions 0..3
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DescribeAcls (29) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey CreateAcls (30) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DeleteAcls (31) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DescribeConfigs (32) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey AlterConfigs (33) Versions 0..1
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey AlterReplicaLogDirs (34) Versions 0..1
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DescribeLogDirs (35) Versions 0..1
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey SaslAuthenticate (36) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey CreatePartitions (37) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey CreateDelegationToken (38) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey RenewDelegationToken (39) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey ExpireDelegationToken (40) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DescribeDelegationToken (41) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey DeleteGroups (42) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Unknown-43? (43) Versions 0..2
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Unknown-44? (44) Versions 0..1
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Unknown-45? (45) Versions 0..0
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Unknown-46? (46) Versions 0..0
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:   ApiKey Unknown-47? (47) Versions 0..0
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature MsgVer1: Produce (2..2) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature MsgVer1: Fetch (2..2) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature MsgVer1
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature MsgVer2: Produce (3..3) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature MsgVer2: Fetch (4..4) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature MsgVer2
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature ApiVersion: ApiVersion (0..0) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature ApiVersion
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerGroupCoordinator: FindCoordinator (0..0) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature BrokerGroupCoordinator
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: FindCoordinator (0..0) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: OffsetCommit (1..2) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: OffsetFetch (1..1) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: JoinGroup (0..0) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: SyncGroup (0..0) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: Heartbeat (0..0) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature BrokerBalancedConsumer: LeaveGroup (0..0) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature BrokerBalancedConsumer
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature ThrottleTime: Produce (1..2) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature ThrottleTime: Fetch (1..2) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature ThrottleTime
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature Sasl: JoinGroup (0..0) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature Sasl
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature SaslHandshake: SaslHandshake (0..0) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature SaslHandshake
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature LZ4: FindCoordinator (0..0) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature LZ4
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature OffsetTime: Offset (1..1) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature OffsetTime
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature IdempotentProducer: InitProducerId (0..0) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature IdempotentProducer
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature ZSTD: Produce (7..7) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature ZSTD: Fetch (10..10) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature ZSTD
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature SaslAuthReq: SaslHandshake (1..1) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap:  Feature SaslAuthReq: SaslAuthenticate (0..0) supported by broker
%7|1602442986.036|APIVERSION|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Enabling feature SaslAuthReq
%7|1602442986.036|FEATURE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Updated enabled protocol features to MsgVer1,ApiVersion,BrokerBalancedConsumer,ThrottleTime,Sasl,SaslHandshake,BrokerGroupCoordinator,LZ4,OffsetTime,MsgVer2,IdempotentProducer,ZSTD,SaslAuthReq
%7|1602442986.036|STATE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Broker changed state APIVERSION_QUERY -> UP
%7|1602442986.036|BROADCAST|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442986.036|METADATA|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Request metadata for brokers only: connected
%7|1602442986.036|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Sent MetadataRequest (v4, 26 bytes @ 0, CorrId 2)
%7|1602442986.036|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Received MetadataResponse (v4, 63 bytes, CorrId 2, rtt 0.27ms)
%7|1602442986.036|METADATA|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/bootstrap: ===== Received metadata: connected =====
%7|1602442986.036|METADATA|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/bootstrap: ClusterId: P3Dm2isBTn-IXhcu_D5JSw, ControllerId: 1001
%7|1602442986.036|METADATA|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/bootstrap: 1 brokers, 0 topics
%7|1602442986.036|METADATA|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/bootstrap:   Broker #0/1: 172.31.31.3:9092 NodeId 1001
%7|1602442986.036|CLUSTERID|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/bootstrap: ClusterId update "" -> "P3Dm2isBTn-IXhcu_D5JSw"
%7|1602442986.036|CONTROLLERID|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/bootstrap: ControllerId update -1 -> 1001
%7|1602442986.036|BROADCAST|rdkafka#producer-2| [thrd:main]: Broadcasting state change
%7|1602442986.036|UPDATE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: NodeId changed from -1 to 1001
%7|1602442986.036|UPDATE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Name changed from 172.31.31.3:9092/bootstrap to 172.31.31.3:9092/1001
%7|1602442986.036|LEADER|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Mapped 0 partition(s) to broker
%7|1602442986.036|STATE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Broker changed state UP -> UPDATE
%7|1602442986.036|BROADCAST|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442986.036|BROADCAST|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442986.036|STATE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Broker changed state UPDATE -> UP
%7|1602442986.036|BROADCAST|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442986.036|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FindCoordinatorRequest (v2, 43 bytes @ 0, CorrId 3)
%7|1602442986.037|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: Received MetadataResponse (v4, 124 bytes, CorrId 2, rtt 0.58ms)
%7|1602442986.037|METADATA|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/bootstrap: ===== Received metadata (for 1 requested topics): connected =====
%7|1602442986.037|METADATA|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/bootstrap: ClusterId: P3Dm2isBTn-IXhcu_D5JSw, ControllerId: 1001
%7|1602442986.037|METADATA|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/bootstrap: 1 brokers, 1 topics
%7|1602442986.037|METADATA|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/bootstrap:   Broker #0/1: 172.31.31.3:9092 NodeId 1001
%7|1602442986.037|METADATA|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/bootstrap:   Topic #0/1: demoinput1602442758 with 1 partitions
%7|1602442986.037|STATE|rdkafka#consumer-1| [thrd:main]: Topic demoinput1602442758 changed state unknown -> exists
%7|1602442986.037|PARTCNT|rdkafka#consumer-1| [thrd:main]: Topic demoinput1602442758 partition count changed from 0 to 1
%7|1602442986.037|METADATA|rdkafka#consumer-1| [thrd:main]:   Topic demoinput1602442758 partition 0 Leader 1001
%7|1602442986.037|BRKDELGT|rdkafka#consumer-1| [thrd:main]: demoinput1602442758 [0]: delegate to broker (none) (rktp 0x7f4ea40035b0, term 0, ref 3)
%7|1602442986.037|BRKDELGT|rdkafka#consumer-1| [thrd:main]: demoinput1602442758 [0]: delegating to broker :0/internal for partition with 0 messages (0 bytes) queued
%7|1602442986.037|BRKMIGR|rdkafka#consumer-1| [thrd:main]: Migrating topic demoinput1602442758 [0] 0x7f4ea40035b0 from (none) to :0/internal (sending PARTITION_JOIN to :0/internal)
%7|1602442986.037|METADATA|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/bootstrap: 1/1 requested topic(s) seen in metadata
%7|1602442986.037|CLUSTERID|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/bootstrap: ClusterId update "" -> "P3Dm2isBTn-IXhcu_D5JSw"
%7|1602442986.037|CONTROLLERID|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/bootstrap: ControllerId update -1 -> 1001
%7|1602442986.037|TOPBRK|rdkafka#consumer-1| [thrd::0/internal]: :0/internal: Topic demoinput1602442758 [0]: joining broker (rktp 0x7f4ea40035b0, 0 message(s) queued)
%7|1602442986.037|BROADCAST|rdkafka#consumer-1| [thrd::0/internal]: Broadcasting state change
%7|1602442986.037|BROADCAST|rdkafka#consumer-1| [thrd:main]: Broadcasting state change
%7|1602442986.037|CGRPQUERY|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/bootstrap: Group "kafka-tr-issue-201011-tr": querying for coordinator: intervaled in state query-coord
%7|1602442986.037|CGRPSTATE|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" changed state query-coord -> wait-coord (v3, join-state assigned)
%7|1602442986.037|BROADCAST|rdkafka#consumer-1| [thrd:main]: Broadcasting state change
%7|1602442986.037|UPDATE|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/bootstrap: NodeId changed from -1 to 1001
%7|1602442986.037|UPDATE|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Name changed from 172.31.31.3:9092/bootstrap to 172.31.31.3:9092/1001
%7|1602442986.037|TOPICUPD|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Topic demoinput1602442758 [0]: migrating from broker -1 to 1001 (leader is 1001): broker node information updated
%7|1602442986.037|BRKDELGT|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: demoinput1602442758 [0]: delegate to broker 172.31.31.3:9092/1001 (rktp 0x7f4ea40035b0, term 0, ref 3)
%7|1602442986.037|BRKDELGT|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: demoinput1602442758 [0]: no longer delegated to broker :0/internal
%7|1602442986.037|BRKDELGT|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: demoinput1602442758 [0]: delegating to broker 172.31.31.3:9092/1001 for partition with 0 messages (0 bytes) queued
%7|1602442986.037|BRKMIGR|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Migrating topic demoinput1602442758 [0] 0x7f4ea40035b0 from :0/internal to 172.31.31.3:9092/1001 (sending PARTITION_LEAVE to :0/internal)
%7|1602442986.037|LEADER|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Mapped 1 partition(s) to broker
%7|1602442986.037|STATE|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Broker changed state UP -> UPDATE
%7|1602442986.037|BROADCAST|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442986.037|TOPBRK|rdkafka#consumer-1| [thrd::0/internal]: :0/internal: Topic demoinput1602442758 [0]: leaving broker (0 messages in xmitq, next broker 172.31.31.3:9092/1001, rktp 0x7f4ea40035b0)
%7|1602442986.037|BROADCAST|rdkafka#consumer-1| [thrd::0/internal]: Broadcasting state change
%7|1602442986.037|BROADCAST|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442986.037|TOPBRK|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0]: joining broker (rktp 0x7f4ea40035b0, 0 message(s) queued)
%7|1602442986.037|BROADCAST|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442986.037|STATE|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Broker changed state UPDATE -> UP
%7|1602442986.037|BROADCAST|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442986.037|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FindCoordinatorResponse (v2, 33 bytes, CorrId 3, rtt 0.33ms)
%7|1602442986.037|TXNCOORD|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: FindCoordinator response: Transaction coordinator is broker 1001 (172.31.31.3:9092)
%7|1602442986.037|TXNCOORD|rdkafka#producer-2| [thrd:main]: Transaction coordinator changed from (none) -> 172.31.31.3:9092/1001: FindCoordinator response
%7|1602442986.037|NODENAME|rdkafka#producer-2| [thrd:main]: TxnCoordinator: Broker nodename changed from "" to "172.31.31.3:9092"
%7|1602442986.037|IDEMPSTATE|rdkafka#producer-2| [thrd:main]: Idempotent producer state change RequestPID -> WaitTransport
%7|1602442986.037|TXN|rdkafka#producer-2| [thrd:main]: Starting PID FSM timer: No broker available
%7|1602442986.037|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FindCoordinatorRequest (v2, 48 bytes @ 0, CorrId 3)
%7|1602442986.037|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FindCoordinatorResponse (v2, 33 bytes, CorrId 3, rtt 0.14ms)
%7|1602442986.037|CGRPCOORD|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/1001: Group "kafka-tr-issue-201011-tr" coordinator is 172.31.31.3:9092 id 1001
%7|1602442986.037|CGRPCOORD|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" changing coordinator -1 -> 1001
%7|1602442986.037|COORDSET|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" coordinator set to broker 172.31.31.3:9092/1001
%7|1602442986.037|CGRPSTATE|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" changed state wait-coord -> wait-broker-transport (v3, join-state assigned)
%7|1602442986.037|BROADCAST|rdkafka#consumer-1| [thrd:main]: Broadcasting state change
%7|1602442986.037|NODENAME|rdkafka#consumer-1| [thrd:main]: GroupCoordinator: Broker nodename changed from "" to "172.31.31.3:9092"
%7|1602442986.037|CGRPQUERY|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/1001: Group "kafka-tr-issue-201011-tr": querying for coordinator: intervaled in state wait-broker-transport
%7|1602442986.037|CONNECT|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Received CONNECT op
%7|1602442986.037|STATE|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator: Broker changed state INIT -> TRY_CONNECT
%7|1602442986.037|BROADCAST|rdkafka#consumer-1| [thrd:GroupCoordinator]: Broadcasting state change
%7|1602442986.037|FAIL|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Closing connection due to nodename change (after 0ms in state TRY_CONNECT) (_TRANSPORT)
%7|1602442986.037|STATE|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator: Broker changed state TRY_CONNECT -> DOWN
%7|1602442986.037|BROADCAST|rdkafka#consumer-1| [thrd:GroupCoordinator]: Broadcasting state change
%7|1602442986.037|BUFQ|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Purging bufq with 0 buffers
%7|1602442986.037|BUFQ|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Purging bufq with 0 buffers
%7|1602442986.037|BUFQ|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Updating 0 buffers on connection reset
%7|1602442986.037|STATE|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator: Broker changed state DOWN -> INIT
%7|1602442986.037|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FindCoordinatorRequest (v2, 48 bytes @ 0, CorrId 4)
%7|1602442986.037|BROADCAST|rdkafka#consumer-1| [thrd:GroupCoordinator]: Broadcasting state change
%7|1602442986.037|STATE|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator: Broker changed state INIT -> TRY_CONNECT
%7|1602442986.037|BROADCAST|rdkafka#consumer-1| [thrd:GroupCoordinator]: Broadcasting state change
%7|1602442986.037|CONNECT|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: broker in state TRY_CONNECT connecting
%7|1602442986.037|STATE|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator: Broker changed state TRY_CONNECT -> CONNECT
%7|1602442986.037|BROADCAST|rdkafka#consumer-1| [thrd:GroupCoordinator]: Broadcasting state change
%7|1602442986.037|CONNECT|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Connecting to ipv4#172.31.31.3:9092 (plaintext) with socket 17
%7|1602442986.037|CONNECT|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Connected to ipv4#172.31.31.3:9092
%7|1602442986.037|CONNECTED|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Connected (#1)
%7|1602442986.037|FEATURE|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Updated enabled protocol features +ApiVersion to ApiVersion
%7|1602442986.037|STATE|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator: Broker changed state CONNECT -> APIVERSION_QUERY
%7|1602442986.037|BROADCAST|rdkafka#consumer-1| [thrd:GroupCoordinator]: Broadcasting state change
%7|1602442986.037|SEND|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Sent ApiVersionRequest (v3, 66 bytes @ 0, CorrId 1)
%7|1602442986.037|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FindCoordinatorResponse (v2, 33 bytes, CorrId 4, rtt 0.29ms)
%7|1602442986.037|CGRPCOORD|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/1001: Group "kafka-tr-issue-201011-tr" coordinator is 172.31.31.3:9092 id 1001
%7|1602442986.038|RECV|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Received ApiVersionResponse (v3, 344 bytes, CorrId 1, rtt 0.34ms)
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Broker API support:
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey Produce (0) Versions 0..8
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey Fetch (1) Versions 0..11
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey Offset (2) Versions 0..5
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey Metadata (3) Versions 0..9
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey LeaderAndIsr (4) Versions 0..4
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey StopReplica (5) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey UpdateMetadata (6) Versions 0..6
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey ControlledShutdown (7) Versions 0..3
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey OffsetCommit (8) Versions 0..8
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey OffsetFetch (9) Versions 0..7
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey FindCoordinator (10) Versions 0..3
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey JoinGroup (11) Versions 0..7
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey Heartbeat (12) Versions 0..4
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey LeaveGroup (13) Versions 0..4
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey SyncGroup (14) Versions 0..5
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey DescribeGroups (15) Versions 0..5
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey ListGroups (16) Versions 0..3
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey SaslHandshake (17) Versions 0..1
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey ApiVersion (18) Versions 0..3
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey CreateTopics (19) Versions 0..5
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey DeleteTopics (20) Versions 0..4
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey DeleteRecords (21) Versions 0..1
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey InitProducerId (22) Versions 0..3
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey OffsetForLeaderEpoch (23) Versions 0..3
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey AddPartitionsToTxn (24) Versions 0..1
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey AddOffsetsToTxn (25) Versions 0..1
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey EndTxn (26) Versions 0..1
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey WriteTxnMarkers (27) Versions 0..0
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey TxnOffsetCommit (28) Versions 0..3
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey DescribeAcls (29) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey CreateAcls (30) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey DeleteAcls (31) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey DescribeConfigs (32) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey AlterConfigs (33) Versions 0..1
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey AlterReplicaLogDirs (34) Versions 0..1
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey DescribeLogDirs (35) Versions 0..1
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey SaslAuthenticate (36) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey CreatePartitions (37) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey CreateDelegationToken (38) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey RenewDelegationToken (39) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey ExpireDelegationToken (40) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey DescribeDelegationToken (41) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey DeleteGroups (42) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey Unknown-43? (43) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey Unknown-44? (44) Versions 0..1
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey Unknown-45? (45) Versions 0..0
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey Unknown-46? (46) Versions 0..0
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:   ApiKey Unknown-47? (47) Versions 0..0
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature MsgVer1: Produce (2..2) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature MsgVer1: Fetch (2..2) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature MsgVer1
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature MsgVer2: Produce (3..3) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature MsgVer2: Fetch (4..4) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature MsgVer2
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature ApiVersion: ApiVersion (0..0) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature ApiVersion
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature BrokerGroupCoordinator: FindCoordinator (0..0) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature BrokerGroupCoordinator
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature BrokerBalancedConsumer: FindCoordinator (0..0) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature BrokerBalancedConsumer: OffsetCommit (1..2) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature BrokerBalancedConsumer: OffsetFetch (1..1) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature BrokerBalancedConsumer: JoinGroup (0..0) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature BrokerBalancedConsumer: SyncGroup (0..0) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature BrokerBalancedConsumer: Heartbeat (0..0) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature BrokerBalancedConsumer: LeaveGroup (0..0) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature BrokerBalancedConsumer
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature ThrottleTime: Produce (1..2) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature ThrottleTime: Fetch (1..2) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature ThrottleTime
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature Sasl: JoinGroup (0..0) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature Sasl
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature SaslHandshake: SaslHandshake (0..0) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature SaslHandshake
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature LZ4: FindCoordinator (0..0) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature LZ4
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature OffsetTime: Offset (1..1) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature OffsetTime
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature IdempotentProducer: InitProducerId (0..0) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature IdempotentProducer
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature ZSTD: Produce (7..7) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature ZSTD: Fetch (10..10) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature ZSTD
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature SaslAuthReq: SaslHandshake (1..1) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001:  Feature SaslAuthReq: SaslAuthenticate (0..0) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Enabling feature SaslAuthReq
%7|1602442986.038|FEATURE|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Updated enabled protocol features to MsgVer1,ApiVersion,BrokerBalancedConsumer,ThrottleTime,Sasl,SaslHandshake,BrokerGroupCoordinator,LZ4,OffsetTime,MsgVer2,IdempotentProducer,ZSTD,SaslAuthReq
%7|1602442986.038|STATE|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator: Broker changed state APIVERSION_QUERY -> UP
%7|1602442986.038|BROADCAST|rdkafka#consumer-1| [thrd:GroupCoordinator]: Broadcasting state change
%7|1602442986.038|METADATA|rdkafka#consumer-1| [thrd:GroupCoordinator]: Skipping metadata refresh of 1 topic(s): connected: already being requested
%7|1602442986.038|FAIL|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Closing connection due to nodename change (after 3ms in state TRY_CONNECT) (_TRANSPORT)
%7|1602442986.038|STATE|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator: Broker changed state TRY_CONNECT -> DOWN
%7|1602442986.038|BROADCAST|rdkafka#producer-2| [thrd:TxnCoordinator]: Broadcasting state change
%7|1602442986.038|BUFQ|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Purging bufq with 0 buffers
%7|1602442986.038|BUFQ|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Purging bufq with 0 buffers
%7|1602442986.038|BUFQ|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Updating 0 buffers on connection reset
%7|1602442986.038|STATE|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator: Broker changed state DOWN -> INIT
%7|1602442986.038|BROADCAST|rdkafka#producer-2| [thrd:TxnCoordinator]: Broadcasting state change
%7|1602442986.038|STATE|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator: Broker changed state INIT -> TRY_CONNECT
%7|1602442986.038|BROADCAST|rdkafka#producer-2| [thrd:TxnCoordinator]: Broadcasting state change
%7|1602442986.038|CONNECT|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: broker in state TRY_CONNECT connecting
%7|1602442986.038|STATE|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator: Broker changed state TRY_CONNECT -> CONNECT
%7|1602442986.038|BROADCAST|rdkafka#producer-2| [thrd:TxnCoordinator]: Broadcasting state change
%7|1602442986.038|CONNECT|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Connecting to ipv4#172.31.31.3:9092 (plaintext) with socket 18
%7|1602442986.038|CONNECT|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Connected to ipv4#172.31.31.3:9092
%7|1602442986.038|CONNECTED|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Connected (#1)
%7|1602442986.038|FEATURE|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Updated enabled protocol features +ApiVersion to ApiVersion
%7|1602442986.038|STATE|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator: Broker changed state CONNECT -> APIVERSION_QUERY
%7|1602442986.038|BROADCAST|rdkafka#producer-2| [thrd:TxnCoordinator]: Broadcasting state change
%7|1602442986.038|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent ApiVersionRequest (v3, 66 bytes @ 0, CorrId 1)
%7|1602442986.038|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received ApiVersionResponse (v3, 344 bytes, CorrId 1, rtt 0.27ms)
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Broker API support:
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey Produce (0) Versions 0..8
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey Fetch (1) Versions 0..11
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey Offset (2) Versions 0..5
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey Metadata (3) Versions 0..9
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey LeaderAndIsr (4) Versions 0..4
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey StopReplica (5) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey UpdateMetadata (6) Versions 0..6
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey ControlledShutdown (7) Versions 0..3
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey OffsetCommit (8) Versions 0..8
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey OffsetFetch (9) Versions 0..7
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey FindCoordinator (10) Versions 0..3
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey JoinGroup (11) Versions 0..7
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey Heartbeat (12) Versions 0..4
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey LeaveGroup (13) Versions 0..4
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey SyncGroup (14) Versions 0..5
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey DescribeGroups (15) Versions 0..5
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey ListGroups (16) Versions 0..3
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey SaslHandshake (17) Versions 0..1
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey ApiVersion (18) Versions 0..3
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey CreateTopics (19) Versions 0..5
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey DeleteTopics (20) Versions 0..4
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey DeleteRecords (21) Versions 0..1
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey InitProducerId (22) Versions 0..3
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey OffsetForLeaderEpoch (23) Versions 0..3
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey AddPartitionsToTxn (24) Versions 0..1
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey AddOffsetsToTxn (25) Versions 0..1
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey EndTxn (26) Versions 0..1
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey WriteTxnMarkers (27) Versions 0..0
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey TxnOffsetCommit (28) Versions 0..3
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey DescribeAcls (29) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey CreateAcls (30) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey DeleteAcls (31) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey DescribeConfigs (32) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey AlterConfigs (33) Versions 0..1
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey AlterReplicaLogDirs (34) Versions 0..1
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey DescribeLogDirs (35) Versions 0..1
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey SaslAuthenticate (36) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey CreatePartitions (37) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey CreateDelegationToken (38) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey RenewDelegationToken (39) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey ExpireDelegationToken (40) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey DescribeDelegationToken (41) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey DeleteGroups (42) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey Unknown-43? (43) Versions 0..2
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey Unknown-44? (44) Versions 0..1
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey Unknown-45? (45) Versions 0..0
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey Unknown-46? (46) Versions 0..0
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:   ApiKey Unknown-47? (47) Versions 0..0
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature MsgVer1: Produce (2..2) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature MsgVer1: Fetch (2..2) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature MsgVer1
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature MsgVer2: Produce (3..3) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature MsgVer2: Fetch (4..4) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature MsgVer2
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature ApiVersion: ApiVersion (0..0) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature ApiVersion
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature BrokerGroupCoordinator: FindCoordinator (0..0) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature BrokerGroupCoordinator
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature BrokerBalancedConsumer: FindCoordinator (0..0) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature BrokerBalancedConsumer: OffsetCommit (1..2) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature BrokerBalancedConsumer: OffsetFetch (1..1) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature BrokerBalancedConsumer: JoinGroup (0..0) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature BrokerBalancedConsumer: SyncGroup (0..0) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature BrokerBalancedConsumer: Heartbeat (0..0) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature BrokerBalancedConsumer: LeaveGroup (0..0) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature BrokerBalancedConsumer
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature ThrottleTime: Produce (1..2) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature ThrottleTime: Fetch (1..2) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature ThrottleTime
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature Sasl: JoinGroup (0..0) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature Sasl
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature SaslHandshake: SaslHandshake (0..0) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature SaslHandshake
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature LZ4: FindCoordinator (0..0) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature LZ4
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature OffsetTime: Offset (1..1) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature OffsetTime
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature IdempotentProducer: InitProducerId (0..0) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature IdempotentProducer
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature ZSTD: Produce (7..7) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature ZSTD: Fetch (10..10) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature ZSTD
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature SaslAuthReq: SaslHandshake (1..1) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001:  Feature SaslAuthReq: SaslAuthenticate (0..0) supported by broker
%7|1602442986.038|APIVERSION|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Enabling feature SaslAuthReq
%7|1602442986.038|FEATURE|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Updated enabled protocol features to MsgVer1,ApiVersion,BrokerBalancedConsumer,ThrottleTime,Sasl,SaslHandshake,BrokerGroupCoordinator,LZ4,OffsetTime,MsgVer2,IdempotentProducer,ZSTD,SaslAuthReq
%7|1602442986.038|STATE|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator: Broker changed state APIVERSION_QUERY -> UP
%7|1602442986.038|BROADCAST|rdkafka#producer-2| [thrd:TxnCoordinator]: Broadcasting state change
%7|1602442986.038|METADATA|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Request metadata for brokers only: connected
%7|1602442986.038|COORD|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Transaction coordinator is now up
%7|1602442986.038|GETPID|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Acquiring ProducerId
%7|1602442986.039|IDEMPSTATE|rdkafka#producer-2| [thrd:main]: Idempotent producer state change WaitTransport -> WaitPID
%7|1602442986.039|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent MetadataRequest (v4, 26 bytes @ 0, CorrId 2)
%7|1602442986.039|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent InitProducerIdRequest (v1, 46 bytes @ 0, CorrId 3)
%7|1602442986.039|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received MetadataResponse (v4, 63 bytes, CorrId 2, rtt 0.15ms)
%7|1602442986.039|METADATA|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: ===== Received metadata: connected =====
%7|1602442986.039|METADATA|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: ClusterId: P3Dm2isBTn-IXhcu_D5JSw, ControllerId: 1001
%7|1602442986.039|METADATA|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: 1 brokers, 0 topics
%7|1602442986.039|METADATA|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001:   Broker #0/1: 172.31.31.3:9092 NodeId 1001
%7|1602442986.039|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received InitProducerIdResponse (v1, 16 bytes, CorrId 3, rtt 0.81ms)
%7|1602442986.039|GETPID|rdkafka#producer-2| [thrd:main]: Acquired PID{Id:0,Epoch:3}
%7|1602442986.039|IDEMPSTATE|rdkafka#producer-2| [thrd:main]: Idempotent producer state change WaitPID -> Assigned
%7|1602442986.039|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change WaitPID -> ReadyNotAcked
%7|1602442986.039|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442986.039|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442986.039|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: init_transactions
%7|1602442986.039|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change ReadyNotAcked -> Ready
%7|1602442986.039|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442986.039|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442986.039|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
=== Starting Consume-Transform-Process loop ===
%7|1602442986.536|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FindCoordinatorRequest (v2, 43 bytes @ 0, CorrId 4)
%7|1602442986.537|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FindCoordinatorResponse (v2, 33 bytes, CorrId 4, rtt 0.56ms)
%7|1602442986.537|TXNCOORD|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: FindCoordinator response: Transaction coordinator is broker 1001 (172.31.31.3:9092)
%7|1602442987.034|CGRPSTATE|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" changed state wait-broker-transport -> up (v3, join-state assigned)
%7|1602442987.034|BROADCAST|rdkafka#consumer-1| [thrd:main]: Broadcasting state change
%7|1602442987.034|BARRIER|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr": rd_kafka_cgrp_partitions_fetch_start0:1878: new version barrier v4
%7|1602442987.034|FETCHSTART|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr": starting fetchers for 1 assigned partition(s) in join-state assigned (usable_offsets=no, v4, line 3431)
%7|1602442987.034|FETCHSTART|rdkafka#consumer-1| [thrd:main]: List with 1 partition(s):
%7|1602442987.034|FETCHSTART|rdkafka#consumer-1| [thrd:main]:  demoinput1602442758 [0] offset INVALID
%7|1602442987.034|OFFSET|rdkafka#consumer-1| [thrd:main]: GroupCoordinator/1001: OffsetFetchRequest(v1) for 1/1 partition(s)
%7|1602442987.034|OFFSET|rdkafka#consumer-1| [thrd:main]: GroupCoordinator/1001: Fetch committed offsets for 1/1 partition(s)
%7|1602442987.035|SEND|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Sent OffsetFetchRequest (v1, 87 bytes @ 0, CorrId 2)
%7|1602442987.035|RECV|rdkafka#consumer-1| [thrd:GroupCoordinator]: GroupCoordinator/1001: Received OffsetFetchResponse (v1, 52 bytes, CorrId 2, rtt 0.58ms)
%7|1602442987.035|OFFSETFETCH|rdkafka#consumer-1| [thrd:main]: List with 1 partition(s):
%7|1602442987.035|OFFSETFETCH|rdkafka#consumer-1| [thrd:main]:  demoinput1602442758 [0] offset INVALID
%7|1602442987.035|OFFSET|rdkafka#consumer-1| [thrd:main]: Topic demoinput1602442758 [0]: setting default offset INVALID
%7|1602442987.035|OFFSETFETCH|rdkafka#consumer-1| [thrd:main]: GroupCoordinator/1001: OffsetFetchResponse: demoinput1602442758 [0] offset 60, metadata 0 byte(s)
%7|1602442987.035|OFFFETCH|rdkafka#consumer-1| [thrd:main]: GroupCoordinator/1001: OffsetFetch for 1/1 partition(s) returned Success
%7|1602442987.035|BARRIER|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr": rd_kafka_cgrp_partitions_fetch_start0:1878: new version barrier v5
%7|1602442987.035|FETCHSTART|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr": starting fetchers for 1 assigned partition(s) in join-state assigned (usable_offsets=yes, v5, line 1810)
%7|1602442987.035|FETCHSTART|rdkafka#consumer-1| [thrd:main]: List with 1 partition(s):
%7|1602442987.035|FETCHSTART|rdkafka#consumer-1| [thrd:main]:  demoinput1602442758 [0] offset 60
%7|1602442987.035|CGRPJOINSTATE|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" changed join state assigned -> started (v5, state up)
%7|1602442987.035|BARRIER|rdkafka#consumer-1| [thrd:main]: demoinput1602442758 [0]: rd_kafka_toppar_op_fetch_start:2299: new version barrier v2
%7|1602442987.035|CONSUMER|rdkafka#consumer-1| [thrd:main]: Start consuming demoinput1602442758 [0] at offset 60 (v2)
%7|1602442987.035|OP|rdkafka#consumer-1| [thrd:main]: demoinput1602442758 [0] received op FETCH_START (v2) in fetch-state none (opv1)
%7|1602442987.035|FETCH|rdkafka#consumer-1| [thrd:main]: Start fetch for demoinput1602442758 [0] in state none at offset 60 (v2)
%7|1602442987.035|PARTSTATE|rdkafka#consumer-1| [thrd:main]: Partition demoinput1602442758 [0] changed fetch state none -> active
%7|1602442987.035|FETCH|rdkafka#consumer-1| [thrd:main]: Partition demoinput1602442758 [0] start fetching at offset 60
%7|1602442987.035|WAKEUP|rdkafka#consumer-1| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442987.035|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op PARTITION_JOIN in state up (join state started, v5) for demoinput1602442758 [0]
%7|1602442987.035|PARTADD|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr": add demoinput1602442758 [0]
%7|1602442987.035|FETCHDEC|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: Topic demoinput1602442758 [0]: fetch decide: updating to version 2 (was 0) at offset 60 (was 0)
%7|1602442987.035|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] in state active at offset 60 (0/100000 msgs, 0/65536 kb queued, opv 2) is fetchable
%7|1602442987.035|FETCHADD|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Added demoinput1602442758 [0] to fetch list (1 entries, opv 2, 0 messages queued): fetchable
%7|1602442987.035|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 60 (v2)
%7|1602442987.035|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442987.035|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 5)
%7|1602442987.537|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 88 bytes, CorrId 5, rtt 501.40ms)
%7|1602442987.537|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 0, error "Success", MaxOffset 60, LSO 60, Ver 2/2
%7|1602442987.537|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 60 (v2)
%7|1602442987.537|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442987.537|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 6)
=== Reached the end of demoinput1602442758 [0] at 60====
%7|1602442987.537|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
=== Reached end of input ===
%7|1602442988.007|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 159 bytes, CorrId 6, rtt 470.12ms)
%7|1602442988.007|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 71, error "Success", MaxOffset 61, LSO 61, Ver 2/2
%7|1602442988.007|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (3 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 60, 0 ctrl msgs, uncompressed)
%7|1602442988.007|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 61 (v2)
%7|1602442988.007|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442988.007|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 7)
%7|1602442988.007|TOPIC|rdkafka#producer-2| [thrd:app]: New local topic: demooutput1602442758
%7|1602442988.007|TOPPARNEW|rdkafka#producer-2| [thrd:app]: NEW demooutput1602442758 [-1] 0x558f46383510 (at rd_kafka_topic_new0:441)
=== Committing transaction with 1 messages at input offset 60 ===
:DEMO:START 1602442988.0078986
%7|1602442988.007|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442988.007|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442988.008|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 4)
%7|1602442988.009|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 4, rtt 1.19ms)
%7|1602442988.009|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FindCoordinatorRequest (v2, 48 bytes @ 0, CorrId 5)
%7|1602442988.009|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FindCoordinatorResponse (v2, 33 bytes, CorrId 5, rtt 0.38ms)
%7|1602442988.009|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 6)
%7|1602442988.010|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 6, rtt 0.88ms)
:DEMO:END   1602442988.0106611 0.0027625560760498047
%7|1602442988.010|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442988.010|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442988.010|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 1 outstanding message(s) prior to commit
%7|1602442988.035|NOINFO|rdkafka#producer-2| [thrd:main]: Topic demooutput1602442758 metadata information unknown
%7|1602442988.035|NOINFO|rdkafka#producer-2| [thrd:main]: Topic demooutput1602442758 partition count is zero: should refresh metadata
%7|1602442988.035|METADATA|rdkafka#producer-2| [thrd:main]: Requesting metadata for 1/1 topics: refresh unavailable topics
%7|1602442988.035|METADATA|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Request metadata for 1 topic(s): refresh unavailable topics
%7|1602442988.035|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent MetadataRequest (v4, 54 bytes @ 0, CorrId 7)
%7|1602442988.036|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received MetadataResponse (v4, 124 bytes, CorrId 7, rtt 0.72ms)
%7|1602442988.036|METADATA|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: ===== Received metadata (for 1 requested topics): refresh unavailable topics =====
%7|1602442988.036|METADATA|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: ClusterId: P3Dm2isBTn-IXhcu_D5JSw, ControllerId: 1001
%7|1602442988.036|METADATA|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: 1 brokers, 1 topics
%7|1602442988.036|METADATA|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001:   Broker #0/1: 172.31.31.3:9092 NodeId 1001
%7|1602442988.036|METADATA|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001:   Topic #0/1: demooutput1602442758 with 1 partitions
%7|1602442988.036|STATE|rdkafka#producer-2| [thrd:main]: Topic demooutput1602442758 changed state unknown -> exists
%7|1602442988.036|PARTCNT|rdkafka#producer-2| [thrd:main]: Topic demooutput1602442758 partition count changed from 0 to 1
%7|1602442988.036|TOPPARNEW|rdkafka#producer-2| [thrd:main]: NEW demooutput1602442758 [0] 0x7f4e940050e0 (at rd_kafka_topic_partition_cnt_update:750)
%7|1602442988.036|METADATA|rdkafka#producer-2| [thrd:main]:   Topic demooutput1602442758 partition 0 Leader 1001
%7|1602442988.036|BRKDELGT|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0]: delegate to broker 172.31.31.3:9092/1001 (rktp 0x7f4e940050e0, term 0, ref 2)
%7|1602442988.036|BRKDELGT|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0]: delegating to broker 172.31.31.3:9092/1001 for partition with 0 messages (0 bytes) queued
%7|1602442988.036|BRKMIGR|rdkafka#producer-2| [thrd:main]: Migrating topic demooutput1602442758 [0] 0x7f4e940050e0 from (none) to 172.31.31.3:9092/1001 (sending PARTITION_JOIN to 172.31.31.3:9092/1001)
%7|1602442988.036|PARTCNT|rdkafka#producer-2| [thrd:main]: Partitioning 1 unassigned messages in topic demooutput1602442758 to 1 partitions
%7|1602442988.036|TOPBRK|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demooutput1602442758 [0]: joining broker (rktp 0x7f4e940050e0, 0 message(s) queued)
%7|1602442988.036|FETCHADD|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Added demooutput1602442758 [0] to active list (1 entries, opv 0, 0 messages queued): joining
%7|1602442988.036|DRAIN|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: demooutput1602442758 [0] beginning partition drain: wait for outstanding requests to finish before producing to new leader
%7|1602442988.036|BROADCAST|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: Broadcasting state change
%7|1602442988.036|UAS|rdkafka#producer-2| [thrd:main]: 1/1 messages were partitioned in topic demooutput1602442758
%7|1602442988.036|METADATA|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: 1/1 requested topic(s) seen in metadata
%7|1602442988.036|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] all in-flight requests drained from queue
%7|1602442988.037|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442988.037|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 5)
%7|1602442988.038|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 5, rtt 0.92ms)
%7|1602442988.038|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442988.038|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442988.038|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442988.038|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442988.038|NEWPID|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: demooutput1602442758 [0] changed PID{Invalid} -> PID{Id:0,Epoch:3} with base MsgId 1
%7|1602442988.038|RESETSEQ|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: demooutput1602442758 [0] resetting epoch base seq from 0 to 1
%7|1602442988.038|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 1, BaseSeq 0, PID{Id:0,Epoch:3}, uncompressed)
%7|1602442988.038|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 8)
%7|1602442988.038|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 8, rtt 0.63ms)
%7|1602442988.038|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 1, BaseSeq 0) delivered
%7|1602442988.038|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442988.038|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442988.039|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 6)
%7|1602442988.039|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 6, rtt 0.88ms)
%7|1602442988.039|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442988.039|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442988.039|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442988.039|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442988.039|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442988.047|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 159 bytes, CorrId 7, rtt 40.01ms)
%7|1602442988.047|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 71, error "Success", MaxOffset 62, LSO 62, Ver 2/2
%7|1602442988.047|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (3 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 61, 0 ctrl msgs, uncompressed)
%7|1602442988.047|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 62 (v2)
%7|1602442988.047|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442988.047|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 8)
=== Committing transaction with 1 messages at input offset 61 ===
:DEMO:START 1602442988.0477252
%7|1602442988.047|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442988.047|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442988.048|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 7)
%7|1602442988.048|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442988.048|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 8)
%7|1602442988.048|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 7, rtt 0.80ms)
%7|1602442988.048|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 9)
%7|1602442988.049|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 8, rtt 0.87ms)
%7|1602442988.049|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442988.049|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442988.049|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442988.049|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 9, rtt 0.76ms)
%7|1602442988.049|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
:DEMO:END   1602442988.0497015 0.0019762516021728516
%7|1602442988.049|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442988.049|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442988.049|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 1 outstanding message(s) prior to commit
%7|1602442988.053|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 159 bytes, CorrId 8, rtt 5.82ms)
%7|1602442988.053|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 71, error "Success", MaxOffset 63, LSO 63, Ver 2/2
%7|1602442988.053|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (3 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 62, 0 ctrl msgs, uncompressed)
%7|1602442988.053|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 63 (v2)
%7|1602442988.053|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442988.053|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 9)
%7|1602442988.053|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
%7|1602442988.053|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 2, BaseSeq 1, PID{Id:0,Epoch:3}, uncompressed)
%7|1602442988.053|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 10)
%7|1602442988.054|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 10, rtt 0.84ms)
%7|1602442988.054|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 2, BaseSeq 1) delivered
%7|1602442988.054|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442988.054|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442988.054|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 9)
%7|1602442988.055|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 9, rtt 0.69ms)
%7|1602442988.055|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442988.055|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442988.055|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442988.055|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442988.055|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
=== Committing transaction with 1 messages at input offset 62 ===
:DEMO:START 1602442988.0555224
%7|1602442988.055|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442988.055|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442988.055|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 10)
%7|1602442988.056|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 10, rtt 0.80ms)
%7|1602442988.056|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Retrying AddOffsetsToTxnRequest (v0, 78 bytes, retry 1/3, prev CorrId 10) in 100ms
%7|1602442988.056|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442988.056|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 11)
%7|1602442988.056|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 11, rtt 0.26ms)
%7|1602442988.056|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: AddPartitionsToTxn response: partition "demooutput1602442758": [0]: Broker: Producer attempted to update a transaction while another concurrent operation on the same transaction was ongoing
%7|1602442988.059|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 159 bytes, CorrId 9, rtt 5.72ms)
%7|1602442988.059|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 71, error "Success", MaxOffset 64, LSO 64, Ver 2/2
%7|1602442988.059|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (3 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 63, 0 ctrl msgs, uncompressed)
%7|1602442988.059|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 64 (v2)
%7|1602442988.059|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442988.059|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 10)
%7|1602442988.065|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 159 bytes, CorrId 10, rtt 5.97ms)
%7|1602442988.065|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 71, error "Success", MaxOffset 65, LSO 65, Ver 2/2
%7|1602442988.065|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (3 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 64, 0 ctrl msgs, uncompressed)
%7|1602442988.065|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 65 (v2)
%7|1602442988.065|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442988.065|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 11)
%7|1602442988.071|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 159 bytes, CorrId 11, rtt 6.23ms)
%7|1602442988.071|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 71, error "Success", MaxOffset 66, LSO 66, Ver 2/2
%7|1602442988.071|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (3 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 65, 0 ctrl msgs, uncompressed)
%7|1602442988.071|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 66 (v2)
%7|1602442988.071|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442988.071|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 12)
%7|1602442988.076|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442988.076|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 12)
%7|1602442988.077|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 12, rtt 0.66ms)
%7|1602442988.077|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442988.077|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442988.077|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442988.077|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442988.077|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 3, BaseSeq 2, PID{Id:0,Epoch:3}, uncompressed)
%7|1602442988.077|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 11)
%7|1602442988.077|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 159 bytes, CorrId 12, rtt 6.08ms)
%7|1602442988.077|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 71, error "Success", MaxOffset 67, LSO 67, Ver 2/2
%7|1602442988.077|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (3 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 66, 0 ctrl msgs, uncompressed)
%7|1602442988.077|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 67 (v2)
%7|1602442988.077|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442988.077|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 13)
%7|1602442988.078|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 11, rtt 0.62ms)
%7|1602442988.078|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 3, BaseSeq 2) delivered
%7|1602442988.083|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 159 bytes, CorrId 13, rtt 5.82ms)
%7|1602442988.083|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 71, error "Success", MaxOffset 68, LSO 68, Ver 2/2
%7|1602442988.083|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (3 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 67, 0 ctrl msgs, uncompressed)
%7|1602442988.083|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 68 (v2)
%7|1602442988.083|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442988.083|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 14)
%7|1602442988.089|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 159 bytes, CorrId 14, rtt 5.95ms)
%7|1602442988.089|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 71, error "Success", MaxOffset 69, LSO 69, Ver 2/2
%7|1602442988.089|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (3 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 68, 0 ctrl msgs, uncompressed)
%7|1602442988.089|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 69 (v2)
%7|1602442988.089|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442988.089|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 15)
%7|1602442988.095|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 159 bytes, CorrId 15, rtt 5.96ms)
%7|1602442988.095|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 71, error "Success", MaxOffset 70, LSO 70, Ver 2/2
%7|1602442988.095|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (3 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 69, 0 ctrl msgs, uncompressed)
%7|1602442988.095|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 70 (v2)
%7|1602442988.095|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442988.095|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 16)
%7|1602442988.101|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 160 bytes, CorrId 16, rtt 6.15ms)
%7|1602442988.101|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 72, error "Success", MaxOffset 71, LSO 71, Ver 2/2
%7|1602442988.101|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (4 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 70, 0 ctrl msgs, uncompressed)
%7|1602442988.101|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 71 (v2)
%7|1602442988.101|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442988.101|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 17)
%7|1602442988.107|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 160 bytes, CorrId 17, rtt 5.81ms)
%7|1602442988.107|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 72, error "Success", MaxOffset 72, LSO 72, Ver 2/2
%7|1602442988.107|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (4 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 71, 0 ctrl msgs, uncompressed)
%7|1602442988.107|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 72 (v2)
%7|1602442988.107|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442988.107|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 18)
%7|1602442988.113|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 160 bytes, CorrId 18, rtt 5.95ms)
%7|1602442988.113|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 72, error "Success", MaxOffset 73, LSO 73, Ver 2/2
%7|1602442988.113|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (4 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 72, 0 ctrl msgs, uncompressed)
%7|1602442988.113|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 73 (v2)
%7|1602442988.113|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442988.113|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 19)
%7|1602442988.120|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 160 bytes, CorrId 19, rtt 6.32ms)
%7|1602442988.120|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 72, error "Success", MaxOffset 74, LSO 74, Ver 2/2
%7|1602442988.120|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (4 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 73, 0 ctrl msgs, uncompressed)
%7|1602442988.120|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 74 (v2)
%7|1602442988.120|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442988.120|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 20)
%7|1602442988.125|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 160 bytes, CorrId 20, rtt 5.73ms)
%7|1602442988.125|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 72, error "Success", MaxOffset 75, LSO 75, Ver 2/2
%7|1602442988.125|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (4 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 74, 0 ctrl msgs, uncompressed)
%7|1602442988.125|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 75 (v2)
%7|1602442988.125|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442988.125|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 21)
%7|1602442988.132|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 160 bytes, CorrId 21, rtt 6.45ms)
%7|1602442988.132|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 72, error "Success", MaxOffset 76, LSO 76, Ver 2/2
%7|1602442988.132|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (4 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 75, 0 ctrl msgs, uncompressed)
%7|1602442988.132|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 76 (v2)
%7|1602442988.132|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442988.132|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 22)
%7|1602442988.138|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 160 bytes, CorrId 22, rtt 6.37ms)
%7|1602442988.138|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 72, error "Success", MaxOffset 77, LSO 77, Ver 2/2
%7|1602442988.138|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (4 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 76, 0 ctrl msgs, uncompressed)
%7|1602442988.138|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 77 (v2)
%7|1602442988.138|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442988.138|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 23)
%7|1602442988.145|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 160 bytes, CorrId 23, rtt 6.78ms)
%7|1602442988.145|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 72, error "Success", MaxOffset 78, LSO 78, Ver 2/2
%7|1602442988.145|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (4 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 77, 0 ctrl msgs, uncompressed)
%7|1602442988.145|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 78 (v2)
%7|1602442988.145|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442988.145|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 24)
%7|1602442988.151|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 160 bytes, CorrId 24, rtt 6.09ms)
%7|1602442988.151|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 72, error "Success", MaxOffset 79, LSO 79, Ver 2/2
%7|1602442988.151|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (4 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 78, 0 ctrl msgs, uncompressed)
%7|1602442988.151|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 79 (v2)
%7|1602442988.151|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442988.151|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 25)
%7|1602442988.156|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Moved 1 retry buffer(s) to output queue
%7|1602442988.156|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 13)
%7|1602442988.157|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 13, rtt 0.92ms)
%7|1602442988.157|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 12)
%7|1602442988.158|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 160 bytes, CorrId 25, rtt 6.71ms)
%7|1602442988.158|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 72, error "Success", MaxOffset 80, LSO 80, Ver 2/2
%7|1602442988.158|CONSUME|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Enqueue 1 message(s) (4 bytes, 1 ops) on demoinput1602442758 [0] fetch queue (qlen 1, v2, last_offset 79, 0 ctrl msgs, uncompressed)
%7|1602442988.158|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 80 (v2)
%7|1602442988.158|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442988.158|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 26)
%7|1602442988.159|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 12, rtt 1.43ms)
:DEMO:END   1602442988.1592789 0.10375642776489258
%7|1602442988.159|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442988.159|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442988.159|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 2 outstanding message(s) prior to commit
%7|1602442988.159|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442988.159|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442988.159|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 14)
%7|1602442988.160|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 14, rtt 0.63ms)
%7|1602442988.160|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442988.160|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442988.160|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442988.160|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442988.160|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
=== Committing transaction with 1 messages at input offset 63 ===
:DEMO:START 1602442988.1601617
%7|1602442988.160|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442988.160|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442988.160|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 15)
%7|1602442988.161|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 16)
%7|1602442988.161|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442988.161|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 15, rtt 1.09ms)
%7|1602442988.161|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Retrying AddOffsetsToTxnRequest (v0, 78 bytes, retry 1/3, prev CorrId 15) in 100ms
%7|1602442988.161|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 16, rtt 0.38ms)
%7|1602442988.161|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: AddPartitionsToTxn response: partition "demooutput1602442758": [0]: Broker: Producer attempted to update a transaction while another concurrent operation on the same transaction was ongoing
%7|1602442988.181|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442988.181|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 17)
%7|1602442988.183|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 17, rtt 1.44ms)
%7|1602442988.183|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442988.183|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442988.183|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442988.183|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442988.183|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 4, BaseSeq 3, PID{Id:0,Epoch:3}, uncompressed)
%7|1602442988.183|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 13)
%7|1602442988.184|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 13, rtt 1.00ms)
%7|1602442988.184|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 4, BaseSeq 3) delivered
%7|1602442988.262|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Moved 1 retry buffer(s) to output queue
%7|1602442988.262|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 18)
%7|1602442988.263|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 18, rtt 1.05ms)
%7|1602442988.263|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 14)
%7|1602442988.264|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 14, rtt 1.24ms)
:DEMO:END   1602442988.2647698 0.10460805892944336
%7|1602442988.264|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442988.264|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442988.264|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 2 outstanding message(s) prior to commit
%7|1602442988.264|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442988.264|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442988.264|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 19)
%7|1602442988.265|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 19, rtt 0.67ms)
%7|1602442988.265|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442988.265|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442988.265|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442988.265|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442988.265|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
=== Committing transaction with 1 messages at input offset 64 ===
:DEMO:START 1602442988.2657108
%7|1602442988.265|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442988.265|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442988.265|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 20)
%7|1602442988.266|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 20, rtt 0.30ms)
%7|1602442988.266|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Retrying AddOffsetsToTxnRequest (v0, 78 bytes, retry 1/3, prev CorrId 20) in 100ms
%7|1602442988.266|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442988.266|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 21)
%7|1602442988.267|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 21, rtt 1.00ms)
%7|1602442988.267|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: AddPartitionsToTxn response: partition "demooutput1602442758": [0]: Broker: Producer attempted to update a transaction while another concurrent operation on the same transaction was ongoing
%7|1602442988.287|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442988.287|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 22)
%7|1602442988.288|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 22, rtt 0.94ms)
%7|1602442988.288|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442988.288|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442988.288|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442988.288|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 5, BaseSeq 4, PID{Id:0,Epoch:3}, uncompressed)
%7|1602442988.288|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442988.288|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 15)
%7|1602442988.289|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 15, rtt 0.73ms)
%7|1602442988.289|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 5, BaseSeq 4) delivered
%7|1602442988.366|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Moved 1 retry buffer(s) to output queue
%7|1602442988.367|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 23)
%7|1602442988.368|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 23, rtt 1.12ms)
%7|1602442988.368|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 16)
%7|1602442988.369|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 16, rtt 1.14ms)
:DEMO:END   1602442988.3694053 0.10369443893432617
%7|1602442988.369|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442988.369|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442988.369|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 2 outstanding message(s) prior to commit
%7|1602442988.369|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442988.369|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442988.369|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 24)
%7|1602442988.370|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 24, rtt 0.63ms)
%7|1602442988.370|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442988.370|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442988.370|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442988.370|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442988.370|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
=== Committing transaction with 1 messages at input offset 65 ===
:DEMO:START 1602442988.3702943
%7|1602442988.370|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442988.370|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442988.370|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 25)
%7|1602442988.370|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 25, rtt 0.19ms)
%7|1602442988.370|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Retrying AddOffsetsToTxnRequest (v0, 78 bytes, retry 1/3, prev CorrId 25) in 100ms
%7|1602442988.371|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442988.371|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 26)
%7|1602442988.371|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 26, rtt 0.32ms)
%7|1602442988.371|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: AddPartitionsToTxn response: partition "demooutput1602442758": [0]: Broker: Producer attempted to update a transaction while another concurrent operation on the same transaction was ongoing
%7|1602442988.391|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442988.391|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 27)
%7|1602442988.392|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 27, rtt 1.00ms)
%7|1602442988.392|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442988.392|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442988.392|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442988.392|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442988.392|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 6, BaseSeq 5, PID{Id:0,Epoch:3}, uncompressed)
%7|1602442988.392|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 17)
%7|1602442988.393|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 17, rtt 0.53ms)
%7|1602442988.393|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 6, BaseSeq 5) delivered
%7|1602442988.470|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Moved 1 retry buffer(s) to output queue
%7|1602442988.470|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 28)
%7|1602442988.472|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 28, rtt 1.05ms)
%7|1602442988.472|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 18)
%7|1602442988.473|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 18, rtt 1.25ms)
:DEMO:END   1602442988.4734015 0.10310721397399902
%7|1602442988.473|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442988.473|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442988.473|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 2 outstanding message(s) prior to commit
%7|1602442988.473|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442988.473|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442988.473|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 29)
%7|1602442988.474|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 29, rtt 0.65ms)
%7|1602442988.474|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442988.474|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442988.474|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442988.474|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442988.474|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
=== Committing transaction with 1 messages at input offset 66 ===
:DEMO:START 1602442988.474257
%7|1602442988.474|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442988.474|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442988.474|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 30)
%7|1602442988.474|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 30, rtt 0.18ms)
%7|1602442988.474|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Retrying AddOffsetsToTxnRequest (v0, 78 bytes, retry 1/3, prev CorrId 30) in 100ms
%7|1602442988.475|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442988.475|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 31)
%7|1602442988.475|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 31, rtt 0.44ms)
%7|1602442988.475|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: AddPartitionsToTxn response: partition "demooutput1602442758": [0]: Broker: Producer attempted to update a transaction while another concurrent operation on the same transaction was ongoing
%7|1602442988.495|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442988.495|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 32)
%7|1602442988.496|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 32, rtt 1.00ms)
%7|1602442988.496|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442988.496|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442988.496|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442988.496|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442988.496|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 7, BaseSeq 6, PID{Id:0,Epoch:3}, uncompressed)
%7|1602442988.496|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 19)
%7|1602442988.497|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 19, rtt 0.82ms)
%7|1602442988.497|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 7, BaseSeq 6) delivered
%7|1602442988.574|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Moved 1 retry buffer(s) to output queue
%7|1602442988.575|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 33)
%7|1602442988.576|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 33, rtt 1.03ms)
%7|1602442988.576|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 20)
%7|1602442988.576|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 20, rtt 0.75ms)
:DEMO:END   1602442988.5769029 0.1026458740234375
%7|1602442988.576|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442988.576|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442988.576|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 2 outstanding message(s) prior to commit
%7|1602442988.576|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442988.576|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442988.576|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 34)
%7|1602442988.577|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 34, rtt 0.54ms)
%7|1602442988.577|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442988.577|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442988.577|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442988.577|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442988.577|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
=== Committing transaction with 1 messages at input offset 67 ===
:DEMO:START 1602442988.5776865
%7|1602442988.577|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442988.577|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442988.577|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 35)
%7|1602442988.578|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 35, rtt 0.47ms)
%7|1602442988.578|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Retrying AddOffsetsToTxnRequest (v0, 78 bytes, retry 1/3, prev CorrId 35) in 100ms
%7|1602442988.578|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 36)
%7|1602442988.578|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442988.579|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 36, rtt 0.38ms)
%7|1602442988.579|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: AddPartitionsToTxn response: partition "demooutput1602442758": [0]: Broker: Producer attempted to update a transaction while another concurrent operation on the same transaction was ongoing
%7|1602442988.599|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442988.599|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 37)
%7|1602442988.600|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 37, rtt 0.87ms)
%7|1602442988.600|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442988.600|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442988.600|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442988.600|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442988.600|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 8, BaseSeq 7, PID{Id:0,Epoch:3}, uncompressed)
%7|1602442988.600|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 21)
%7|1602442988.601|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 21, rtt 0.82ms)
%7|1602442988.601|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 8, BaseSeq 7) delivered
%7|1602442988.659|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 88 bytes, CorrId 26, rtt 500.50ms)
%7|1602442988.659|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 0, error "Success", MaxOffset 80, LSO 80, Ver 2/2
%7|1602442988.659|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 80 (v2)
%7|1602442988.659|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442988.659|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 27)
%7|1602442988.679|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Moved 1 retry buffer(s) to output queue
%7|1602442988.679|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 38)
%7|1602442988.680|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 38, rtt 1.09ms)
%7|1602442988.680|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 22)
%7|1602442988.681|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 22, rtt 1.04ms)
:DEMO:END   1602442988.681517 0.10383033752441406
%7|1602442988.681|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442988.681|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442988.681|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 2 outstanding message(s) prior to commit
%7|1602442988.681|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442988.681|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442988.681|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 39)
%7|1602442988.682|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 39, rtt 0.71ms)
%7|1602442988.682|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442988.682|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442988.682|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442988.682|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442988.682|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
=== Committing transaction with 1 messages at input offset 68 ===
:DEMO:START 1602442988.682439
%7|1602442988.682|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442988.682|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442988.682|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 40)
%7|1602442988.683|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 40, rtt 0.47ms)
%7|1602442988.683|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Retrying AddOffsetsToTxnRequest (v0, 78 bytes, retry 1/3, prev CorrId 40) in 100ms
%7|1602442988.683|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442988.683|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 41)
%7|1602442988.683|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 41, rtt 0.25ms)
%7|1602442988.683|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: AddPartitionsToTxn response: partition "demooutput1602442758": [0]: Broker: Producer attempted to update a transaction while another concurrent operation on the same transaction was ongoing
%7|1602442988.703|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442988.703|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 42)
%7|1602442988.704|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 42, rtt 1.03ms)
%7|1602442988.704|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442988.704|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442988.704|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442988.704|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442988.704|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 9, BaseSeq 8, PID{Id:0,Epoch:3}, uncompressed)
%7|1602442988.704|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 23)
%7|1602442988.705|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 23, rtt 0.90ms)
%7|1602442988.705|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 9, BaseSeq 8) delivered
%7|1602442988.784|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Moved 1 retry buffer(s) to output queue
%7|1602442988.784|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 43)
%7|1602442988.785|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 43, rtt 1.40ms)
%7|1602442988.785|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 24)
%7|1602442988.786|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 24, rtt 1.35ms)
:DEMO:END   1602442988.7870085 0.1045694351196289
%7|1602442988.787|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442988.787|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442988.787|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 2 outstanding message(s) prior to commit
%7|1602442988.787|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442988.787|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442988.787|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 44)
%7|1602442988.787|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 44, rtt 0.67ms)
%7|1602442988.787|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442988.787|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442988.787|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442988.787|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442988.787|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
=== Committing transaction with 1 messages at input offset 69 ===
:DEMO:START 1602442988.7879326
%7|1602442988.787|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442988.787|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442988.788|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 45)
%7|1602442988.788|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442988.788|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 46)
%7|1602442988.789|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 45, rtt 1.18ms)
%7|1602442988.789|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Retrying AddOffsetsToTxnRequest (v0, 78 bytes, retry 1/3, prev CorrId 45) in 100ms
%7|1602442988.789|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 46, rtt 0.52ms)
%7|1602442988.789|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: AddPartitionsToTxn response: partition "demooutput1602442758": [0]: Broker: Producer attempted to update a transaction while another concurrent operation on the same transaction was ongoing
%7|1602442988.809|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442988.809|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 47)
%7|1602442988.810|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 47, rtt 0.95ms)
%7|1602442988.810|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442988.810|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442988.810|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 10, BaseSeq 9, PID{Id:0,Epoch:3}, uncompressed)
%7|1602442988.810|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 25)
%7|1602442988.810|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442988.810|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442988.811|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 25, rtt 0.69ms)
%7|1602442988.811|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 10, BaseSeq 9) delivered
%7|1602442988.889|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Moved 1 retry buffer(s) to output queue
%7|1602442988.889|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 48)
%7|1602442988.890|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 48, rtt 1.17ms)
%7|1602442988.891|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 26)
%7|1602442988.892|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 26, rtt 1.04ms)
:DEMO:END   1602442988.8920918 0.10415911674499512
%7|1602442988.892|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442988.892|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442988.892|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 2 outstanding message(s) prior to commit
%7|1602442988.892|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442988.892|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442988.892|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 49)
%7|1602442988.892|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 49, rtt 0.54ms)
%7|1602442988.892|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442988.892|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442988.892|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442988.892|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442988.892|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
=== Committing transaction with 1 messages at input offset 70 ===
:DEMO:START 1602442988.8928254
%7|1602442988.892|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442988.892|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442988.892|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 50)
%7|1602442988.893|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 50, rtt 0.23ms)
%7|1602442988.893|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Retrying AddOffsetsToTxnRequest (v0, 78 bytes, retry 1/3, prev CorrId 50) in 100ms
%7|1602442988.893|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442988.893|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 51)
%7|1602442988.894|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 51, rtt 0.26ms)
%7|1602442988.894|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: AddPartitionsToTxn response: partition "demooutput1602442758": [0]: Broker: Producer attempted to update a transaction while another concurrent operation on the same transaction was ongoing
%7|1602442988.914|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442988.914|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 52)
%7|1602442988.915|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 52, rtt 1.01ms)
%7|1602442988.915|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442988.915|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442988.915|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442988.915|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442988.915|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 11, BaseSeq 10, PID{Id:0,Epoch:3}, uncompressed)
%7|1602442988.915|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 27)
%7|1602442988.916|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 27, rtt 0.88ms)
%7|1602442988.916|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 11, BaseSeq 10) delivered
%7|1602442988.993|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Moved 1 retry buffer(s) to output queue
%7|1602442988.993|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 53)
%7|1602442988.994|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 53, rtt 0.97ms)
%7|1602442988.994|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 28)
%7|1602442988.995|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 28, rtt 0.73ms)
:DEMO:END   1602442988.9952788 0.10245347023010254
%7|1602442988.995|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442988.995|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442988.995|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 2 outstanding message(s) prior to commit
%7|1602442988.995|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442988.995|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442988.995|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 54)
%7|1602442988.995|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 54, rtt 0.47ms)
%7|1602442988.995|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442988.995|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442988.995|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442988.995|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442988.995|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
=== Committing transaction with 1 messages at input offset 71 ===
:DEMO:START 1602442988.995921
%7|1602442988.995|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442988.995|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442988.995|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 55)
%7|1602442988.996|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 55, rtt 0.35ms)
%7|1602442988.996|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Retrying AddOffsetsToTxnRequest (v0, 78 bytes, retry 1/3, prev CorrId 55) in 100ms
%7|1602442988.996|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442988.996|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 56)
%7|1602442988.997|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 56, rtt 0.18ms)
%7|1602442988.997|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: AddPartitionsToTxn response: partition "demooutput1602442758": [0]: Broker: Producer attempted to update a transaction while another concurrent operation on the same transaction was ongoing
%7|1602442989.017|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442989.017|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 57)
%7|1602442989.018|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 57, rtt 0.94ms)
%7|1602442989.018|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442989.018|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442989.018|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442989.018|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442989.018|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 12, BaseSeq 11, PID{Id:0,Epoch:3}, uncompressed)
%7|1602442989.018|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 29)
%7|1602442989.018|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 29, rtt 0.57ms)
%7|1602442989.018|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 12, BaseSeq 11) delivered
%7|1602442989.097|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Moved 1 retry buffer(s) to output queue
%7|1602442989.097|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 58)
%7|1602442989.098|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 58, rtt 1.04ms)
%7|1602442989.098|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 30)
%7|1602442989.099|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 30, rtt 0.77ms)
:DEMO:END   1602442989.0993989 0.10347795486450195
%7|1602442989.099|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442989.099|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442989.099|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 2 outstanding message(s) prior to commit
%7|1602442989.099|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442989.099|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442989.099|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 59)
%7|1602442989.100|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 59, rtt 1.01ms)
%7|1602442989.100|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442989.100|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442989.101|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442989.101|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442989.101|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
=== Committing transaction with 1 messages at input offset 72 ===
:DEMO:START 1602442989.1011963
%7|1602442989.101|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442989.101|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442989.101|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 60)
%7|1602442989.101|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 60, rtt 0.16ms)
%7|1602442989.101|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Retrying AddOffsetsToTxnRequest (v0, 78 bytes, retry 1/3, prev CorrId 60) in 100ms
%7|1602442989.102|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 61)
%7|1602442989.102|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442989.103|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 61, rtt 1.08ms)
%7|1602442989.103|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442989.103|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442989.103|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442989.103|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442989.106|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (0 added from partition queue)
%7|1602442989.106|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 13, BaseSeq 12, PID{Id:0,Epoch:3}, uncompressed)
%7|1602442989.106|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 31)
%7|1602442989.106|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 31, rtt 0.46ms)
%7|1602442989.106|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 13, BaseSeq 12) delivered
%7|1602442989.160|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 88 bytes, CorrId 27, rtt 501.39ms)
%7|1602442989.160|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 0, error "Success", MaxOffset 80, LSO 80, Ver 2/2
%7|1602442989.160|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 80 (v2)
%7|1602442989.160|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442989.160|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 28)
%7|1602442989.202|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Moved 1 retry buffer(s) to output queue
%7|1602442989.202|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 62)
%7|1602442989.203|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 62, rtt 1.12ms)
%7|1602442989.203|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 32)
%7|1602442989.204|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 32, rtt 1.15ms)
:DEMO:END   1602442989.2048366 0.10364031791687012
%7|1602442989.204|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442989.204|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442989.204|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 2 outstanding message(s) prior to commit
%7|1602442989.204|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442989.204|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442989.204|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 63)
%7|1602442989.205|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 63, rtt 0.60ms)
%7|1602442989.205|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442989.205|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442989.205|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442989.205|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442989.205|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
=== Committing transaction with 1 messages at input offset 73 ===
:DEMO:START 1602442989.2056284
%7|1602442989.205|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442989.205|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442989.206|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 64)
%7|1602442989.206|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 64, rtt 0.24ms)
%7|1602442989.206|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Retrying AddOffsetsToTxnRequest (v0, 78 bytes, retry 1/3, prev CorrId 64) in 100ms
%7|1602442989.206|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442989.206|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 65)
%7|1602442989.206|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 65, rtt 0.23ms)
%7|1602442989.206|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: AddPartitionsToTxn response: partition "demooutput1602442758": [0]: Broker: Producer attempted to update a transaction while another concurrent operation on the same transaction was ongoing
%7|1602442989.226|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442989.226|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 66)
%7|1602442989.227|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 66, rtt 0.79ms)
%7|1602442989.227|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442989.227|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442989.227|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442989.227|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442989.227|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 14, BaseSeq 13, PID{Id:0,Epoch:3}, uncompressed)
%7|1602442989.227|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 33)
%7|1602442989.228|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 33, rtt 0.64ms)
%7|1602442989.228|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 14, BaseSeq 13) delivered
%7|1602442989.306|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Moved 1 retry buffer(s) to output queue
%7|1602442989.306|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 67)
%7|1602442989.308|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 67, rtt 1.08ms)
%7|1602442989.308|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 34)
%7|1602442989.309|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 34, rtt 1.01ms)
:DEMO:END   1602442989.309227 0.10359859466552734
%7|1602442989.309|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442989.309|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442989.309|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 2 outstanding message(s) prior to commit
%7|1602442989.309|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442989.309|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442989.309|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 68)
%7|1602442989.309|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 68, rtt 0.48ms)
%7|1602442989.309|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442989.309|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442989.309|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442989.309|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442989.309|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
=== Committing transaction with 1 messages at input offset 74 ===
:DEMO:START 1602442989.3099203
%7|1602442989.309|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442989.309|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442989.310|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 69)
%7|1602442989.310|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 69, rtt 0.43ms)
%7|1602442989.310|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Retrying AddOffsetsToTxnRequest (v0, 78 bytes, retry 1/3, prev CorrId 69) in 100ms
%7|1602442989.310|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442989.310|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 70)
%7|1602442989.311|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 70, rtt 0.24ms)
%7|1602442989.311|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: AddPartitionsToTxn response: partition "demooutput1602442758": [0]: Broker: Producer attempted to update a transaction while another concurrent operation on the same transaction was ongoing
%7|1602442989.331|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 71)
%7|1602442989.331|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442989.332|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 71, rtt 0.80ms)
%7|1602442989.332|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442989.332|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442989.332|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442989.332|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442989.332|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 15, BaseSeq 14, PID{Id:0,Epoch:3}, uncompressed)
%7|1602442989.332|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 35)
%7|1602442989.333|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 35, rtt 0.90ms)
%7|1602442989.333|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 15, BaseSeq 14) delivered
%7|1602442989.411|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Moved 1 retry buffer(s) to output queue
%7|1602442989.411|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 72)
%7|1602442989.412|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 72, rtt 1.02ms)
%7|1602442989.412|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 36)
%7|1602442989.413|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 36, rtt 1.19ms)
:DEMO:END   1602442989.413721 0.10380077362060547
%7|1602442989.413|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442989.413|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442989.413|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 2 outstanding message(s) prior to commit
%7|1602442989.413|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442989.413|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442989.413|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 73)
%7|1602442989.414|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 73, rtt 0.57ms)
%7|1602442989.414|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442989.414|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442989.414|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442989.414|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442989.414|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
=== Committing transaction with 1 messages at input offset 75 ===
:DEMO:START 1602442989.4145362
%7|1602442989.414|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442989.414|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442989.414|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 74)
%7|1602442989.414|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 74, rtt 0.35ms)
%7|1602442989.415|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Retrying AddOffsetsToTxnRequest (v0, 78 bytes, retry 1/3, prev CorrId 74) in 100ms
%7|1602442989.415|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442989.415|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 75)
%7|1602442989.415|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 75, rtt 0.37ms)
%7|1602442989.415|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: AddPartitionsToTxn response: partition "demooutput1602442758": [0]: Broker: Producer attempted to update a transaction while another concurrent operation on the same transaction was ongoing
%7|1602442989.435|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442989.436|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 76)
%7|1602442989.437|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 76, rtt 0.82ms)
%7|1602442989.437|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442989.437|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442989.437|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442989.437|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442989.437|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 16, BaseSeq 15, PID{Id:0,Epoch:3}, uncompressed)
%7|1602442989.437|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 37)
%7|1602442989.437|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 37, rtt 0.72ms)
%7|1602442989.437|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 16, BaseSeq 15) delivered
%7|1602442989.515|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Moved 1 retry buffer(s) to output queue
%7|1602442989.515|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 77)
%7|1602442989.516|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 77, rtt 0.81ms)
%7|1602442989.516|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 38)
%7|1602442989.516|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 38, rtt 0.75ms)
:DEMO:END   1602442989.516924 0.10238766670227051
%7|1602442989.516|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442989.516|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442989.516|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 2 outstanding message(s) prior to commit
%7|1602442989.516|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442989.517|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442989.517|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 78)
%7|1602442989.517|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 78, rtt 0.56ms)
%7|1602442989.517|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442989.517|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442989.517|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442989.517|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442989.517|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
=== Committing transaction with 1 messages at input offset 76 ===
:DEMO:START 1602442989.5177479
%7|1602442989.517|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442989.517|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442989.517|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 79)
%7|1602442989.518|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 79, rtt 0.31ms)
%7|1602442989.518|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Retrying AddOffsetsToTxnRequest (v0, 78 bytes, retry 1/3, prev CorrId 79) in 100ms
%7|1602442989.518|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442989.518|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 80)
%7|1602442989.519|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 80, rtt 0.43ms)
%7|1602442989.519|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: AddPartitionsToTxn response: partition "demooutput1602442758": [0]: Broker: Producer attempted to update a transaction while another concurrent operation on the same transaction was ongoing
%7|1602442989.539|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442989.539|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 81)
%7|1602442989.540|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 81, rtt 0.77ms)
%7|1602442989.540|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442989.540|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442989.540|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442989.540|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442989.540|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 17, BaseSeq 16, PID{Id:0,Epoch:3}, uncompressed)
%7|1602442989.540|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 39)
%7|1602442989.540|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 39, rtt 0.42ms)
%7|1602442989.540|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 17, BaseSeq 16) delivered
%7|1602442989.619|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Moved 1 retry buffer(s) to output queue
%7|1602442989.619|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 82)
%7|1602442989.620|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 82, rtt 1.03ms)
%7|1602442989.620|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 40)
%7|1602442989.621|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 40, rtt 0.66ms)
:DEMO:END   1602442989.6211057 0.10335779190063477
%7|1602442989.621|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442989.621|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442989.621|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 2 outstanding message(s) prior to commit
%7|1602442989.621|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442989.621|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442989.621|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 83)
%7|1602442989.621|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 83, rtt 0.60ms)
%7|1602442989.621|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442989.621|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442989.622|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442989.622|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442989.622|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
=== Committing transaction with 1 messages at input offset 77 ===
:DEMO:START 1602442989.6223922
%7|1602442989.622|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442989.622|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442989.622|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 84)
%7|1602442989.623|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442989.623|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 85)
%7|1602442989.623|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 84, rtt 0.98ms)
%7|1602442989.623|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Retrying AddOffsetsToTxnRequest (v0, 78 bytes, retry 1/3, prev CorrId 84) in 100ms
%7|1602442989.623|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 85, rtt 0.48ms)
%7|1602442989.623|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: AddPartitionsToTxn response: partition "demooutput1602442758": [0]: Broker: Producer attempted to update a transaction while another concurrent operation on the same transaction was ongoing
%7|1602442989.643|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442989.643|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 86)
%7|1602442989.644|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 86, rtt 0.87ms)
%7|1602442989.644|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442989.644|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442989.644|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442989.644|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442989.644|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 18, BaseSeq 17, PID{Id:0,Epoch:3}, uncompressed)
%7|1602442989.644|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 41)
%7|1602442989.645|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 41, rtt 0.65ms)
%7|1602442989.645|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 18, BaseSeq 17) delivered
%7|1602442989.660|RECV|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received FetchResponse (v11, 88 bytes, CorrId 28, rtt 500.17ms)
%7|1602442989.660|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Topic demoinput1602442758 [0] MessageSet size 0, error "Success", MaxOffset 80, LSO 80, Ver 2/2
%7|1602442989.660|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch topic demoinput1602442758 [0] at offset 80 (v2)
%7|1602442989.660|FETCH|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Fetch 1/1/1 toppar(s)
%7|1602442989.660|SEND|rdkafka#consumer-1| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent FetchRequest (v11, 116 bytes @ 0, CorrId 29)
%7|1602442989.724|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Moved 1 retry buffer(s) to output queue
%7|1602442989.724|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 87)
%7|1602442989.724|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 87, rtt 0.85ms)
%7|1602442989.724|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 42)
%7|1602442989.725|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 42, rtt 0.76ms)
:DEMO:END   1602442989.7258046 0.10341238975524902
%7|1602442989.725|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442989.725|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442989.725|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 2 outstanding message(s) prior to commit
%7|1602442989.725|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442989.725|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442989.725|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 88)
%7|1602442989.726|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 88, rtt 0.52ms)
%7|1602442989.726|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442989.726|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442989.726|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442989.726|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442989.726|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
=== Committing transaction with 1 messages at input offset 78 ===
:DEMO:START 1602442989.7265654
%7|1602442989.726|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442989.726|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442989.726|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 89)
%7|1602442989.727|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 89, rtt 0.47ms)
%7|1602442989.727|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Retrying AddOffsetsToTxnRequest (v0, 78 bytes, retry 1/3, prev CorrId 89) in 100ms
%7|1602442989.727|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442989.727|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 90)
%7|1602442989.727|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 90, rtt 0.27ms)
%7|1602442989.727|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: AddPartitionsToTxn response: partition "demooutput1602442758": [0]: Broker: Producer attempted to update a transaction while another concurrent operation on the same transaction was ongoing
%7|1602442989.747|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442989.747|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 91)
%7|1602442989.748|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 91, rtt 0.79ms)
%7|1602442989.748|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442989.748|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442989.748|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442989.748|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442989.748|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 19, BaseSeq 18, PID{Id:0,Epoch:3}, uncompressed)
%7|1602442989.748|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 43)
%7|1602442989.749|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 43, rtt 0.62ms)
%7|1602442989.749|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 19, BaseSeq 18) delivered
%7|1602442989.827|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Moved 1 retry buffer(s) to output queue
%7|1602442989.827|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 92)
%7|1602442989.828|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 92, rtt 0.82ms)
%7|1602442989.828|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 44)
%7|1602442989.829|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 44, rtt 0.74ms)
:DEMO:END   1602442989.8296347 0.10306930541992188
%7|1602442989.829|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442989.829|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442989.829|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 2 outstanding message(s) prior to commit
%7|1602442989.829|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442989.829|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442989.829|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 93)
%7|1602442989.830|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 93, rtt 0.51ms)
%7|1602442989.830|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442989.830|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442989.830|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442989.830|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442989.830|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
=== Committing transaction with 1 messages at input offset 79 ===
:DEMO:START 1602442989.8303993
%7|1602442989.830|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
%7|1602442989.830|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: send_offsets_to_transaction
%7|1602442989.830|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 94)
%7|1602442989.831|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442989.831|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 95)
%7|1602442989.831|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 94, rtt 1.13ms)
%7|1602442989.831|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Retrying AddOffsetsToTxnRequest (v0, 78 bytes, retry 1/3, prev CorrId 94) in 100ms
%7|1602442989.831|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 95, rtt 0.46ms)
%7|1602442989.831|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: AddPartitionsToTxn response: partition "demooutput1602442758": [0]: Broker: Producer attempted to update a transaction while another concurrent operation on the same transaction was ongoing
%7|1602442989.851|ADDPARTS|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Adding partitions to transaction
%7|1602442989.851|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddPartitionsToTxnRequest (v0, 92 bytes @ 0, CorrId 96)
%7|1602442989.852|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddPartitionsToTxnResponse (v0, 46 bytes, CorrId 96, rtt 0.53ms)
%7|1602442989.852|ADDPARTS|rdkafka#producer-2| [thrd:main]: demooutput1602442758 [0] registered with transaction
%7|1602442989.852|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442989.852|TOPPAR|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0] 1 message(s) in xmit queue (1 added from partition queue)
%7|1602442989.852|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
%7|1602442989.852|PRODUCE|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: Produce MessageSet with 1 message(s) (76 bytes, ApiVersion 7, MsgVersion 2, MsgId 20, BaseSeq 19, PID{Id:0,Epoch:3}, uncompressed)
%7|1602442989.852|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent ProduceRequest (v7, 168 bytes @ 0, CorrId 45)
%7|1602442989.853|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received ProduceResponse (v7, 70 bytes, CorrId 45, rtt 0.63ms)
%7|1602442989.853|MSGSET|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: demooutput1602442758 [0]: MessageSet with 1 message(s) (MsgId 20, BaseSeq 19) delivered
%7|1602442989.932|RETRY|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Moved 1 retry buffer(s) to output queue
%7|1602442989.932|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent AddOffsetsToTxnRequest (v0, 78 bytes @ 0, CorrId 97)
%7|1602442989.933|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received AddOffsetsToTxnResponse (v0, 6 bytes, CorrId 97, rtt 0.96ms)
%7|1602442989.933|SEND|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Sent TxnOffsetCommitRequest (v0, 128 bytes @ 0, CorrId 46)
%7|1602442989.934|RECV|rdkafka#producer-2| [thrd:172.31.31.3:9092/bootstrap]: 172.31.31.3:9092/1001: Received TxnOffsetCommitResponse (v0, 46 bytes, CorrId 46, rtt 0.76ms)
:DEMO:END   1602442989.9345217 0.10412240028381348
%7|1602442989.934|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction (begin)
%7|1602442989.934|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change InTransaction -> BeginCommit
%7|1602442989.934|TXNCOMMIT|rdkafka#producer-2| [thrd:app]: Flushing 2 outstanding message(s) prior to commit
%7|1602442989.934|TXNAPI|rdkafka#producer-2| [thrd:app]: Transactional API called: commit_transaction
%7|1602442989.934|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change BeginCommit -> CommittingTransaction
%7|1602442989.934|SEND|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Sent EndTxnRequest (v1, 53 bytes @ 0, CorrId 98)
%7|1602442989.935|RECV|rdkafka#producer-2| [thrd:TxnCoordinator]: TxnCoordinator/1001: Received EndTxnResponse (v1, 6 bytes, CorrId 98, rtt 0.89ms)
%7|1602442989.935|TXNCOMPLETE|rdkafka#producer-2| [thrd:main]: Transaction successfully committed
%7|1602442989.935|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change CommittingTransaction -> Ready
%7|1602442989.935|TXNSTATE|rdkafka#producer-2| [thrd:main]: Transaction state change Ready -> InTransaction
%7|1602442989.935|WAKEUP|rdkafka#producer-2| [thrd:main]: 172.31.31.3:9092/1001: Wake-up
%7|1602442989.935|WAKEUP|rdkafka#producer-2| [thrd:main]: TxnCoordinator/1001: Wake-up
=== Reached the end of demoinput1602442758 [0] at 80====
%7|1602442989.935|CGRPOP|rdkafka#consumer-1| [thrd:main]: Group "kafka-tr-issue-201011-tr" received op GET_ASSIGNMENT (v0) in state up (join state started, v5 vs 0)
=== Reached end of input ===


Process finished with exit code 0
