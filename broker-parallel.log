PARALLEL log (producer went into retry-backoff)

[2020-10-15 10:55:44,568] DEBUG Accepted connection from /172.31.31.254:46098 on /172.31.31.3:9092 and assigned it to processor 1, sendBufferSize [actual|requested]: [102400|102400] recvBufferSize [actual|requested]: [102400|102400] (kafka.network.Acceptor)
[2020-10-15 10:55:44,568] DEBUG Processor 1 listening to new connection from /172.31.31.254:46098 (kafka.network.Processor)
[2020-10-15 10:55:44,568] DEBUG Accepted connection from /172.31.31.254:46096 on /172.31.31.3:9092 and assigned it to processor 2, sendBufferSize [actual|requested]: [102400|102400] recvBufferSize [actual|requested]: [102400|102400] (kafka.network.Acceptor)
[2020-10-15 10:55:44,568] DEBUG Processor 2 listening to new connection from /172.31.31.254:46096 (kafka.network.Processor)
[2020-10-15 10:55:44,568] DEBUG Completed request:RequestHeader(apiKey=API_VERSIONS, apiVersion=3, clientId=rdkafka, correlationId=1) -- {client_software_name=confluent-kafka-python,client_software_version=1.5.0-rdkafka-1.5.0,_tagged_fields={}},response:{error_code=0,api_keys=[{api_key=0,min_version=0,max_version=8,_tagged_fields={}},{api_key=1,min_version=0,max_version=11,_tagged_fields={}},{api_key=2,min_version=0,max_version=5,_tagged_fields={}},{api_key=3,min_version=0,max_version=9,_tagged_fields={}},{api_key=4,min_version=0,max_version=4,_tagged_fields={}},{api_key=5,min_version=0,max_version=2,_tagged_fields={}},{api_key=6,min_version=0,max_version=6,_tagged_fields={}},{api_key=7,min_version=0,max_version=3,_tagged_fields={}},{api_key=8,min_version=0,max_version=8,_tagged_fields={}},{api_key=9,min_version=0,max_version=7,_tagged_fields={}},{api_key=10,min_version=0,max_version=3,_tagged_fields={}},{api_key=11,min_version=0,max_version=7,_tagged_fields={}},{api_key=12,min_version=0,max_version=4,_tagged_fields={}},{api_key=13,min_version=0,max_version=4,_tagged_fields={}},{api_key=14,min_version=0,max_version=5,_tagged_fields={}},{api_key=15,min_version=0,max_version=5,_tagged_fields={}},{api_key=16,min_version=0,max_version=3,_tagged_fields={}},{api_key=17,min_version=0,max_version=1,_tagged_fields={}},{api_key=18,min_version=0,max_version=3,_tagged_fields={}},{api_key=19,min_version=0,max_version=5,_tagged_fields={}},{api_key=20,min_version=0,max_version=4,_tagged_fields={}},{api_key=21,min_version=0,max_version=1,_tagged_fields={}},{api_key=22,min_version=0,max_version=3,_tagged_fields={}},{api_key=23,min_version=0,max_version=3,_tagged_fields={}},{api_key=24,min_version=0,max_version=1,_tagged_fields={}},{api_key=25,min_version=0,max_version=1,_tagged_fields={}},{api_key=26,min_version=0,max_version=1,_tagged_fields={}},{api_key=27,min_version=0,max_version=0,_tagged_fields={}},{api_key=28,min_version=0,max_version=3,_tagged_fields={}},{api_key=29,min_version=0,max_version=2,_tagged_fields={}},{api_key=30,min_version=0,max_version=2,_tagged_fields={}},{api_key=31,min_version=0,max_version=2,_tagged_fields={}},{api_key=32,min_version=0,max_version=2,_tagged_fields={}},{api_key=33,min_version=0,max_version=1,_tagged_fields={}},{api_key=34,min_version=0,max_version=1,_tagged_fields={}},{api_key=35,min_version=0,max_version=1,_tagged_fields={}},{api_key=36,min_version=0,max_version=2,_tagged_fields={}},{api_key=37,min_version=0,max_version=2,_tagged_fields={}},{api_key=38,min_version=0,max_version=2,_tagged_fields={}},{api_key=39,min_version=0,max_version=2,_tagged_fields={}},{api_key=40,min_version=0,max_version=2,_tagged_fields={}},{api_key=41,min_version=0,max_version=2,_tagged_fields={}},{api_key=42,min_version=0,max_version=2,_tagged_fields={}},{api_key=43,min_version=0,max_version=2,_tagged_fields={}},{api_key=44,min_version=0,max_version=1,_tagged_fields={}},{api_key=45,min_version=0,max_version=0,_tagged_fields={}},{api_key=46,min_version=0,max_version=0,_tagged_fields={}},{api_key=47,min_version=0,max_version=0,_tagged_fields={}}],throttle_time_ms=0,_tagged_fields={}} from connection 172.31.31.3:9092-172.31.31.254:46098-8;totalTime:0.306,requestQueueTime:0.085,localTime:0.125,remoteTime:0.0,throttleTime:0.107,responseQueueTime:0.013,sendTime:0.081,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:44,569] DEBUG Completed request:RequestHeader(apiKey=API_VERSIONS, apiVersion=3, clientId=rdkafka, correlationId=1) -- {client_software_name=confluent-kafka-python,client_software_version=1.5.0-rdkafka-1.5.0,_tagged_fields={}},response:{error_code=0,api_keys=[{api_key=0,min_version=0,max_version=8,_tagged_fields={}},{api_key=1,min_version=0,max_version=11,_tagged_fields={}},{api_key=2,min_version=0,max_version=5,_tagged_fields={}},{api_key=3,min_version=0,max_version=9,_tagged_fields={}},{api_key=4,min_version=0,max_version=4,_tagged_fields={}},{api_key=5,min_version=0,max_version=2,_tagged_fields={}},{api_key=6,min_version=0,max_version=6,_tagged_fields={}},{api_key=7,min_version=0,max_version=3,_tagged_fields={}},{api_key=8,min_version=0,max_version=8,_tagged_fields={}},{api_key=9,min_version=0,max_version=7,_tagged_fields={}},{api_key=10,min_version=0,max_version=3,_tagged_fields={}},{api_key=11,min_version=0,max_version=7,_tagged_fields={}},{api_key=12,min_version=0,max_version=4,_tagged_fields={}},{api_key=13,min_version=0,max_version=4,_tagged_fields={}},{api_key=14,min_version=0,max_version=5,_tagged_fields={}},{api_key=15,min_version=0,max_version=5,_tagged_fields={}},{api_key=16,min_version=0,max_version=3,_tagged_fields={}},{api_key=17,min_version=0,max_version=1,_tagged_fields={}},{api_key=18,min_version=0,max_version=3,_tagged_fields={}},{api_key=19,min_version=0,max_version=5,_tagged_fields={}},{api_key=20,min_version=0,max_version=4,_tagged_fields={}},{api_key=21,min_version=0,max_version=1,_tagged_fields={}},{api_key=22,min_version=0,max_version=3,_tagged_fields={}},{api_key=23,min_version=0,max_version=3,_tagged_fields={}},{api_key=24,min_version=0,max_version=1,_tagged_fields={}},{api_key=25,min_version=0,max_version=1,_tagged_fields={}},{api_key=26,min_version=0,max_version=1,_tagged_fields={}},{api_key=27,min_version=0,max_version=0,_tagged_fields={}},{api_key=28,min_version=0,max_version=3,_tagged_fields={}},{api_key=29,min_version=0,max_version=2,_tagged_fields={}},{api_key=30,min_version=0,max_version=2,_tagged_fields={}},{api_key=31,min_version=0,max_version=2,_tagged_fields={}},{api_key=32,min_version=0,max_version=2,_tagged_fields={}},{api_key=33,min_version=0,max_version=1,_tagged_fields={}},{api_key=34,min_version=0,max_version=1,_tagged_fields={}},{api_key=35,min_version=0,max_version=1,_tagged_fields={}},{api_key=36,min_version=0,max_version=2,_tagged_fields={}},{api_key=37,min_version=0,max_version=2,_tagged_fields={}},{api_key=38,min_version=0,max_version=2,_tagged_fields={}},{api_key=39,min_version=0,max_version=2,_tagged_fields={}},{api_key=40,min_version=0,max_version=2,_tagged_fields={}},{api_key=41,min_version=0,max_version=2,_tagged_fields={}},{api_key=42,min_version=0,max_version=2,_tagged_fields={}},{api_key=43,min_version=0,max_version=2,_tagged_fields={}},{api_key=44,min_version=0,max_version=1,_tagged_fields={}},{api_key=45,min_version=0,max_version=0,_tagged_fields={}},{api_key=46,min_version=0,max_version=0,_tagged_fields={}},{api_key=47,min_version=0,max_version=0,_tagged_fields={}}],throttle_time_ms=0,_tagged_fields={}} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:0.355,requestQueueTime:0.051,localTime:0.15,remoteTime:0.0,throttleTime:0.129,responseQueueTime:0.036,sendTime:0.117,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:44,569] DEBUG Completed request:RequestHeader(apiKey=METADATA, apiVersion=4, clientId=rdkafka, correlationId=2) -- {topics=[],allow_auto_topic_creation=true},response:{throttle_time_ms=0,brokers=[{node_id=1001,host=172.31.31.3,port=9092,rack=null}],cluster_id=QiooE7cPQ-GwOKmM8lbPPg,controller_id=1001,topics=[]} from connection 172.31.31.3:9092-172.31.31.254:46098-8;totalTime:0.304,requestQueueTime:0.035,localTime:0.223,remoteTime:0.0,throttleTime:0.083,responseQueueTime:0.011,sendTime:0.034,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:44,569] DEBUG Completed request:RequestHeader(apiKey=METADATA, apiVersion=4, clientId=rdkafka, correlationId=2) -- {topics=[],allow_auto_topic_creation=false},response:{throttle_time_ms=0,brokers=[{node_id=1001,host=172.31.31.3,port=9092,rack=null}],cluster_id=QiooE7cPQ-GwOKmM8lbPPg,controller_id=1001,topics=[]} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:0.278,requestQueueTime:0.034,localTime:0.202,remoteTime:0.0,throttleTime:0.081,responseQueueTime:0.01,sendTime:0.03,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:44,569] DEBUG Completed request:RequestHeader(apiKey=FIND_COORDINATOR, apiVersion=2, clientId=rdkafka, correlationId=3) -- {key=kafka-tr-issue-201011-pr,key_type=0},response:{throttle_time_ms=0,error_code=0,error_message=NONE,node_id=1001,host=172.31.31.3,port=9092} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:0.3,requestQueueTime:0.036,localTime:0.221,remoteTime:0.0,throttleTime:0.055,responseQueueTime:0.01,sendTime:0.032,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:44,570] DEBUG Processor 0 listening to new connection from /172.31.31.254:46100 (kafka.network.Processor)
[2020-10-15 10:55:44,570] DEBUG Accepted connection from /172.31.31.254:46100 on /172.31.31.3:9092 and assigned it to processor 0, sendBufferSize [actual|requested]: [102400|102400] recvBufferSize [actual|requested]: [102400|102400] (kafka.network.Acceptor)
[2020-10-15 10:55:44,570] DEBUG Completed request:RequestHeader(apiKey=API_VERSIONS, apiVersion=3, clientId=rdkafka, correlationId=1) -- {client_software_name=confluent-kafka-python,client_software_version=1.5.0-rdkafka-1.5.0,_tagged_fields={}},response:{error_code=0,api_keys=[{api_key=0,min_version=0,max_version=8,_tagged_fields={}},{api_key=1,min_version=0,max_version=11,_tagged_fields={}},{api_key=2,min_version=0,max_version=5,_tagged_fields={}},{api_key=3,min_version=0,max_version=9,_tagged_fields={}},{api_key=4,min_version=0,max_version=4,_tagged_fields={}},{api_key=5,min_version=0,max_version=2,_tagged_fields={}},{api_key=6,min_version=0,max_version=6,_tagged_fields={}},{api_key=7,min_version=0,max_version=3,_tagged_fields={}},{api_key=8,min_version=0,max_version=8,_tagged_fields={}},{api_key=9,min_version=0,max_version=7,_tagged_fields={}},{api_key=10,min_version=0,max_version=3,_tagged_fields={}},{api_key=11,min_version=0,max_version=7,_tagged_fields={}},{api_key=12,min_version=0,max_version=4,_tagged_fields={}},{api_key=13,min_version=0,max_version=4,_tagged_fields={}},{api_key=14,min_version=0,max_version=5,_tagged_fields={}},{api_key=15,min_version=0,max_version=5,_tagged_fields={}},{api_key=16,min_version=0,max_version=3,_tagged_fields={}},{api_key=17,min_version=0,max_version=1,_tagged_fields={}},{api_key=18,min_version=0,max_version=3,_tagged_fields={}},{api_key=19,min_version=0,max_version=5,_tagged_fields={}},{api_key=20,min_version=0,max_version=4,_tagged_fields={}},{api_key=21,min_version=0,max_version=1,_tagged_fields={}},{api_key=22,min_version=0,max_version=3,_tagged_fields={}},{api_key=23,min_version=0,max_version=3,_tagged_fields={}},{api_key=24,min_version=0,max_version=1,_tagged_fields={}},{api_key=25,min_version=0,max_version=1,_tagged_fields={}},{api_key=26,min_version=0,max_version=1,_tagged_fields={}},{api_key=27,min_version=0,max_version=0,_tagged_fields={}},{api_key=28,min_version=0,max_version=3,_tagged_fields={}},{api_key=29,min_version=0,max_version=2,_tagged_fields={}},{api_key=30,min_version=0,max_version=2,_tagged_fields={}},{api_key=31,min_version=0,max_version=2,_tagged_fields={}},{api_key=32,min_version=0,max_version=2,_tagged_fields={}},{api_key=33,min_version=0,max_version=1,_tagged_fields={}},{api_key=34,min_version=0,max_version=1,_tagged_fields={}},{api_key=35,min_version=0,max_version=1,_tagged_fields={}},{api_key=36,min_version=0,max_version=2,_tagged_fields={}},{api_key=37,min_version=0,max_version=2,_tagged_fields={}},{api_key=38,min_version=0,max_version=2,_tagged_fields={}},{api_key=39,min_version=0,max_version=2,_tagged_fields={}},{api_key=40,min_version=0,max_version=2,_tagged_fields={}},{api_key=41,min_version=0,max_version=2,_tagged_fields={}},{api_key=42,min_version=0,max_version=2,_tagged_fields={}},{api_key=43,min_version=0,max_version=2,_tagged_fields={}},{api_key=44,min_version=0,max_version=1,_tagged_fields={}},{api_key=45,min_version=0,max_version=0,_tagged_fields={}},{api_key=46,min_version=0,max_version=0,_tagged_fields={}},{api_key=47,min_version=0,max_version=0,_tagged_fields={}}],throttle_time_ms=0,_tagged_fields={}} from connection 172.31.31.3:9092-172.31.31.254:46100-9;totalTime:0.128,requestQueueTime:0.025,localTime:0.065,remoteTime:0.0,throttleTime:0.062,responseQueueTime:0.006,sendTime:0.03,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:44,570] DEBUG Completed request:RequestHeader(apiKey=METADATA, apiVersion=4, clientId=rdkafka, correlationId=2) -- {topics=[],allow_auto_topic_creation=false},response:{throttle_time_ms=0,brokers=[{node_id=1001,host=172.31.31.3,port=9092,rack=null}],cluster_id=QiooE7cPQ-GwOKmM8lbPPg,controller_id=1001,topics=[]} from connection 172.31.31.3:9092-172.31.31.254:46100-9;totalTime:0.148,requestQueueTime:0.017,localTime:0.075,remoteTime:0.0,throttleTime:0.03,responseQueueTime:0.018,sendTime:0.036,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:44,570] DEBUG Completed request:RequestHeader(apiKey=FIND_COORDINATOR, apiVersion=2, clientId=rdkafka, correlationId=4) -- {key=kafka-tr-issue-201011-pr,key_type=0},response:{throttle_time_ms=0,error_code=0,error_message=NONE,node_id=1001,host=172.31.31.3,port=9092} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:0.753,requestQueueTime:0.031,localTime:0.099,remoteTime:0.0,throttleTime:0.031,responseQueueTime:0.585,sendTime:0.036,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:44,570] DEBUG Completed request:RequestHeader(apiKey=METADATA, apiVersion=4, clientId=rdkafka, correlationId=5) -- {topics=[{name=demooutput1602758609}],allow_auto_topic_creation=false},response:{throttle_time_ms=0,brokers=[{node_id=1001,host=172.31.31.3,port=9092,rack=null}],cluster_id=QiooE7cPQ-GwOKmM8lbPPg,controller_id=1001,topics=[{error_code=0,name=demooutput1602758609,is_internal=false,partitions=[{error_code=0,partition_index=0,leader_id=1001,replica_nodes=[1001],isr_nodes=[1001]}]}]} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:0.269,requestQueueTime:0.02,localTime:0.207,remoteTime:0.0,throttleTime:0.064,responseQueueTime:0.01,sendTime:0.03,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:44,571] DEBUG [GroupCoordinator 1001]: Dynamic member with unknown member id joins group kafka-tr-issue-201011-pr in Empty state. Created a new member id rdkafka-d47e6757-9256-4bf4-a74d-5beea7624a67 and request the member to rejoin with this id. (kafka.coordinator.group.GroupCoordinator)
[2020-10-15 10:55:44,571] DEBUG Completed request:RequestHeader(apiKey=JOIN_GROUP, apiVersion=5, clientId=rdkafka, correlationId=3) -- {group_id=kafka-tr-issue-201011-pr,session_timeout_ms=10000,rebalance_timeout_ms=300000,member_id=,group_instance_id=null,protocol_type=consumer,protocols=[{name=range,metadata=java.nio.HeapByteBuffer[pos=0 lim=38 cap=38]},{name=roundrobin,metadata=java.nio.HeapByteBuffer[pos=0 lim=38 cap=38]}]},response:{throttle_time_ms=0,error_code=79,generation_id=-1,protocol_name=,leader=,member_id=rdkafka-d47e6757-9256-4bf4-a74d-5beea7624a67,members=[]} from connection 172.31.31.3:9092-172.31.31.254:46100-9;totalTime:0.341,requestQueueTime:0.054,localTime:0.242,remoteTime:0.0,throttleTime:0.032,responseQueueTime:0.012,sendTime:0.032,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:44,571] DEBUG [GroupCoordinator 1001]: Dynamic Member with specific member id rdkafka-d47e6757-9256-4bf4-a74d-5beea7624a67 joins group kafka-tr-issue-201011-pr in Empty state. Adding to the group now. (kafka.coordinator.group.GroupCoordinator)
[2020-10-15 10:55:44,571] DEBUG Request key MemberKey(kafka-tr-issue-201011-pr,rdkafka-d47e6757-9256-4bf4-a74d-5beea7624a67) unblocked 1 Heartbeat operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:44,571] INFO [GroupCoordinator 1001]: Preparing to rebalance group kafka-tr-issue-201011-pr in state PreparingRebalance with old generation 6 (__consumer_offsets-2) (reason: Adding new member rdkafka-d47e6757-9256-4bf4-a74d-5beea7624a67 with group instance id None) (kafka.coordinator.group.GroupCoordinator)
[2020-10-15 10:55:44,572] DEBUG Request key GroupKey(kafka-tr-issue-201011-pr) unblocked 0 Rebalance operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:44,572] INFO [GroupCoordinator 1001]: Stabilized group kafka-tr-issue-201011-pr generation 7 (__consumer_offsets-2) (kafka.coordinator.group.GroupCoordinator)
[2020-10-15 10:55:44,572] DEBUG Request key MemberKey(kafka-tr-issue-201011-pr,rdkafka-d47e6757-9256-4bf4-a74d-5beea7624a67) unblocked 1 Heartbeat operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:44,572] DEBUG Completed request:RequestHeader(apiKey=JOIN_GROUP, apiVersion=5, clientId=rdkafka, correlationId=4) -- {group_id=kafka-tr-issue-201011-pr,session_timeout_ms=10000,rebalance_timeout_ms=300000,member_id=rdkafka-d47e6757-9256-4bf4-a74d-5beea7624a67,group_instance_id=null,protocol_type=consumer,protocols=[{name=range,metadata=java.nio.HeapByteBuffer[pos=0 lim=38 cap=38]},{name=roundrobin,metadata=java.nio.HeapByteBuffer[pos=0 lim=38 cap=38]}]},response:{throttle_time_ms=0,error_code=0,generation_id=7,protocol_name=range,leader=rdkafka-d47e6757-9256-4bf4-a74d-5beea7624a67,member_id=rdkafka-d47e6757-9256-4bf4-a74d-5beea7624a67,members=[{member_id=rdkafka-d47e6757-9256-4bf4-a74d-5beea7624a67,group_instance_id=null,metadata=java.nio.HeapByteBuffer[pos=0 lim=38 cap=38]}]} from connection 172.31.31.3:9092-172.31.31.254:46100-9;totalTime:1.344,requestQueueTime:0.028,localTime:0.68,remoteTime:0.386,throttleTime:0.043,responseQueueTime:0.102,sendTime:0.103,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:44,573] DEBUG Completed request:RequestHeader(apiKey=METADATA, apiVersion=4, clientId=rdkafka, correlationId=5) -- {topics=[{name=demooutput1602758609}],allow_auto_topic_creation=false},response:{throttle_time_ms=0,brokers=[{node_id=1001,host=172.31.31.3,port=9092,rack=null}],cluster_id=QiooE7cPQ-GwOKmM8lbPPg,controller_id=1001,topics=[{error_code=0,name=demooutput1602758609,is_internal=false,partitions=[{error_code=0,partition_index=0,leader_id=1001,replica_nodes=[1001],isr_nodes=[1001]}]}]} from connection 172.31.31.3:9092-172.31.31.254:46100-9;totalTime:0.251,requestQueueTime:0.021,localTime:0.178,remoteTime:0.0,throttleTime:0.058,responseQueueTime:0.017,sendTime:0.034,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:44,573] INFO [GroupCoordinator 1001]: Assignment received from leader for group kafka-tr-issue-201011-pr for generation 7 (kafka.coordinator.group.GroupCoordinator)
[2020-10-15 10:55:44,573] DEBUG [Partition __consumer_offsets-2 broker=1001] High watermark updated from (offset=10 segment=[0:2055]) to (offset=11 segment=[0:2407]) (kafka.cluster.Partition)
[2020-10-15 10:55:44,573] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,2) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:44,573] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,2) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:44,574] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,2) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:44,574] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:44,574] DEBUG Completed request:RequestHeader(apiKey=SYNC_GROUP, apiVersion=3, clientId=rdkafka, correlationId=6) -- {group_id=kafka-tr-issue-201011-pr,generation_id=7,member_id=rdkafka-d47e6757-9256-4bf4-a74d-5beea7624a67,group_instance_id=null,assignments=[{member_id=rdkafka-d47e6757-9256-4bf4-a74d-5beea7624a67,assignment=java.nio.HeapByteBuffer[pos=0 lim=46 cap=46]}]},response:{throttle_time_ms=0,error_code=0,assignment=java.nio.HeapByteBuffer[pos=0 lim=46 cap=46]} from connection 172.31.31.3:9092-172.31.31.254:46100-9;totalTime:1.059,requestQueueTime:0.056,localTime:0.946,remoteTime:0.0,throttleTime:0.021,responseQueueTime:0.018,sendTime:0.037,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:44,574] DEBUG Request key MemberKey(kafka-tr-issue-201011-pr,rdkafka-d47e6757-9256-4bf4-a74d-5beea7624a67) unblocked 1 Heartbeat operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:44,574] DEBUG Request key MemberKey(kafka-tr-issue-201011-pr,rdkafka-d47e6757-9256-4bf4-a74d-5beea7624a67) unblocked 1 Heartbeat operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:44,575] DEBUG Completed request:RequestHeader(apiKey=HEARTBEAT, apiVersion=3, clientId=rdkafka, correlationId=7) -- {group_id=kafka-tr-issue-201011-pr,generation_id=7,member_id=rdkafka-d47e6757-9256-4bf4-a74d-5beea7624a67,group_instance_id=null},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46100-9;totalTime:0.619,requestQueueTime:0.033,localTime:0.537,remoteTime:0.0,throttleTime:0.03,responseQueueTime:0.014,sendTime:0.033,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:44,597] DEBUG Accepted connection from /172.31.31.254:46102 on /172.31.31.3:9092 and assigned it to processor 1, sendBufferSize [actual|requested]: [102400|102400] recvBufferSize [actual|requested]: [102400|102400] (kafka.network.Acceptor)
[2020-10-15 10:55:44,597] DEBUG Accepted connection from /172.31.31.254:46104 on /172.31.31.3:9092 and assigned it to processor 2, sendBufferSize [actual|requested]: [102400|102400] recvBufferSize [actual|requested]: [102400|102400] (kafka.network.Acceptor)
[2020-10-15 10:55:44,597] DEBUG Processor 2 listening to new connection from /172.31.31.254:46104 (kafka.network.Processor)
[2020-10-15 10:55:44,597] DEBUG Processor 1 listening to new connection from /172.31.31.254:46102 (kafka.network.Processor)
[2020-10-15 10:55:44,597] DEBUG Completed request:RequestHeader(apiKey=API_VERSIONS, apiVersion=3, clientId=rdkafka, correlationId=1) -- {client_software_name=confluent-kafka-python,client_software_version=1.5.0-rdkafka-1.5.0,_tagged_fields={}},response:{error_code=0,api_keys=[{api_key=0,min_version=0,max_version=8,_tagged_fields={}},{api_key=1,min_version=0,max_version=11,_tagged_fields={}},{api_key=2,min_version=0,max_version=5,_tagged_fields={}},{api_key=3,min_version=0,max_version=9,_tagged_fields={}},{api_key=4,min_version=0,max_version=4,_tagged_fields={}},{api_key=5,min_version=0,max_version=2,_tagged_fields={}},{api_key=6,min_version=0,max_version=6,_tagged_fields={}},{api_key=7,min_version=0,max_version=3,_tagged_fields={}},{api_key=8,min_version=0,max_version=8,_tagged_fields={}},{api_key=9,min_version=0,max_version=7,_tagged_fields={}},{api_key=10,min_version=0,max_version=3,_tagged_fields={}},{api_key=11,min_version=0,max_version=7,_tagged_fields={}},{api_key=12,min_version=0,max_version=4,_tagged_fields={}},{api_key=13,min_version=0,max_version=4,_tagged_fields={}},{api_key=14,min_version=0,max_version=5,_tagged_fields={}},{api_key=15,min_version=0,max_version=5,_tagged_fields={}},{api_key=16,min_version=0,max_version=3,_tagged_fields={}},{api_key=17,min_version=0,max_version=1,_tagged_fields={}},{api_key=18,min_version=0,max_version=3,_tagged_fields={}},{api_key=19,min_version=0,max_version=5,_tagged_fields={}},{api_key=20,min_version=0,max_version=4,_tagged_fields={}},{api_key=21,min_version=0,max_version=1,_tagged_fields={}},{api_key=22,min_version=0,max_version=3,_tagged_fields={}},{api_key=23,min_version=0,max_version=3,_tagged_fields={}},{api_key=24,min_version=0,max_version=1,_tagged_fields={}},{api_key=25,min_version=0,max_version=1,_tagged_fields={}},{api_key=26,min_version=0,max_version=1,_tagged_fields={}},{api_key=27,min_version=0,max_version=0,_tagged_fields={}},{api_key=28,min_version=0,max_version=3,_tagged_fields={}},{api_key=29,min_version=0,max_version=2,_tagged_fields={}},{api_key=30,min_version=0,max_version=2,_tagged_fields={}},{api_key=31,min_version=0,max_version=2,_tagged_fields={}},{api_key=32,min_version=0,max_version=2,_tagged_fields={}},{api_key=33,min_version=0,max_version=1,_tagged_fields={}},{api_key=34,min_version=0,max_version=1,_tagged_fields={}},{api_key=35,min_version=0,max_version=1,_tagged_fields={}},{api_key=36,min_version=0,max_version=2,_tagged_fields={}},{api_key=37,min_version=0,max_version=2,_tagged_fields={}},{api_key=38,min_version=0,max_version=2,_tagged_fields={}},{api_key=39,min_version=0,max_version=2,_tagged_fields={}},{api_key=40,min_version=0,max_version=2,_tagged_fields={}},{api_key=41,min_version=0,max_version=2,_tagged_fields={}},{api_key=42,min_version=0,max_version=2,_tagged_fields={}},{api_key=43,min_version=0,max_version=2,_tagged_fields={}},{api_key=44,min_version=0,max_version=1,_tagged_fields={}},{api_key=45,min_version=0,max_version=0,_tagged_fields={}},{api_key=46,min_version=0,max_version=0,_tagged_fields={}},{api_key=47,min_version=0,max_version=0,_tagged_fields={}}],throttle_time_ms=0,_tagged_fields={}} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.253,requestQueueTime:0.058,localTime:0.117,remoteTime:0.0,throttleTime:0.106,responseQueueTime:0.015,sendTime:0.062,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:44,598] DEBUG Completed request:RequestHeader(apiKey=API_VERSIONS, apiVersion=3, clientId=rdkafka, correlationId=1) -- {client_software_name=confluent-kafka-python,client_software_version=1.5.0-rdkafka-1.5.0,_tagged_fields={}},response:{error_code=0,api_keys=[{api_key=0,min_version=0,max_version=8,_tagged_fields={}},{api_key=1,min_version=0,max_version=11,_tagged_fields={}},{api_key=2,min_version=0,max_version=5,_tagged_fields={}},{api_key=3,min_version=0,max_version=9,_tagged_fields={}},{api_key=4,min_version=0,max_version=4,_tagged_fields={}},{api_key=5,min_version=0,max_version=2,_tagged_fields={}},{api_key=6,min_version=0,max_version=6,_tagged_fields={}},{api_key=7,min_version=0,max_version=3,_tagged_fields={}},{api_key=8,min_version=0,max_version=8,_tagged_fields={}},{api_key=9,min_version=0,max_version=7,_tagged_fields={}},{api_key=10,min_version=0,max_version=3,_tagged_fields={}},{api_key=11,min_version=0,max_version=7,_tagged_fields={}},{api_key=12,min_version=0,max_version=4,_tagged_fields={}},{api_key=13,min_version=0,max_version=4,_tagged_fields={}},{api_key=14,min_version=0,max_version=5,_tagged_fields={}},{api_key=15,min_version=0,max_version=5,_tagged_fields={}},{api_key=16,min_version=0,max_version=3,_tagged_fields={}},{api_key=17,min_version=0,max_version=1,_tagged_fields={}},{api_key=18,min_version=0,max_version=3,_tagged_fields={}},{api_key=19,min_version=0,max_version=5,_tagged_fields={}},{api_key=20,min_version=0,max_version=4,_tagged_fields={}},{api_key=21,min_version=0,max_version=1,_tagged_fields={}},{api_key=22,min_version=0,max_version=3,_tagged_fields={}},{api_key=23,min_version=0,max_version=3,_tagged_fields={}},{api_key=24,min_version=0,max_version=1,_tagged_fields={}},{api_key=25,min_version=0,max_version=1,_tagged_fields={}},{api_key=26,min_version=0,max_version=1,_tagged_fields={}},{api_key=27,min_version=0,max_version=0,_tagged_fields={}},{api_key=28,min_version=0,max_version=3,_tagged_fields={}},{api_key=29,min_version=0,max_version=2,_tagged_fields={}},{api_key=30,min_version=0,max_version=2,_tagged_fields={}},{api_key=31,min_version=0,max_version=2,_tagged_fields={}},{api_key=32,min_version=0,max_version=2,_tagged_fields={}},{api_key=33,min_version=0,max_version=1,_tagged_fields={}},{api_key=34,min_version=0,max_version=1,_tagged_fields={}},{api_key=35,min_version=0,max_version=1,_tagged_fields={}},{api_key=36,min_version=0,max_version=2,_tagged_fields={}},{api_key=37,min_version=0,max_version=2,_tagged_fields={}},{api_key=38,min_version=0,max_version=2,_tagged_fields={}},{api_key=39,min_version=0,max_version=2,_tagged_fields={}},{api_key=40,min_version=0,max_version=2,_tagged_fields={}},{api_key=41,min_version=0,max_version=2,_tagged_fields={}},{api_key=42,min_version=0,max_version=2,_tagged_fields={}},{api_key=43,min_version=0,max_version=2,_tagged_fields={}},{api_key=44,min_version=0,max_version=1,_tagged_fields={}},{api_key=45,min_version=0,max_version=0,_tagged_fields={}},{api_key=46,min_version=0,max_version=0,_tagged_fields={}},{api_key=47,min_version=0,max_version=0,_tagged_fields={}}],throttle_time_ms=0,_tagged_fields={}} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:0.409,requestQueueTime:0.102,localTime:0.198,remoteTime:0.0,throttleTime:0.187,responseQueueTime:0.015,sendTime:0.092,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:44,598] DEBUG Completed request:RequestHeader(apiKey=METADATA, apiVersion=4, clientId=rdkafka, correlationId=2) -- {topics=[],allow_auto_topic_creation=true},response:{throttle_time_ms=0,brokers=[{node_id=1001,host=172.31.31.3,port=9092,rack=null}],cluster_id=QiooE7cPQ-GwOKmM8lbPPg,controller_id=1001,topics=[]} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.644,requestQueueTime:0.347,localTime:0.244,remoteTime:0.0,throttleTime:0.092,responseQueueTime:0.017,sendTime:0.034,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:44,598] DEBUG Completed request:RequestHeader(apiKey=METADATA, apiVersion=4, clientId=rdkafka, correlationId=2) -- {topics=[{name=demoinput1602758609}],allow_auto_topic_creation=false},response:{throttle_time_ms=0,brokers=[{node_id=1001,host=172.31.31.3,port=9092,rack=null}],cluster_id=QiooE7cPQ-GwOKmM8lbPPg,controller_id=1001,topics=[{error_code=0,name=demoinput1602758609,is_internal=false,partitions=[{error_code=0,partition_index=0,leader_id=1001,replica_nodes=[1001],isr_nodes=[1001]}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:0.398,requestQueueTime:0.026,localTime:0.315,remoteTime:0.0,throttleTime:0.098,responseQueueTime:0.02,sendTime:0.036,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:44,598] DEBUG Completed request:RequestHeader(apiKey=FIND_COORDINATOR, apiVersion=2, clientId=rdkafka, correlationId=3) -- {key=eos-transactions.py,key_type=1},response:{throttle_time_ms=0,error_code=0,error_message=NONE,node_id=1001,host=172.31.31.3,port=9092} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.2,requestQueueTime:0.021,localTime:0.125,remoteTime:0.0,throttleTime:0.048,responseQueueTime:0.014,sendTime:0.038,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:44,599] DEBUG Completed request:RequestHeader(apiKey=FIND_COORDINATOR, apiVersion=2, clientId=rdkafka, correlationId=3) -- {key=kafka-tr-issue-201011-tr,key_type=0},response:{throttle_time_ms=0,error_code=0,error_message=NONE,node_id=1001,host=172.31.31.3,port=9092} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:0.215,requestQueueTime:0.019,localTime:0.15,remoteTime:0.0,throttleTime:0.047,responseQueueTime:0.013,sendTime:0.031,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:44,599] DEBUG Processor 0 listening to new connection from /172.31.31.254:46106 (kafka.network.Processor)
[2020-10-15 10:55:44,599] DEBUG Completed request:RequestHeader(apiKey=FIND_COORDINATOR, apiVersion=2, clientId=rdkafka, correlationId=4) -- {key=kafka-tr-issue-201011-tr,key_type=0},response:{throttle_time_ms=0,error_code=0,error_message=NONE,node_id=1001,host=172.31.31.3,port=9092} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:0.164,requestQueueTime:0.016,localTime:0.098,remoteTime:0.0,throttleTime:0.031,responseQueueTime:0.011,sendTime:0.038,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:44,599] DEBUG Accepted connection from /172.31.31.254:46106 on /172.31.31.3:9092 and assigned it to processor 0, sendBufferSize [actual|requested]: [102400|102400] recvBufferSize [actual|requested]: [102400|102400] (kafka.network.Acceptor)
[2020-10-15 10:55:44,599] DEBUG Completed request:RequestHeader(apiKey=API_VERSIONS, apiVersion=3, clientId=rdkafka, correlationId=1) -- {client_software_name=confluent-kafka-python,client_software_version=1.5.0-rdkafka-1.5.0,_tagged_fields={}},response:{error_code=0,api_keys=[{api_key=0,min_version=0,max_version=8,_tagged_fields={}},{api_key=1,min_version=0,max_version=11,_tagged_fields={}},{api_key=2,min_version=0,max_version=5,_tagged_fields={}},{api_key=3,min_version=0,max_version=9,_tagged_fields={}},{api_key=4,min_version=0,max_version=4,_tagged_fields={}},{api_key=5,min_version=0,max_version=2,_tagged_fields={}},{api_key=6,min_version=0,max_version=6,_tagged_fields={}},{api_key=7,min_version=0,max_version=3,_tagged_fields={}},{api_key=8,min_version=0,max_version=8,_tagged_fields={}},{api_key=9,min_version=0,max_version=7,_tagged_fields={}},{api_key=10,min_version=0,max_version=3,_tagged_fields={}},{api_key=11,min_version=0,max_version=7,_tagged_fields={}},{api_key=12,min_version=0,max_version=4,_tagged_fields={}},{api_key=13,min_version=0,max_version=4,_tagged_fields={}},{api_key=14,min_version=0,max_version=5,_tagged_fields={}},{api_key=15,min_version=0,max_version=5,_tagged_fields={}},{api_key=16,min_version=0,max_version=3,_tagged_fields={}},{api_key=17,min_version=0,max_version=1,_tagged_fields={}},{api_key=18,min_version=0,max_version=3,_tagged_fields={}},{api_key=19,min_version=0,max_version=5,_tagged_fields={}},{api_key=20,min_version=0,max_version=4,_tagged_fields={}},{api_key=21,min_version=0,max_version=1,_tagged_fields={}},{api_key=22,min_version=0,max_version=3,_tagged_fields={}},{api_key=23,min_version=0,max_version=3,_tagged_fields={}},{api_key=24,min_version=0,max_version=1,_tagged_fields={}},{api_key=25,min_version=0,max_version=1,_tagged_fields={}},{api_key=26,min_version=0,max_version=1,_tagged_fields={}},{api_key=27,min_version=0,max_version=0,_tagged_fields={}},{api_key=28,min_version=0,max_version=3,_tagged_fields={}},{api_key=29,min_version=0,max_version=2,_tagged_fields={}},{api_key=30,min_version=0,max_version=2,_tagged_fields={}},{api_key=31,min_version=0,max_version=2,_tagged_fields={}},{api_key=32,min_version=0,max_version=2,_tagged_fields={}},{api_key=33,min_version=0,max_version=1,_tagged_fields={}},{api_key=34,min_version=0,max_version=1,_tagged_fields={}},{api_key=35,min_version=0,max_version=1,_tagged_fields={}},{api_key=36,min_version=0,max_version=2,_tagged_fields={}},{api_key=37,min_version=0,max_version=2,_tagged_fields={}},{api_key=38,min_version=0,max_version=2,_tagged_fields={}},{api_key=39,min_version=0,max_version=2,_tagged_fields={}},{api_key=40,min_version=0,max_version=2,_tagged_fields={}},{api_key=41,min_version=0,max_version=2,_tagged_fields={}},{api_key=42,min_version=0,max_version=2,_tagged_fields={}},{api_key=43,min_version=0,max_version=2,_tagged_fields={}},{api_key=44,min_version=0,max_version=1,_tagged_fields={}},{api_key=45,min_version=0,max_version=0,_tagged_fields={}},{api_key=46,min_version=0,max_version=0,_tagged_fields={}},{api_key=47,min_version=0,max_version=0,_tagged_fields={}}],throttle_time_ms=0,_tagged_fields={}} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.169,requestQueueTime:0.041,localTime:0.075,remoteTime:0.0,throttleTime:0.073,responseQueueTime:0.014,sendTime:0.038,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:44,599] DEBUG Accepted connection from /172.31.31.254:46108 on /172.31.31.3:9092 and assigned it to processor 1, sendBufferSize [actual|requested]: [102400|102400] recvBufferSize [actual|requested]: [102400|102400] (kafka.network.Acceptor)
[2020-10-15 10:55:44,599] DEBUG Processor 1 listening to new connection from /172.31.31.254:46108 (kafka.network.Processor)
[2020-10-15 10:55:44,600] DEBUG Completed request:RequestHeader(apiKey=METADATA, apiVersion=4, clientId=rdkafka, correlationId=2) -- {topics=[],allow_auto_topic_creation=true},response:{throttle_time_ms=0,brokers=[{node_id=1001,host=172.31.31.3,port=9092,rack=null}],cluster_id=QiooE7cPQ-GwOKmM8lbPPg,controller_id=1001,topics=[]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.181,requestQueueTime:0.017,localTime:0.093,remoteTime:0.0,throttleTime:0.034,responseQueueTime:0.01,sendTime:0.061,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:44,600] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Empty, topicPartitions=Set(), txnStartTimestamp=-1, txnLastUpdateTimestamp=1602759344600) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:44,600] DEBUG Completed request:RequestHeader(apiKey=API_VERSIONS, apiVersion=3, clientId=rdkafka, correlationId=1) -- {client_software_name=confluent-kafka-python,client_software_version=1.5.0-rdkafka-1.5.0,_tagged_fields={}},response:{error_code=0,api_keys=[{api_key=0,min_version=0,max_version=8,_tagged_fields={}},{api_key=1,min_version=0,max_version=11,_tagged_fields={}},{api_key=2,min_version=0,max_version=5,_tagged_fields={}},{api_key=3,min_version=0,max_version=9,_tagged_fields={}},{api_key=4,min_version=0,max_version=4,_tagged_fields={}},{api_key=5,min_version=0,max_version=2,_tagged_fields={}},{api_key=6,min_version=0,max_version=6,_tagged_fields={}},{api_key=7,min_version=0,max_version=3,_tagged_fields={}},{api_key=8,min_version=0,max_version=8,_tagged_fields={}},{api_key=9,min_version=0,max_version=7,_tagged_fields={}},{api_key=10,min_version=0,max_version=3,_tagged_fields={}},{api_key=11,min_version=0,max_version=7,_tagged_fields={}},{api_key=12,min_version=0,max_version=4,_tagged_fields={}},{api_key=13,min_version=0,max_version=4,_tagged_fields={}},{api_key=14,min_version=0,max_version=5,_tagged_fields={}},{api_key=15,min_version=0,max_version=5,_tagged_fields={}},{api_key=16,min_version=0,max_version=3,_tagged_fields={}},{api_key=17,min_version=0,max_version=1,_tagged_fields={}},{api_key=18,min_version=0,max_version=3,_tagged_fields={}},{api_key=19,min_version=0,max_version=5,_tagged_fields={}},{api_key=20,min_version=0,max_version=4,_tagged_fields={}},{api_key=21,min_version=0,max_version=1,_tagged_fields={}},{api_key=22,min_version=0,max_version=3,_tagged_fields={}},{api_key=23,min_version=0,max_version=3,_tagged_fields={}},{api_key=24,min_version=0,max_version=1,_tagged_fields={}},{api_key=25,min_version=0,max_version=1,_tagged_fields={}},{api_key=26,min_version=0,max_version=1,_tagged_fields={}},{api_key=27,min_version=0,max_version=0,_tagged_fields={}},{api_key=28,min_version=0,max_version=3,_tagged_fields={}},{api_key=29,min_version=0,max_version=2,_tagged_fields={}},{api_key=30,min_version=0,max_version=2,_tagged_fields={}},{api_key=31,min_version=0,max_version=2,_tagged_fields={}},{api_key=32,min_version=0,max_version=2,_tagged_fields={}},{api_key=33,min_version=0,max_version=1,_tagged_fields={}},{api_key=34,min_version=0,max_version=1,_tagged_fields={}},{api_key=35,min_version=0,max_version=1,_tagged_fields={}},{api_key=36,min_version=0,max_version=2,_tagged_fields={}},{api_key=37,min_version=0,max_version=2,_tagged_fields={}},{api_key=38,min_version=0,max_version=2,_tagged_fields={}},{api_key=39,min_version=0,max_version=2,_tagged_fields={}},{api_key=40,min_version=0,max_version=2,_tagged_fields={}},{api_key=41,min_version=0,max_version=2,_tagged_fields={}},{api_key=42,min_version=0,max_version=2,_tagged_fields={}},{api_key=43,min_version=0,max_version=2,_tagged_fields={}},{api_key=44,min_version=0,max_version=1,_tagged_fields={}},{api_key=45,min_version=0,max_version=0,_tagged_fields={}},{api_key=46,min_version=0,max_version=0,_tagged_fields={}},{api_key=47,min_version=0,max_version=0,_tagged_fields={}}],throttle_time_ms=0,_tagged_fields={}} from connection 172.31.31.3:9092-172.31.31.254:46108-10;totalTime:0.319,requestQueueTime:0.04,localTime:0.069,remoteTime:0.0,throttleTime:0.064,responseQueueTime:0.166,sendTime:0.043,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:44,600] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=243 segment=[0:41183]) to (offset=244 segment=[0:41312]) (kafka.cluster.Partition)
[2020-10-15 10:55:44,600] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:44,600] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:44,600] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:44,600] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:44,600] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Empty, topicPartitions=Set(), txnStartTimestamp=-1, txnLastUpdateTimestamp=1602759344600) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:44,600] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Empty, topicPartitions=Set(), txnStartTimestamp=-1, txnLastUpdateTimestamp=1602759344600) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:44,600] INFO [TransactionCoordinator id=1001] Initialized transactionalId eos-transactions.py with producerId 0 and producer epoch 3 on partition __transaction_state-26 (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:44,600] DEBUG Completed request:RequestHeader(apiKey=INIT_PRODUCER_ID, apiVersion=1, clientId=rdkafka, correlationId=3) -- {transactional_id=eos-transactions.py,transaction_timeout_ms=60000},response:{throttle_time_ms=0,error_code=0,producer_id=0,producer_epoch=3} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.683,requestQueueTime:0.046,localTime:0.562,remoteTime:0.0,throttleTime:0.019,responseQueueTime:0.017,sendTime:0.057,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:45,098] DEBUG Completed request:RequestHeader(apiKey=FIND_COORDINATOR, apiVersion=2, clientId=rdkafka, correlationId=4) -- {key=eos-transactions.py,key_type=1},response:{throttle_time_ms=0,error_code=0,error_message=NONE,node_id=1001,host=172.31.31.3,port=9092} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.483,requestQueueTime:0.052,localTime:0.329,remoteTime:0.0,throttleTime:0.116,responseQueueTime:0.022,sendTime:0.079,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:45,596] DEBUG Completed request:RequestHeader(apiKey=OFFSET_FETCH, apiVersion=1, clientId=rdkafka, correlationId=2) -- {group_id=kafka-tr-issue-201011-tr,topics=[{name=demoinput1602758609,partition_indexes=[0]}]},response:{topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=60,metadata=,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46108-10;totalTime:0.565,requestQueueTime:0.102,localTime:0.291,remoteTime:0.0,throttleTime:0.246,responseQueueTime:0.044,sendTime:0.127,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:45,596] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,096] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,097] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=5) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=60,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=60,last_stable_offset=60,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=MemoryRecords(size=0, buffer=java.nio.HeapByteBuffer[pos=0 lim=0 cap=0])}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:500.646,requestQueueTime:0.072,localTime:0.34,remoteTime:499.75,throttleTime:0.273,responseQueueTime:0.034,sendTime:0.176,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,097] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,568] DEBUG Completed request:RequestHeader(apiKey=METADATA, apiVersion=4, clientId=rdkafka, correlationId=3) -- {topics=[{name=demoinput1602758609}],allow_auto_topic_creation=true},response:{throttle_time_ms=0,brokers=[{node_id=1001,host=172.31.31.3,port=9092,rack=null}],cluster_id=QiooE7cPQ-GwOKmM8lbPPg,controller_id=1001,topics=[{error_code=0,name=demoinput1602758609,is_internal=false,partitions=[{error_code=0,partition_index=0,leader_id=1001,replica_nodes=[1001],isr_nodes=[1001]}]}]} from connection 172.31.31.3:9092-172.31.31.254:46098-8;totalTime:0.631,requestQueueTime:0.055,localTime:0.396,remoteTime:0.0,throttleTime:0.131,responseQueueTime:0.041,sendTime:0.136,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,569] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=60 segment=[0:4290]) to (offset=61 segment=[0:4361]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,569] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,569] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,569] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,569] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,569] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,570] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=6) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=60,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=61,last_stable_offset=61,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=71, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=4290, end=4361)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:472.377,requestQueueTime:0.094,localTime:0.363,remoteTime:471.46,throttleTime:0.196,responseQueueTime:0.063,sendTime:0.2,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,570] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,570] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=4) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=60,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46098-8;totalTime:1.655,requestQueueTime:0.073,localTime:1.317,remoteTime:0.0,throttleTime:0.058,responseQueueTime:0.148,sendTime:0.116,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,570] DEBUG TransactionalId eos-transactions.py prepare transition from Empty to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759346570, txnLastUpdateTimestamp=1602759346570) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,570] DEBUG Completed request:RequestHeader(apiKey=OFFSET_FETCH, apiVersion=1, clientId=rdkafka, correlationId=8) -- {group_id=kafka-tr-issue-201011-pr,topics=[{name=demooutput1602758609,partition_indexes=[0]}]},response:{topics=[{name=demooutput1602758609,partitions=[{partition_index=0,committed_offset=120,metadata=,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46100-9;totalTime:0.338,requestQueueTime:0.045,localTime:0.173,remoteTime:0.0,throttleTime:0.162,responseQueueTime:0.05,sendTime:0.069,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,570] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,571] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=244 segment=[0:41312]) to (offset=245 segment=[0:41470]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,571] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,571] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,571] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,571] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,571] DEBUG TransactionalId eos-transactions.py complete transition from Empty to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759346570, txnLastUpdateTimestamp=1602759346570) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,571] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759346570, txnLastUpdateTimestamp=1602759346570) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:46,571] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=4) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:1.047,requestQueueTime:0.032,localTime:0.937,remoteTime:0.0,throttleTime:0.027,responseQueueTime:0.022,sendTime:0.054,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,572] DEBUG Completed request:RequestHeader(apiKey=FIND_COORDINATOR, apiVersion=2, clientId=rdkafka, correlationId=5) -- {key=kafka-tr-issue-201011-tr,key_type=0},response:{throttle_time_ms=0,error_code=0,error_message=NONE,node_id=1001,host=172.31.31.3,port=9092} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.39,requestQueueTime:0.023,localTime:0.259,remoteTime:0.0,throttleTime:0.096,responseQueueTime:0.028,sendTime:0.078,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,572] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=120 segment=[0:13860])) (kafka.log.Log)
[2020-10-15 10:55:46,573] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=120 segment=[0:13860]) to (offset=121 segment=[0:14013]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,573] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,573] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,573] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,573] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,573] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=6) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=3,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=61,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.795,requestQueueTime:0.044,localTime:0.659,remoteTime:0.0,throttleTime:0.043,responseQueueTime:0.02,sendTime:0.071,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,597] DEBUG Completed request:RequestHeader(apiKey=METADATA, apiVersion=4, clientId=rdkafka, correlationId=7) -- {topics=[{name=demooutput1602758609}],allow_auto_topic_creation=true},response:{throttle_time_ms=0,brokers=[{node_id=1001,host=172.31.31.3,port=9092,rack=null}],cluster_id=QiooE7cPQ-GwOKmM8lbPPg,controller_id=1001,topics=[{error_code=0,name=demooutput1602758609,is_internal=false,partitions=[{error_code=0,partition_index=0,leader_id=1001,replica_nodes=[1001],isr_nodes=[1001]}]}]} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.513,requestQueueTime:0.035,localTime:0.4,remoteTime:0.0,throttleTime:0.136,responseQueueTime:0.021,sendTime:0.054,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,598] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346570, txnLastUpdateTimestamp=1602759346598) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,598] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=245 segment=[0:41470]) to (offset=246 segment=[0:41664]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,598] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,598] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,598] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,598] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,599] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346570, txnLastUpdateTimestamp=1602759346598) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,599] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346570, txnLastUpdateTimestamp=1602759346598) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:46,599] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=5) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.874,requestQueueTime:0.035,localTime:0.778,remoteTime:0.0,throttleTime:0.063,responseQueueTime:0.014,sendTime:0.046,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,599] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=120 segment=[0:9240])) (kafka.log.Log)
[2020-10-15 10:55:46,599] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=120 segment=[0:9240]) to (offset=121 segment=[0:9316]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,599] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,599] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,599] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,599] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,600] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=8) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=120,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.632,requestQueueTime:0.049,localTime:0.523,remoteTime:0.0,throttleTime:0.057,responseQueueTime:0.013,sendTime:0.045,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,600] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346570, txnLastUpdateTimestamp=1602759346600) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,600] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=246 segment=[0:41664]) to (offset=247 segment=[0:41858]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,600] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,600] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,600] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,600] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,600] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346570, txnLastUpdateTimestamp=1602759346600) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,600] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346570, txnLastUpdateTimestamp=1602759346600) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:46,600] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759346570, txnLastUpdateTimestamp=1602759346600) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,600] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=6) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.774,requestQueueTime:0.029,localTime:0.664,remoteTime:0.0,throttleTime:0.025,responseQueueTime:0.021,sendTime:0.059,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,601] DEBUG [TransactionCoordinator id=1001] Initiating connection to node 172.31.31.3:9092 (id: 1001 rack: null) using address /172.31.31.3 (org.apache.kafka.clients.NetworkClient)
[2020-10-15 10:55:46,601] DEBUG [TransactionCoordinator id=1001] Created socket with SO_RCVBUF = 102400, SO_SNDBUF = 1313280, SO_TIMEOUT = 0 to node 1001 (org.apache.kafka.common.network.Selector)
[2020-10-15 10:55:46,601] DEBUG [TransactionCoordinator id=1001] Completed connection to node 1001. Ready. (org.apache.kafka.clients.NetworkClient)
[2020-10-15 10:55:46,601] DEBUG Processor 2 listening to new connection from /172.31.31.3:52940 (kafka.network.Processor)
[2020-10-15 10:55:46,601] DEBUG Accepted connection from /172.31.31.3:52940 on /172.31.31.3:9092 and assigned it to processor 2, sendBufferSize [actual|requested]: [102400|102400] recvBufferSize [actual|requested]: [102400|102400] (kafka.network.Acceptor)
[2020-10-15 10:55:46,602] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:46,602] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=121 segment=[0:9316]) to (offset=122 segment=[0:9394]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,602] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,602] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,602] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,602] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,603] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:46,603] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=121 segment=[0:14013]) to (offset=122 segment=[0:14091]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,603] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,603] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,603] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,603] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=6) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=120,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=122,last_stable_offset=122,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=9240, end=9394)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:32.206,requestQueueTime:0.052,localTime:0.386,remoteTime:31.35,throttleTime:0.189,responseQueueTime:0.022,sendTime:0.204,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,603] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,603] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,603] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 10:55:46,603] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=60) -- {transaction_markers=[{producer_id=0,producer_epoch=3,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.809,requestQueueTime:0.036,localTime:1.686,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.024,sendTime:0.061,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:46,603] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759346603, latencyMs=2, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=60), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@7881e283) from node 1001 with correlation id 60 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 10:55:46,603] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=3, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759346570, txnLastUpdateTimestamp=1602759346600) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 10:55:46,604] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=247 segment=[0:41858]) to (offset=248 segment=[0:41987]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,604] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,604] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,604] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,604] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,604] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759346570, txnLastUpdateTimestamp=1602759346600) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,604] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759346570, txnLastUpdateTimestamp=1602759346600) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:46,604] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,608] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=61 segment=[0:4361]) to (offset=62 segment=[0:4432]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,609] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,609] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,609] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,609] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,609] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,609] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=7) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=61,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=62,last_stable_offset=62,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=71, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=4361, end=4432)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:39.483,requestQueueTime:0.056,localTime:0.196,remoteTime:38.843,throttleTime:0.215,responseQueueTime:0.024,sendTime:0.146,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,609] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=5) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=61,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46098-8;totalTime:1.437,requestQueueTime:0.06,localTime:1.293,remoteTime:0.0,throttleTime:0.06,responseQueueTime:0.024,sendTime:0.059,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,609] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,610] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759346610, txnLastUpdateTimestamp=1602759346610) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,610] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=248 segment=[0:41987]) to (offset=249 segment=[0:42145]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,610] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,610] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,610] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,610] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,610] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759346610, txnLastUpdateTimestamp=1602759346610) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,610] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759346610, txnLastUpdateTimestamp=1602759346610) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:46,610] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=7) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.832,requestQueueTime:0.039,localTime:0.678,remoteTime:0.0,throttleTime:0.027,responseQueueTime:0.022,sendTime:0.092,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,611] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346610, txnLastUpdateTimestamp=1602759346611) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,611] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=122 segment=[0:14091])) (kafka.log.Log)
[2020-10-15 10:55:46,611] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=122 segment=[0:14091]) to (offset=123 segment=[0:14244]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,611] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,611] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,611] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,611] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,611] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=249 segment=[0:42145]) to (offset=250 segment=[0:42339]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,611] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,611] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,611] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,611] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,611] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346610, txnLastUpdateTimestamp=1602759346611) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,611] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346610, txnLastUpdateTimestamp=1602759346611) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:46,612] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=8) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:1.012,requestQueueTime:0.06,localTime:0.867,remoteTime:0.0,throttleTime:0.066,responseQueueTime:0.023,sendTime:0.06,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,612] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=9) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=3,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=62,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:1.744,requestQueueTime:0.06,localTime:0.734,remoteTime:0.0,throttleTime:0.059,responseQueueTime:0.815,sendTime:0.134,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,615] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=62 segment=[0:4432]) to (offset=63 segment=[0:4503]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,615] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,615] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,615] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,615] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,615] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,616] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=8) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=62,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=63,last_stable_offset=63,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=71, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=4432, end=4503)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:6.44,requestQueueTime:0.049,localTime:0.19,remoteTime:5.623,throttleTime:0.202,responseQueueTime:0.209,sendTime:0.164,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,616] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=6) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=62,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46098-8;totalTime:1.264,requestQueueTime:0.064,localTime:0.919,remoteTime:0.0,throttleTime:0.048,responseQueueTime:0.025,sendTime:0.255,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,616] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=122 segment=[0:9394])) (kafka.log.Log)
[2020-10-15 10:55:46,616] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=122 segment=[0:9394]) to (offset=123 segment=[0:9470]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,616] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,616] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,616] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,616] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,616] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=10) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=122,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.94,requestQueueTime:0.065,localTime:0.786,remoteTime:0.0,throttleTime:0.065,responseQueueTime:0.025,sendTime:0.063,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,616] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,617] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346610, txnLastUpdateTimestamp=1602759346617) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,617] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=250 segment=[0:42339]) to (offset=251 segment=[0:42533]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,618] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,618] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,618] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,618] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,618] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346610, txnLastUpdateTimestamp=1602759346617) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,618] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346610, txnLastUpdateTimestamp=1602759346617) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:46,618] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759346610, txnLastUpdateTimestamp=1602759346618) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,618] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=9) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:1.339,requestQueueTime:0.038,localTime:1.216,remoteTime:0.0,throttleTime:0.034,responseQueueTime:0.027,sendTime:0.058,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,619] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:46,619] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=123 segment=[0:9470]) to (offset=124 segment=[0:9548]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,619] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:46,619] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,619] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=10) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=51} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.926,requestQueueTime:0.75,localTime:0.108,remoteTime:0.0,throttleTime:0.02,responseQueueTime:0.018,sendTime:0.048,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,619] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,619] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,619] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,620] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:46,620] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:46,620] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=123 segment=[0:14244]) to (offset=124 segment=[0:14322]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,620] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,620] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,620] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,620] DEBUG [ReplicaManager broker=1001] Produce to local log in 2 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,620] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=7) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=122,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=124,last_stable_offset=124,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=9394, end=9548)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:17.039,requestQueueTime:0.042,localTime:0.155,remoteTime:16.15,throttleTime:0.186,responseQueueTime:0.021,sendTime:0.483,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,620] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=11) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=51}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.473,requestQueueTime:0.108,localTime:0.319,remoteTime:0.0,throttleTime:0.175,responseQueueTime:0.015,sendTime:0.029,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,620] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,620] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 10:55:46,620] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=61) -- {transaction_markers=[{producer_id=0,producer_epoch=3,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:2.068,requestQueueTime:0.038,localTime:1.957,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.03,sendTime:0.041,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:46,621] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759346621, latencyMs=3, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=61), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@109ed872) from node 1001 with correlation id 61 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 10:55:46,621] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=3, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759346610, txnLastUpdateTimestamp=1602759346617) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 10:55:46,622] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=63 segment=[0:4503]) to (offset=64 segment=[0:4574]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,622] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,622] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,622] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,622] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,622] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,622] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=251 segment=[0:42533]) to (offset=252 segment=[0:42662]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,622] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,622] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,622] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,623] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,623] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759346610, txnLastUpdateTimestamp=1602759346618) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,623] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759346610, txnLastUpdateTimestamp=1602759346618) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:46,623] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=9) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=63,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=64,last_stable_offset=64,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=71, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=4503, end=4574)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:6.396,requestQueueTime:0.17,localTime:0.518,remoteTime:4.895,throttleTime:0.133,responseQueueTime:0.022,sendTime:0.655,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,623] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,624] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=7) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=63,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46098-8;totalTime:2.92,requestQueueTime:0.056,localTime:0.807,remoteTime:0.0,throttleTime:0.05,responseQueueTime:1.918,sendTime:0.138,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,624] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,630] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=64 segment=[0:4574]) to (offset=65 segment=[0:4645]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,630] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,631] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,631] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,631] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,631] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,631] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=10) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=64,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=65,last_stable_offset=65,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=71, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=4574, end=4645)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:6.714,requestQueueTime:0.082,localTime:0.659,remoteTime:5.396,throttleTime:0.18,responseQueueTime:0.03,sendTime:0.366,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,631] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,631] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=8) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=64,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46098-8;totalTime:1.779,requestQueueTime:0.093,localTime:1.399,remoteTime:0.0,throttleTime:0.111,responseQueueTime:0.059,sendTime:0.226,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,637] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=65 segment=[0:4645]) to (offset=66 segment=[0:4716]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,637] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,637] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,637] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,637] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,637] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,637] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=11) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=65,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=66,last_stable_offset=66,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=71, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=4645, end=4716)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:5.952,requestQueueTime:0.03,localTime:0.129,remoteTime:5.415,throttleTime:0.127,responseQueueTime:0.012,sendTime:0.237,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,637] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=9) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=65,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46098-8;totalTime:0.967,requestQueueTime:0.036,localTime:0.711,remoteTime:0.0,throttleTime:0.048,responseQueueTime:0.153,sendTime:0.066,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,637] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,640] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759346640, txnLastUpdateTimestamp=1602759346640) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,641] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=252 segment=[0:42662]) to (offset=253 segment=[0:42828]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,641] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,641] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,641] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,641] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,641] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759346640, txnLastUpdateTimestamp=1602759346640) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,641] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759346640, txnLastUpdateTimestamp=1602759346640) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:46,641] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=12) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:1.02,requestQueueTime:0.033,localTime:0.939,remoteTime:0.0,throttleTime:0.072,responseQueueTime:0.017,sendTime:0.031,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,642] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=124 segment=[0:9548])) (kafka.log.Log)
[2020-10-15 10:55:46,642] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=124 segment=[0:9548]) to (offset=125 segment=[0:9624]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,642] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,642] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,642] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,642] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,642] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=11) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=124,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.592,requestQueueTime:0.03,localTime:0.512,remoteTime:0.0,throttleTime:0.045,responseQueueTime:0.014,sendTime:0.035,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,643] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=66 segment=[0:4716]) to (offset=67 segment=[0:4787]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,643] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,643] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,643] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,643] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,643] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,643] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=12) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=66,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=67,last_stable_offset=67,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=71, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=4716, end=4787)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:6.029,requestQueueTime:0.059,localTime:0.095,remoteTime:5.443,throttleTime:0.15,responseQueueTime:0.028,sendTime:0.25,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,643] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,643] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=10) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=66,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46098-8;totalTime:1.118,requestQueueTime:0.033,localTime:0.742,remoteTime:0.0,throttleTime:0.045,responseQueueTime:0.227,sendTime:0.114,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,649] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=67 segment=[0:4787]) to (offset=68 segment=[0:4858]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,649] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,649] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,649] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,649] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,649] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,649] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=13) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=67,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=68,last_stable_offset=68,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=71, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=4787, end=4858)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:6.001,requestQueueTime:0.049,localTime:0.131,remoteTime:5.486,throttleTime:0.193,responseQueueTime:0.023,sendTime:0.117,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,650] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,650] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=11) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=67,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46098-8;totalTime:1.138,requestQueueTime:0.052,localTime:1.03,remoteTime:0.0,throttleTime:0.165,responseQueueTime:0.014,sendTime:0.04,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,655] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=68 segment=[0:4858]) to (offset=69 segment=[0:4929]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,655] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,655] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,655] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,655] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,655] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,656] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=14) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=68,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=69,last_stable_offset=69,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=71, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=4858, end=4929)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:5.969,requestQueueTime:0.033,localTime:0.124,remoteTime:5.585,throttleTime:0.094,responseQueueTime:0.013,sendTime:0.117,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,656] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,656] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=12) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=68,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46098-8;totalTime:0.795,requestQueueTime:0.047,localTime:0.526,remoteTime:0.0,throttleTime:0.028,responseQueueTime:0.096,sendTime:0.125,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,661] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=69 segment=[0:4929]) to (offset=70 segment=[0:5000]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,661] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,662] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,662] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,662] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,662] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,662] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=15) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=69,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=70,last_stable_offset=70,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=71, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=4929, end=5000)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:6.063,requestQueueTime:0.034,localTime:0.12,remoteTime:5.614,throttleTime:0.159,responseQueueTime:0.014,sendTime:0.12,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,662] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=13) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=69,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46098-8;totalTime:1.287,requestQueueTime:0.045,localTime:0.979,remoteTime:0.0,throttleTime:0.047,responseQueueTime:0.16,sendTime:0.102,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,662] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,667] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=70 segment=[0:5000]) to (offset=71 segment=[0:5072]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,668] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,668] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,668] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,668] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,668] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,668] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=16) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=70,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=71,last_stable_offset=71,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=72, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=5000, end=5072)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:5.836,requestQueueTime:0.04,localTime:0.195,remoteTime:5.356,throttleTime:0.122,responseQueueTime:0.013,sendTime:0.109,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,668] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,668] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=14) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=70,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46098-8;totalTime:0.918,requestQueueTime:0.045,localTime:0.743,remoteTime:0.0,throttleTime:0.127,responseQueueTime:0.06,sendTime:0.069,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,674] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=71 segment=[0:5072]) to (offset=72 segment=[0:5144]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,674] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,674] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,674] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,674] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,674] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,674] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=17) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=71,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=72,last_stable_offset=72,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=72, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=5072, end=5144)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:5.965,requestQueueTime:0.086,localTime:0.187,remoteTime:5.454,throttleTime:0.096,responseQueueTime:0.02,sendTime:0.119,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,674] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=15) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=71,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46098-8;totalTime:0.759,requestQueueTime:0.042,localTime:0.54,remoteTime:0.0,throttleTime:0.034,responseQueueTime:0.098,sendTime:0.078,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,674] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,679] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=72 segment=[0:5144]) to (offset=73 segment=[0:5216]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,680] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,680] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,680] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,680] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,680] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,680] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=18) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=72,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=73,last_stable_offset=73,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=72, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=5144, end=5216)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:5.76,requestQueueTime:0.036,localTime:0.288,remoteTime:5.168,throttleTime:0.136,responseQueueTime:0.017,sendTime:0.112,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,680] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=16) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=72,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46098-8;totalTime:0.785,requestQueueTime:0.043,localTime:0.591,remoteTime:0.0,throttleTime:0.032,responseQueueTime:0.074,sendTime:0.075,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,680] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,685] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=73 segment=[0:5216]) to (offset=74 segment=[0:5288]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,686] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,686] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,686] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,686] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,686] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,686] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=19) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=73,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=74,last_stable_offset=74,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=72, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=5216, end=5288)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:6.085,requestQueueTime:0.037,localTime:0.154,remoteTime:5.562,throttleTime:0.145,responseQueueTime:0.056,sendTime:0.127,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,686] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,686] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=17) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=73,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46098-8;totalTime:1.257,requestQueueTime:0.058,localTime:1.129,remoteTime:0.0,throttleTime:0.054,responseQueueTime:0.021,sendTime:0.047,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,692] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=74 segment=[0:5288]) to (offset=75 segment=[0:5360]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,692] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,692] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,692] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,692] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,692] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,692] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=20) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=74,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=75,last_stable_offset=75,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=72, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=5288, end=5360)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:6.111,requestQueueTime:0.043,localTime:0.182,remoteTime:5.627,throttleTime:0.137,responseQueueTime:0.011,sendTime:0.109,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,692] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,692] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=18) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=74,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46098-8;totalTime:0.938,requestQueueTime:0.042,localTime:0.845,remoteTime:0.0,throttleTime:0.128,responseQueueTime:0.013,sendTime:0.037,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,698] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=75 segment=[0:5360]) to (offset=76 segment=[0:5432]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,698] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,698] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,698] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,698] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,698] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,698] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=21) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=75,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=76,last_stable_offset=76,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=72, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=5360, end=5432)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:6.028,requestQueueTime:0.03,localTime:0.126,remoteTime:5.605,throttleTime:0.13,responseQueueTime:0.021,sendTime:0.115,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,699] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=19) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=75,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46098-8;totalTime:0.912,requestQueueTime:0.051,localTime:0.721,remoteTime:0.0,throttleTime:0.038,responseQueueTime:0.06,sendTime:0.078,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,699] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,704] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=76 segment=[0:5432]) to (offset=77 segment=[0:5504]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,704] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,704] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,704] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,704] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,704] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,705] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=22) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=76,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=77,last_stable_offset=77,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=72, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=5432, end=5504)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:5.918,requestQueueTime:0.043,localTime:0.201,remoteTime:5.353,throttleTime:0.184,responseQueueTime:0.021,sendTime:0.115,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,705] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=20) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=76,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46098-8;totalTime:0.936,requestQueueTime:0.041,localTime:0.754,remoteTime:0.0,throttleTime:0.037,responseQueueTime:0.062,sendTime:0.076,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,705] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,710] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=77 segment=[0:5504]) to (offset=78 segment=[0:5576]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,710] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,710] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,710] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,710] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,710] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,711] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=23) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=77,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=78,last_stable_offset=78,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=72, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=5504, end=5576)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:5.959,requestQueueTime:0.04,localTime:0.144,remoteTime:5.448,throttleTime:0.119,responseQueueTime:0.034,sendTime:0.171,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,711] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,711] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=21) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=77,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46098-8;totalTime:1.037,requestQueueTime:0.038,localTime:0.727,remoteTime:0.0,throttleTime:0.041,responseQueueTime:0.16,sendTime:0.111,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,716] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=78 segment=[0:5576]) to (offset=79 segment=[0:5648]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,716] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,717] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,717] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,717] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,717] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,717] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=24) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=78,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=79,last_stable_offset=79,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=72, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=5576, end=5648)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:6.024,requestQueueTime:0.053,localTime:0.185,remoteTime:5.504,throttleTime:0.115,responseQueueTime:0.027,sendTime:0.137,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,717] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=22) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=78,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46098-8;totalTime:1.017,requestQueueTime:0.075,localTime:0.735,remoteTime:0.0,throttleTime:0.036,responseQueueTime:0.122,sendTime:0.083,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,717] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,720] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346640, txnLastUpdateTimestamp=1602759346720) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,721] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=253 segment=[0:42828]) to (offset=254 segment=[0:43022]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,721] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,721] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,721] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,721] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,721] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346640, txnLastUpdateTimestamp=1602759346720) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,721] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346640, txnLastUpdateTimestamp=1602759346720) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:46,721] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=13) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.825,requestQueueTime:0.028,localTime:0.688,remoteTime:0.0,throttleTime:0.026,responseQueueTime:0.019,sendTime:0.088,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,722] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=124 segment=[0:14322])) (kafka.log.Log)
[2020-10-15 10:55:46,722] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=124 segment=[0:14322]) to (offset=125 segment=[0:14475]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,722] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,722] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,722] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,722] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,722] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=12) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=3,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=63,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.819,requestQueueTime:0.043,localTime:0.689,remoteTime:0.0,throttleTime:0.056,responseQueueTime:0.022,sendTime:0.064,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,722] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=79 segment=[0:5648]) to (offset=80 segment=[0:5720]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,722] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346640, txnLastUpdateTimestamp=1602759346722) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,722] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,723] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,723] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,723] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,723] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,723] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=254 segment=[0:43022]) to (offset=255 segment=[0:43216]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,723] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,723] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,723] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,723] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,723] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=25) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=79,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=80,last_stable_offset=80,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=72, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=5648, end=5720)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:6.059,requestQueueTime:0.035,localTime:0.155,remoteTime:5.383,throttleTime:0.104,responseQueueTime:0.153,sendTime:0.226,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,723] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=23) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=79,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46098-8;totalTime:1.005,requestQueueTime:0.072,localTime:0.57,remoteTime:0.0,throttleTime:0.033,responseQueueTime:0.033,sendTime:0.329,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,723] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346640, txnLastUpdateTimestamp=1602759346722) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,723] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,723] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346640, txnLastUpdateTimestamp=1602759346722) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:46,724] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759346640, txnLastUpdateTimestamp=1602759346723) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,724] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=14) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:1.405,requestQueueTime:0.03,localTime:1.282,remoteTime:0.0,throttleTime:0.028,responseQueueTime:0.026,sendTime:0.065,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,725] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:46,725] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=125 segment=[0:9624]) to (offset=126 segment=[0:9702]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,725] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:46,725] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=15) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=51} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.198,requestQueueTime:0.032,localTime:0.092,remoteTime:0.0,throttleTime:0.023,responseQueueTime:0.015,sendTime:0.057,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,726] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:46,726] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,726] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,726] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,726] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,726] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=16) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=51}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.312,requestQueueTime:0.028,localTime:0.217,remoteTime:0.0,throttleTime:0.12,responseQueueTime:0.018,sendTime:0.047,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,726] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=8) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=124,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=126,last_stable_offset=126,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=9548, end=9702)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:105.9,requestQueueTime:0.039,localTime:0.165,remoteTime:105.365,throttleTime:0.171,responseQueueTime:0.02,sendTime:0.137,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,726] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:46,726] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=125 segment=[0:14475]) to (offset=126 segment=[0:14553]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,726] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,726] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,726] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,726] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,726] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,726] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 10:55:46,726] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=62) -- {transaction_markers=[{producer_id=0,producer_epoch=3,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:2.448,requestQueueTime:0.877,localTime:1.493,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.026,sendTime:0.051,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:46,726] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759346726, latencyMs=2, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=62), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@552d4a5c) from node 1001 with correlation id 62 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 10:55:46,727] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=3, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759346640, txnLastUpdateTimestamp=1602759346722) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 10:55:46,727] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=255 segment=[0:43216]) to (offset=256 segment=[0:43345]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,727] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,727] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,727] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,727] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,727] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759346640, txnLastUpdateTimestamp=1602759346723) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,727] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759346640, txnLastUpdateTimestamp=1602759346723) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:46,727] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,746] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759346746, txnLastUpdateTimestamp=1602759346746) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,746] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=256 segment=[0:43345]) to (offset=257 segment=[0:43511]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,746] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,746] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,746] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,746] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,747] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759346746, txnLastUpdateTimestamp=1602759346746) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,747] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759346746, txnLastUpdateTimestamp=1602759346746) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:46,747] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=17) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.768,requestQueueTime:0.034,localTime:0.653,remoteTime:0.0,throttleTime:0.048,responseQueueTime:0.024,sendTime:0.056,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,747] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=126 segment=[0:9702])) (kafka.log.Log)
[2020-10-15 10:55:46,747] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=126 segment=[0:9702]) to (offset=127 segment=[0:9778]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,747] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,747] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,747] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,747] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,747] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=13) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=126,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.541,requestQueueTime:0.046,localTime:0.419,remoteTime:0.0,throttleTime:0.04,responseQueueTime:0.02,sendTime:0.055,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,826] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346746, txnLastUpdateTimestamp=1602759346826) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,826] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=257 segment=[0:43511]) to (offset=258 segment=[0:43705]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,826] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,826] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,826] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,826] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,826] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346746, txnLastUpdateTimestamp=1602759346826) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,827] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346746, txnLastUpdateTimestamp=1602759346826) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:46,827] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=18) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.655,requestQueueTime:0.032,localTime:0.541,remoteTime:0.0,throttleTime:0.021,responseQueueTime:0.018,sendTime:0.063,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,827] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=126 segment=[0:14553])) (kafka.log.Log)
[2020-10-15 10:55:46,827] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=126 segment=[0:14553]) to (offset=127 segment=[0:14706]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,827] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,827] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,827] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,827] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,827] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=14) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=3,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=64,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.673,requestQueueTime:0.042,localTime:0.53,remoteTime:0.0,throttleTime:0.043,responseQueueTime:0.024,sendTime:0.076,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,828] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346746, txnLastUpdateTimestamp=1602759346828) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,828] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=258 segment=[0:43705]) to (offset=259 segment=[0:43899]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,828] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,828] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,828] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,828] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,828] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346746, txnLastUpdateTimestamp=1602759346828) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,828] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346746, txnLastUpdateTimestamp=1602759346828) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:46,828] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759346746, txnLastUpdateTimestamp=1602759346828) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,828] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=19) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.764,requestQueueTime:0.023,localTime:0.594,remoteTime:0.0,throttleTime:0.026,responseQueueTime:0.037,sendTime:0.109,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,829] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:46,829] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=127 segment=[0:9778]) to (offset=128 segment=[0:9856]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,829] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,829] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,829] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,829] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,830] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:46,830] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=127 segment=[0:14706]) to (offset=128 segment=[0:14784]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,830] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,830] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,830] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,830] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,830] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 10:55:46,830] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=9) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=126,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=128,last_stable_offset=128,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=9702, end=9856)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:103.875,requestQueueTime:0.053,localTime:0.204,remoteTime:103.026,throttleTime:0.135,responseQueueTime:0.02,sendTime:0.434,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,830] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:46,830] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759346830, latencyMs=2, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=63), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@199ff954) from node 1001 with correlation id 63 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 10:55:46,830] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,830] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=3, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759346746, txnLastUpdateTimestamp=1602759346828) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 10:55:46,830] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=63) -- {transaction_markers=[{producer_id=0,producer_epoch=3,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.584,requestQueueTime:0.037,localTime:1.277,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.082,sendTime:0.187,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:46,831] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=259 segment=[0:43899]) to (offset=260 segment=[0:44028]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,831] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,831] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,831] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,831] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=20) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=51} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.585,requestQueueTime:0.023,localTime:0.077,remoteTime:0.0,throttleTime:0.02,responseQueueTime:0.416,sendTime:0.067,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,831] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,831] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759346746, txnLastUpdateTimestamp=1602759346828) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,831] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759346746, txnLastUpdateTimestamp=1602759346828) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:46,831] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,831] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759346831, txnLastUpdateTimestamp=1602759346831) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,831] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=260 segment=[0:44028]) to (offset=261 segment=[0:44194]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,831] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,831] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,831] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,831] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,831] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759346831, txnLastUpdateTimestamp=1602759346831) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,831] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759346831, txnLastUpdateTimestamp=1602759346831) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:46,832] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=21) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.946,requestQueueTime:0.185,localTime:0.704,remoteTime:0.0,throttleTime:0.057,responseQueueTime:0.02,sendTime:0.035,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,834] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=128 segment=[0:9856])) (kafka.log.Log)
[2020-10-15 10:55:46,834] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=128 segment=[0:9856]) to (offset=129 segment=[0:9932]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,834] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,834] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,834] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,834] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,834] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=15) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=128,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.681,requestQueueTime:0.07,localTime:0.514,remoteTime:0.0,throttleTime:0.037,responseQueueTime:0.027,sendTime:0.068,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,931] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346831, txnLastUpdateTimestamp=1602759346931) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,931] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=261 segment=[0:44194]) to (offset=262 segment=[0:44388]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,931] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,931] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,931] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,931] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,931] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346831, txnLastUpdateTimestamp=1602759346931) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,931] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346831, txnLastUpdateTimestamp=1602759346931) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:46,932] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=22) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.712,requestQueueTime:0.03,localTime:0.612,remoteTime:0.0,throttleTime:0.023,responseQueueTime:0.022,sendTime:0.047,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,932] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=128 segment=[0:14784])) (kafka.log.Log)
[2020-10-15 10:55:46,932] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=128 segment=[0:14784]) to (offset=129 segment=[0:14937]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,932] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,932] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,932] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,932] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,932] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=16) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=3,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=65,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.695,requestQueueTime:0.043,localTime:0.558,remoteTime:0.0,throttleTime:0.041,responseQueueTime:0.023,sendTime:0.069,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,933] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346831, txnLastUpdateTimestamp=1602759346933) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,933] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=262 segment=[0:44388]) to (offset=263 segment=[0:44582]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,933] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,933] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,933] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,933] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,933] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346831, txnLastUpdateTimestamp=1602759346933) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,933] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346831, txnLastUpdateTimestamp=1602759346933) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:46,933] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759346831, txnLastUpdateTimestamp=1602759346933) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,933] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=23) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.687,requestQueueTime:0.032,localTime:0.58,remoteTime:0.0,throttleTime:0.035,responseQueueTime:0.022,sendTime:0.052,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,934] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:46,934] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=24) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=51} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.212,requestQueueTime:0.039,localTime:0.1,remoteTime:0.0,throttleTime:0.029,responseQueueTime:0.022,sendTime:0.049,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,934] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:46,934] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=129 segment=[0:9932]) to (offset=130 segment=[0:10010]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,934] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:46,934] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,934] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,934] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,934] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:46,934] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=129 segment=[0:14937]) to (offset=130 segment=[0:15015]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,934] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=10) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=128,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=130,last_stable_offset=130,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=9856, end=10010)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:104.272,requestQueueTime:0.057,localTime:0.203,remoteTime:103.709,throttleTime:0.137,responseQueueTime:0.018,sendTime:0.145,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,935] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,935] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:46,935] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,935] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,935] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,935] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:46,935] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 10:55:46,935] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=25) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=51}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.272,requestQueueTime:0.039,localTime:0.158,remoteTime:0.0,throttleTime:0.063,responseQueueTime:0.02,sendTime:0.053,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,935] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759346935, latencyMs=2, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=64), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@6e7d951e) from node 1001 with correlation id 64 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 10:55:46,935] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=64) -- {transaction_markers=[{producer_id=0,producer_epoch=3,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.368,requestQueueTime:0.04,localTime:1.246,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.011,sendTime:0.07,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:46,935] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=3, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759346831, txnLastUpdateTimestamp=1602759346933) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 10:55:46,935] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=263 segment=[0:44582]) to (offset=264 segment=[0:44711]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,935] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,935] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,935] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,935] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,935] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759346831, txnLastUpdateTimestamp=1602759346933) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,935] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759346831, txnLastUpdateTimestamp=1602759346933) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:46,935] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,955] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759346955, txnLastUpdateTimestamp=1602759346955) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,955] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=264 segment=[0:44711]) to (offset=265 segment=[0:44877]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,955] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,955] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,955] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,955] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,955] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759346955, txnLastUpdateTimestamp=1602759346955) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:46,955] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759346955, txnLastUpdateTimestamp=1602759346955) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:46,956] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=26) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.775,requestQueueTime:0.037,localTime:0.633,remoteTime:0.0,throttleTime:0.058,responseQueueTime:0.033,sendTime:0.071,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:46,956] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=130 segment=[0:10010])) (kafka.log.Log)
[2020-10-15 10:55:46,956] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=130 segment=[0:10010]) to (offset=131 segment=[0:10086]) (kafka.cluster.Partition)
[2020-10-15 10:55:46,956] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,956] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,956] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:46,956] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:46,957] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=17) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=130,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.753,requestQueueTime:0.051,localTime:0.609,remoteTime:0.0,throttleTime:0.052,responseQueueTime:0.021,sendTime:0.071,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,035] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346955, txnLastUpdateTimestamp=1602759347035) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,035] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=265 segment=[0:44877]) to (offset=266 segment=[0:45071]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,035] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,035] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,035] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,035] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,035] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346955, txnLastUpdateTimestamp=1602759347035) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,035] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346955, txnLastUpdateTimestamp=1602759347035) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,035] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=27) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.476,requestQueueTime:0.029,localTime:0.335,remoteTime:0.0,throttleTime:0.015,responseQueueTime:0.023,sendTime:0.087,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,036] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=130 segment=[0:15015])) (kafka.log.Log)
[2020-10-15 10:55:47,036] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=130 segment=[0:15015]) to (offset=131 segment=[0:15168]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,036] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,036] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,036] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,036] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,036] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=18) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=3,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=66,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.739,requestQueueTime:0.046,localTime:0.605,remoteTime:0.0,throttleTime:0.059,responseQueueTime:0.027,sendTime:0.059,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,037] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346955, txnLastUpdateTimestamp=1602759347036) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,037] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=266 segment=[0:45071]) to (offset=267 segment=[0:45265]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,037] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,037] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,037] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,037] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,037] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346955, txnLastUpdateTimestamp=1602759347036) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,037] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759346955, txnLastUpdateTimestamp=1602759347036) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,037] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759346955, txnLastUpdateTimestamp=1602759347037) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,037] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=28) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.838,requestQueueTime:0.031,localTime:0.752,remoteTime:0.0,throttleTime:0.026,responseQueueTime:0.016,sendTime:0.038,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,038] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:47,038] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=29) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=51} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.244,requestQueueTime:0.028,localTime:0.078,remoteTime:0.0,throttleTime:0.021,responseQueueTime:0.034,sendTime:0.101,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,038] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:47,038] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=131 segment=[0:10086]) to (offset=132 segment=[0:10164]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,038] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:47,038] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,038] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,038] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,039] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:47,039] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:47,039] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=131 segment=[0:15168]) to (offset=132 segment=[0:15246]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,039] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,039] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,039] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,039] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,039] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 10:55:47,039] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=11) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=130,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=132,last_stable_offset=132,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=10010, end=10164)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:104.26,requestQueueTime:0.043,localTime:0.148,remoteTime:103.542,throttleTime:0.147,responseQueueTime:0.022,sendTime:0.355,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,039] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=30) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=51}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.414,requestQueueTime:0.066,localTime:0.148,remoteTime:0.0,throttleTime:0.053,responseQueueTime:0.018,sendTime:0.18,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,039] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=65) -- {transaction_markers=[{producer_id=0,producer_epoch=3,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.431,requestQueueTime:0.071,localTime:1.294,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.023,sendTime:0.041,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:47,039] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759347039, latencyMs=2, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=65), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@8c68deb) from node 1001 with correlation id 65 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 10:55:47,039] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=3, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759346955, txnLastUpdateTimestamp=1602759347036) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 10:55:47,040] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=267 segment=[0:45265]) to (offset=268 segment=[0:45394]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,040] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,040] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,040] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,040] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,040] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759346955, txnLastUpdateTimestamp=1602759347037) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,040] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759346955, txnLastUpdateTimestamp=1602759347037) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,040] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,040] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:47,059] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347059, txnLastUpdateTimestamp=1602759347059) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,059] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=268 segment=[0:45394]) to (offset=269 segment=[0:45560]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,059] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,059] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,059] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,060] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,060] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347059, txnLastUpdateTimestamp=1602759347059) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,060] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347059, txnLastUpdateTimestamp=1602759347059) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,060] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=31) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.829,requestQueueTime:0.036,localTime:0.715,remoteTime:0.0,throttleTime:0.075,responseQueueTime:0.02,sendTime:0.057,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,060] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=132 segment=[0:10164])) (kafka.log.Log)
[2020-10-15 10:55:47,060] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=132 segment=[0:10164]) to (offset=133 segment=[0:10240]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,060] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,060] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,060] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,060] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,061] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=19) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=132,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.657,requestQueueTime:0.053,localTime:0.526,remoteTime:0.0,throttleTime:0.046,responseQueueTime:0.023,sendTime:0.053,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,138] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347059, txnLastUpdateTimestamp=1602759347138) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,138] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=269 segment=[0:45560]) to (offset=270 segment=[0:45754]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,138] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,138] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,138] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,138] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,138] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347059, txnLastUpdateTimestamp=1602759347138) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,139] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347059, txnLastUpdateTimestamp=1602759347138) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,139] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=32) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.67,requestQueueTime:0.038,localTime:0.551,remoteTime:0.0,throttleTime:0.024,responseQueueTime:0.02,sendTime:0.06,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,139] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=132 segment=[0:15246])) (kafka.log.Log)
[2020-10-15 10:55:47,139] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=132 segment=[0:15246]) to (offset=133 segment=[0:15399]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,139] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,139] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,139] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,139] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,140] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=20) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=3,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=67,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.819,requestQueueTime:0.043,localTime:0.696,remoteTime:0.0,throttleTime:0.052,responseQueueTime:0.025,sendTime:0.053,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,140] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347059, txnLastUpdateTimestamp=1602759347140) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,140] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=270 segment=[0:45754]) to (offset=271 segment=[0:45948]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,140] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,140] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,140] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,140] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,140] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347059, txnLastUpdateTimestamp=1602759347140) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,140] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347059, txnLastUpdateTimestamp=1602759347140) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,140] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347059, txnLastUpdateTimestamp=1602759347140) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,140] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=33) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.638,requestQueueTime:0.026,localTime:0.538,remoteTime:0.0,throttleTime:0.024,responseQueueTime:0.02,sendTime:0.053,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,141] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:47,141] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=34) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=51} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.238,requestQueueTime:0.035,localTime:0.072,remoteTime:0.0,throttleTime:0.018,responseQueueTime:0.074,sendTime:0.056,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,141] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:47,141] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=133 segment=[0:10240]) to (offset=134 segment=[0:10318]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,142] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:47,142] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,142] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,142] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,142] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:47,142] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:47,142] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=133 segment=[0:15399]) to (offset=134 segment=[0:15477]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,142] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,142] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,142] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,142] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,142] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=35) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=51}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.241,requestQueueTime:0.03,localTime:0.135,remoteTime:0.0,throttleTime:0.05,responseQueueTime:0.019,sendTime:0.056,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,142] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 10:55:47,142] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=12) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=132,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=134,last_stable_offset=134,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=10164, end=10318)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:103.102,requestQueueTime:0.044,localTime:0.914,remoteTime:101.58,throttleTime:0.131,responseQueueTime:0.047,sendTime:0.384,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,142] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759347142, latencyMs=1, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=66), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@37864905) from node 1001 with correlation id 66 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 10:55:47,142] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:47,142] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=66) -- {transaction_markers=[{producer_id=0,producer_epoch=3,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.441,requestQueueTime:0.035,localTime:1.217,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.054,sendTime:0.133,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:47,142] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=3, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759347059, txnLastUpdateTimestamp=1602759347140) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 10:55:47,143] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=271 segment=[0:45948]) to (offset=272 segment=[0:46077]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,143] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,143] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,143] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,143] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,143] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347059, txnLastUpdateTimestamp=1602759347140) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,143] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347059, txnLastUpdateTimestamp=1602759347140) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,143] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,162] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347162, txnLastUpdateTimestamp=1602759347162) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,163] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=272 segment=[0:46077]) to (offset=273 segment=[0:46243]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,163] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,163] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,163] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,163] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,163] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347162, txnLastUpdateTimestamp=1602759347162) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,163] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347162, txnLastUpdateTimestamp=1602759347162) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,163] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=36) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.751,requestQueueTime:0.049,localTime:0.634,remoteTime:0.0,throttleTime:0.052,responseQueueTime:0.015,sendTime:0.051,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,163] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=134 segment=[0:10318])) (kafka.log.Log)
[2020-10-15 10:55:47,163] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=134 segment=[0:10318]) to (offset=135 segment=[0:10394]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,163] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,163] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,163] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,163] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,163] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=21) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=134,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.471,requestQueueTime:0.051,localTime:0.349,remoteTime:0.0,throttleTime:0.028,responseQueueTime:0.014,sendTime:0.056,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,224] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:47,225] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=26) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=80,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=80,last_stable_offset=80,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=MemoryRecords(size=0, buffer=java.nio.HeapByteBuffer[pos=0 lim=0 cap=0])}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:501.338,requestQueueTime:0.046,localTime:0.246,remoteTime:500.717,throttleTime:0.164,responseQueueTime:0.031,sendTime:0.132,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,225] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:47,242] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347162, txnLastUpdateTimestamp=1602759347242) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,243] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=273 segment=[0:46243]) to (offset=274 segment=[0:46437]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,243] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,243] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,243] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,243] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,243] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347162, txnLastUpdateTimestamp=1602759347242) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,243] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347162, txnLastUpdateTimestamp=1602759347242) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,243] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=37) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.841,requestQueueTime:0.031,localTime:0.719,remoteTime:0.0,throttleTime:0.03,responseQueueTime:0.027,sendTime:0.063,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,244] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=134 segment=[0:15477])) (kafka.log.Log)
[2020-10-15 10:55:47,244] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=134 segment=[0:15477]) to (offset=135 segment=[0:15630]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,244] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,244] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,244] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,244] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,244] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=22) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=3,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=68,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.795,requestQueueTime:0.047,localTime:0.666,remoteTime:0.0,throttleTime:0.052,responseQueueTime:0.022,sendTime:0.059,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,244] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347162, txnLastUpdateTimestamp=1602759347244) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,244] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=274 segment=[0:46437]) to (offset=275 segment=[0:46631]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,244] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,244] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,244] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,244] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,245] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347162, txnLastUpdateTimestamp=1602759347244) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,245] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347162, txnLastUpdateTimestamp=1602759347244) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,245] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347162, txnLastUpdateTimestamp=1602759347245) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,245] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=38) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.648,requestQueueTime:0.033,localTime:0.537,remoteTime:0.0,throttleTime:0.023,responseQueueTime:0.023,sendTime:0.054,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,245] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:47,245] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=39) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=51} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.329,requestQueueTime:0.026,localTime:0.11,remoteTime:0.0,throttleTime:0.027,responseQueueTime:0.059,sendTime:0.132,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,245] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:47,245] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=135 segment=[0:10394]) to (offset=136 segment=[0:10472]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,246] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:47,246] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,246] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,246] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,246] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:47,246] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=135 segment=[0:15630]) to (offset=136 segment=[0:15708]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,246] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=13) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=134,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=136,last_stable_offset=136,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=10318, end=10472)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:103.742,requestQueueTime:0.05,localTime:0.19,remoteTime:103.196,throttleTime:0.143,responseQueueTime:0.02,sendTime:0.139,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,246] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,246] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,246] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,246] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:47,246] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,246] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:47,246] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 10:55:47,246] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=40) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=51}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.312,requestQueueTime:0.074,localTime:0.164,remoteTime:0.0,throttleTime:0.056,responseQueueTime:0.021,sendTime:0.052,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,247] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=67) -- {transaction_markers=[{producer_id=0,producer_epoch=3,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.404,requestQueueTime:0.044,localTime:1.288,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.02,sendTime:0.052,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:47,247] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759347246, latencyMs=1, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=67), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@513553f8) from node 1001 with correlation id 67 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 10:55:47,247] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=3, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759347162, txnLastUpdateTimestamp=1602759347244) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 10:55:47,247] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=275 segment=[0:46631]) to (offset=276 segment=[0:46760]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,247] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,247] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,247] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,247] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,247] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347162, txnLastUpdateTimestamp=1602759347245) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,247] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347162, txnLastUpdateTimestamp=1602759347245) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,247] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,267] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347267, txnLastUpdateTimestamp=1602759347267) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,267] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=276 segment=[0:46760]) to (offset=277 segment=[0:46926]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,267] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,267] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,267] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,267] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,267] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347267, txnLastUpdateTimestamp=1602759347267) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,267] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347267, txnLastUpdateTimestamp=1602759347267) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,268] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=41) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:1.017,requestQueueTime:0.032,localTime:0.887,remoteTime:0.0,throttleTime:0.055,responseQueueTime:0.04,sendTime:0.056,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,268] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=136 segment=[0:10472])) (kafka.log.Log)
[2020-10-15 10:55:47,268] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=136 segment=[0:10472]) to (offset=137 segment=[0:10548]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,268] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,268] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,268] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,268] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,268] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=23) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=136,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.692,requestQueueTime:0.051,localTime:0.571,remoteTime:0.0,throttleTime:0.053,responseQueueTime:0.019,sendTime:0.05,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,346] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347267, txnLastUpdateTimestamp=1602759347346) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,346] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=277 segment=[0:46926]) to (offset=278 segment=[0:47120]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,346] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,346] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,346] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,346] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,346] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347267, txnLastUpdateTimestamp=1602759347346) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,347] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347267, txnLastUpdateTimestamp=1602759347346) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,347] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=42) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:1.045,requestQueueTime:0.036,localTime:0.83,remoteTime:0.0,throttleTime:0.026,responseQueueTime:0.023,sendTime:0.155,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,347] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=136 segment=[0:15708])) (kafka.log.Log)
[2020-10-15 10:55:47,347] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=136 segment=[0:15708]) to (offset=137 segment=[0:15861]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,347] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,347] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,347] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,347] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,348] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=24) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=3,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=69,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.785,requestQueueTime:0.042,localTime:0.672,remoteTime:0.0,throttleTime:0.043,responseQueueTime:0.02,sendTime:0.05,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,348] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347267, txnLastUpdateTimestamp=1602759347348) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,348] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=278 segment=[0:47120]) to (offset=279 segment=[0:47314]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,348] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,348] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,348] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,348] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,349] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347267, txnLastUpdateTimestamp=1602759347348) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,349] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347267, txnLastUpdateTimestamp=1602759347348) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,349] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347267, txnLastUpdateTimestamp=1602759347349) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,349] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=43) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.858,requestQueueTime:0.029,localTime:0.763,remoteTime:0.0,throttleTime:0.033,responseQueueTime:0.019,sendTime:0.045,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,349] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:47,349] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=44) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=51} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.276,requestQueueTime:0.027,localTime:0.099,remoteTime:0.0,throttleTime:0.034,responseQueueTime:0.022,sendTime:0.127,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,349] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:47,349] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=137 segment=[0:10548]) to (offset=138 segment=[0:10626]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,350] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:47,350] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,350] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,350] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,350] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:47,350] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=137 segment=[0:15861]) to (offset=138 segment=[0:15939]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,350] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,350] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,350] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,350] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,350] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=14) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=136,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=138,last_stable_offset=138,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=10472, end=10626)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:103.749,requestQueueTime:0.084,localTime:0.157,remoteTime:103.227,throttleTime:0.125,responseQueueTime:0.019,sendTime:0.136,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,350] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 10:55:47,350] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:47,350] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:47,350] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=68) -- {transaction_markers=[{producer_id=0,producer_epoch=3,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.192,requestQueueTime:0.038,localTime:1.044,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.027,sendTime:0.082,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:47,350] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759347350, latencyMs=1, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=68), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@5362e9a5) from node 1001 with correlation id 68 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 10:55:47,350] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=45) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=51}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.358,requestQueueTime:0.041,localTime:0.234,remoteTime:0.0,throttleTime:0.056,responseQueueTime:0.03,sendTime:0.053,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,350] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=3, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759347267, txnLastUpdateTimestamp=1602759347348) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 10:55:47,351] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=279 segment=[0:47314]) to (offset=280 segment=[0:47443]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,351] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,351] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,351] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,351] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,351] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347267, txnLastUpdateTimestamp=1602759347349) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,351] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347267, txnLastUpdateTimestamp=1602759347349) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,351] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,371] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347371, txnLastUpdateTimestamp=1602759347371) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,371] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=280 segment=[0:47443]) to (offset=281 segment=[0:47609]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,371] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,371] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,371] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,371] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,371] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347371, txnLastUpdateTimestamp=1602759347371) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,371] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347371, txnLastUpdateTimestamp=1602759347371) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,371] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=46) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.711,requestQueueTime:0.033,localTime:0.589,remoteTime:0.0,throttleTime:0.047,responseQueueTime:0.021,sendTime:0.067,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,372] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=138 segment=[0:10626])) (kafka.log.Log)
[2020-10-15 10:55:47,372] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=138 segment=[0:10626]) to (offset=139 segment=[0:10702]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,372] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,372] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,372] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,372] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,372] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=25) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=138,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.752,requestQueueTime:0.054,localTime:0.627,remoteTime:0.0,throttleTime:0.051,responseQueueTime:0.014,sendTime:0.055,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,450] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347371, txnLastUpdateTimestamp=1602759347450) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,451] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=281 segment=[0:47609]) to (offset=282 segment=[0:47803]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,451] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,451] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,451] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,451] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,451] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347371, txnLastUpdateTimestamp=1602759347450) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,451] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347371, txnLastUpdateTimestamp=1602759347450) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,451] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=47) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.599,requestQueueTime:0.03,localTime:0.49,remoteTime:0.0,throttleTime:0.024,responseQueueTime:0.023,sendTime:0.054,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,452] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=138 segment=[0:15939])) (kafka.log.Log)
[2020-10-15 10:55:47,452] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=138 segment=[0:15939]) to (offset=139 segment=[0:16092]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,452] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,452] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,452] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,452] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,452] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=26) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=3,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=70,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.811,requestQueueTime:0.05,localTime:0.68,remoteTime:0.0,throttleTime:0.055,responseQueueTime:0.025,sendTime:0.054,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,452] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347371, txnLastUpdateTimestamp=1602759347452) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,452] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=282 segment=[0:47803]) to (offset=283 segment=[0:47997]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,453] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,453] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,453] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,453] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,453] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347371, txnLastUpdateTimestamp=1602759347452) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,453] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347371, txnLastUpdateTimestamp=1602759347452) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,453] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347371, txnLastUpdateTimestamp=1602759347453) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,453] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=48) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.682,requestQueueTime:0.039,localTime:0.57,remoteTime:0.0,throttleTime:0.027,responseQueueTime:0.02,sendTime:0.052,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,453] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:47,453] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=49) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=51} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.249,requestQueueTime:0.028,localTime:0.066,remoteTime:0.0,throttleTime:0.016,responseQueueTime:0.014,sendTime:0.14,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,454] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:47,454] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=50) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=51}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.251,requestQueueTime:0.026,localTime:0.148,remoteTime:0.0,throttleTime:0.052,responseQueueTime:0.02,sendTime:0.056,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,454] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:47,454] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=139 segment=[0:10702]) to (offset=140 segment=[0:10780]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,455] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:47,455] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,455] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,455] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,455] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:47,455] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=139 segment=[0:16092]) to (offset=140 segment=[0:16170]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,455] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=15) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=138,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=140,last_stable_offset=140,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=10626, end=10780)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:104.886,requestQueueTime:0.04,localTime:0.21,remoteTime:104.296,throttleTime:0.148,responseQueueTime:0.02,sendTime:0.17,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,455] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,455] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,455] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,455] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,455] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 10:55:47,455] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:47,455] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=69) -- {transaction_markers=[{producer_id=0,producer_epoch=3,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.432,requestQueueTime:0.04,localTime:1.317,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.02,sendTime:0.054,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:47,455] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759347455, latencyMs=2, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=69), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@6f778ff7) from node 1001 with correlation id 69 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 10:55:47,456] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=3, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759347371, txnLastUpdateTimestamp=1602759347452) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 10:55:47,456] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=283 segment=[0:47997]) to (offset=284 segment=[0:48126]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,456] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,456] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,456] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,456] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,456] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347371, txnLastUpdateTimestamp=1602759347453) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,456] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347371, txnLastUpdateTimestamp=1602759347453) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,456] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,475] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347475, txnLastUpdateTimestamp=1602759347475) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,475] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=284 segment=[0:48126]) to (offset=285 segment=[0:48292]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,475] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,475] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,475] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,475] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,475] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347475, txnLastUpdateTimestamp=1602759347475) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,475] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347475, txnLastUpdateTimestamp=1602759347475) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,475] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=51) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.656,requestQueueTime:0.034,localTime:0.537,remoteTime:0.0,throttleTime:0.048,responseQueueTime:0.025,sendTime:0.059,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,476] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=140 segment=[0:10780])) (kafka.log.Log)
[2020-10-15 10:55:47,476] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=140 segment=[0:10780]) to (offset=141 segment=[0:10856]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,476] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,476] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,476] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,476] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,476] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=27) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=140,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.598,requestQueueTime:0.048,localTime:0.488,remoteTime:0.0,throttleTime:0.044,responseQueueTime:0.015,sendTime:0.046,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,554] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347475, txnLastUpdateTimestamp=1602759347554) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,555] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=285 segment=[0:48292]) to (offset=286 segment=[0:48486]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,555] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,555] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,555] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,555] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,555] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347475, txnLastUpdateTimestamp=1602759347554) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,555] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347475, txnLastUpdateTimestamp=1602759347554) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,555] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=52) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.612,requestQueueTime:0.029,localTime:0.505,remoteTime:0.0,throttleTime:0.024,responseQueueTime:0.02,sendTime:0.057,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,556] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=140 segment=[0:16170])) (kafka.log.Log)
[2020-10-15 10:55:47,556] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=140 segment=[0:16170]) to (offset=141 segment=[0:16323]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,556] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,556] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,556] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,556] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,556] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=28) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=3,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=71,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.876,requestQueueTime:0.04,localTime:0.758,remoteTime:0.0,throttleTime:0.069,responseQueueTime:0.023,sendTime:0.053,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,556] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347475, txnLastUpdateTimestamp=1602759347556) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,557] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=286 segment=[0:48486]) to (offset=287 segment=[0:48680]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,557] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,557] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,557] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,557] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,557] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347475, txnLastUpdateTimestamp=1602759347556) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,557] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347475, txnLastUpdateTimestamp=1602759347556) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,557] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347475, txnLastUpdateTimestamp=1602759347557) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,557] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=53) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.696,requestQueueTime:0.039,localTime:0.596,remoteTime:0.0,throttleTime:0.028,responseQueueTime:0.016,sendTime:0.044,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,558] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:47,558] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=54) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=51} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:1.101,requestQueueTime:0.864,localTime:0.074,remoteTime:0.0,throttleTime:0.019,responseQueueTime:0.058,sendTime:0.103,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,558] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:47,558] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=141 segment=[0:10856]) to (offset=142 segment=[0:10934]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,558] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:47,559] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=55) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=51}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.288,requestQueueTime:0.042,localTime:0.16,remoteTime:0.0,throttleTime:0.057,responseQueueTime:0.02,sendTime:0.065,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,559] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:47,559] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,559] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,559] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,559] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:47,559] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=16) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=140,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=142,last_stable_offset=142,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=10780, end=10934)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:103.944,requestQueueTime:0.248,localTime:0.153,remoteTime:103.221,throttleTime:0.141,responseQueueTime:0.02,sendTime:0.158,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,559] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=141 segment=[0:16323]) to (offset=142 segment=[0:16401]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,559] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,559] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,559] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,559] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,559] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:47,559] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 10:55:47,559] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=70) -- {transaction_markers=[{producer_id=0,producer_epoch=3,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:2.28,requestQueueTime:0.907,localTime:1.296,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.02,sendTime:0.055,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:47,560] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759347559, latencyMs=2, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=70), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@6a3c2d7d) from node 1001 with correlation id 70 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 10:55:47,560] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=3, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759347475, txnLastUpdateTimestamp=1602759347556) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 10:55:47,560] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=287 segment=[0:48680]) to (offset=288 segment=[0:48809]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,560] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,560] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,560] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,560] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,560] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347475, txnLastUpdateTimestamp=1602759347557) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,560] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347475, txnLastUpdateTimestamp=1602759347557) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,560] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,579] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347579, txnLastUpdateTimestamp=1602759347579) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,579] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=288 segment=[0:48809]) to (offset=289 segment=[0:48975]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,579] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,579] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,579] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,579] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,579] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347579, txnLastUpdateTimestamp=1602759347579) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,579] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347579, txnLastUpdateTimestamp=1602759347579) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,580] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=56) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.822,requestQueueTime:0.037,localTime:0.705,remoteTime:0.0,throttleTime:0.05,responseQueueTime:0.02,sendTime:0.058,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,580] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=142 segment=[0:10934])) (kafka.log.Log)
[2020-10-15 10:55:47,580] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=142 segment=[0:10934]) to (offset=143 segment=[0:11010]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,580] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,580] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,580] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,580] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,580] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=29) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=142,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.643,requestQueueTime:0.047,localTime:0.524,remoteTime:0.0,throttleTime:0.049,responseQueueTime:0.02,sendTime:0.052,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,659] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347579, txnLastUpdateTimestamp=1602759347659) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,659] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=289 segment=[0:48975]) to (offset=290 segment=[0:49169]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,659] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,659] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,659] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,659] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,659] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347579, txnLastUpdateTimestamp=1602759347659) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,659] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347579, txnLastUpdateTimestamp=1602759347659) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,660] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=57) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.713,requestQueueTime:0.034,localTime:0.6,remoteTime:0.0,throttleTime:0.029,responseQueueTime:0.021,sendTime:0.057,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,660] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=142 segment=[0:16401])) (kafka.log.Log)
[2020-10-15 10:55:47,660] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=142 segment=[0:16401]) to (offset=143 segment=[0:16554]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,660] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,660] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,660] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,660] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,660] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=30) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=3,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=72,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.779,requestQueueTime:0.039,localTime:0.662,remoteTime:0.0,throttleTime:0.051,responseQueueTime:0.024,sendTime:0.052,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,661] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347579, txnLastUpdateTimestamp=1602759347661) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,661] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=290 segment=[0:49169]) to (offset=291 segment=[0:49363]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,661] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,661] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,661] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,661] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,661] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347579, txnLastUpdateTimestamp=1602759347661) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,661] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347579, txnLastUpdateTimestamp=1602759347661) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,661] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347579, txnLastUpdateTimestamp=1602759347661) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,661] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=58) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.63,requestQueueTime:0.028,localTime:0.525,remoteTime:0.0,throttleTime:0.025,responseQueueTime:0.019,sendTime:0.056,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,662] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:47,662] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=143 segment=[0:11010]) to (offset=144 segment=[0:11088]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,662] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:47,662] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=59) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=51} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.53,requestQueueTime:0.036,localTime:0.423,remoteTime:0.0,throttleTime:0.025,responseQueueTime:0.019,sendTime:0.05,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,662] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:47,663] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:47,663] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,663] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,663] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,663] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=17) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=142,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=144,last_stable_offset=144,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=10934, end=11088)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:103.678,requestQueueTime:0.042,localTime:0.186,remoteTime:102.987,throttleTime:0.221,responseQueueTime:0.021,sendTime:0.22,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,663] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=60) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=51}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.414,requestQueueTime:0.032,localTime:0.156,remoteTime:0.0,throttleTime:0.063,responseQueueTime:0.059,sendTime:0.166,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,663] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:47,663] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=143 segment=[0:16554]) to (offset=144 segment=[0:16632]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,663] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,663] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,663] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,663] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,663] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:47,663] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 10:55:47,663] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=71) -- {transaction_markers=[{producer_id=0,producer_epoch=3,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.74,requestQueueTime:0.028,localTime:1.619,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.051,sendTime:0.041,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:47,663] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759347663, latencyMs=2, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=71), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@116d0951) from node 1001 with correlation id 71 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 10:55:47,664] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=3, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759347579, txnLastUpdateTimestamp=1602759347661) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 10:55:47,664] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=291 segment=[0:49363]) to (offset=292 segment=[0:49492]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,664] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,664] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,664] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,664] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,664] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347579, txnLastUpdateTimestamp=1602759347661) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,664] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347579, txnLastUpdateTimestamp=1602759347661) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,664] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,683] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347683, txnLastUpdateTimestamp=1602759347683) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,683] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=292 segment=[0:49492]) to (offset=293 segment=[0:49658]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,683] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,683] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,683] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,683] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,683] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347683, txnLastUpdateTimestamp=1602759347683) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,683] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347683, txnLastUpdateTimestamp=1602759347683) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,684] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=61) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.633,requestQueueTime:0.034,localTime:0.522,remoteTime:0.0,throttleTime:0.047,responseQueueTime:0.019,sendTime:0.056,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,684] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=144 segment=[0:11088])) (kafka.log.Log)
[2020-10-15 10:55:47,684] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=144 segment=[0:11088]) to (offset=145 segment=[0:11164]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,684] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,684] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,684] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,684] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,684] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=31) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=144,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.74,requestQueueTime:0.049,localTime:0.629,remoteTime:0.0,throttleTime:0.055,responseQueueTime:0.015,sendTime:0.045,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,725] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:47,725] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=27) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=80,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=80,last_stable_offset=80,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=MemoryRecords(size=0, buffer=java.nio.HeapByteBuffer[pos=0 lim=0 cap=0])}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:500.305,requestQueueTime:0.06,localTime:0.205,remoteTime:499.571,throttleTime:0.252,responseQueueTime:0.038,sendTime:0.177,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,725] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:47,763] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347683, txnLastUpdateTimestamp=1602759347763) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,764] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=293 segment=[0:49658]) to (offset=294 segment=[0:49852]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,764] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,764] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,764] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,764] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,764] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347683, txnLastUpdateTimestamp=1602759347763) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,764] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347683, txnLastUpdateTimestamp=1602759347763) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,764] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=62) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:1.388,requestQueueTime:0.065,localTime:1.021,remoteTime:0.0,throttleTime:0.04,responseQueueTime:0.024,sendTime:0.276,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,765] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=144 segment=[0:16632])) (kafka.log.Log)
[2020-10-15 10:55:47,765] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=144 segment=[0:16632]) to (offset=145 segment=[0:16785]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,765] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,765] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,765] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,765] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,765] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=32) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=3,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=73,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.935,requestQueueTime:0.084,localTime:0.719,remoteTime:0.0,throttleTime:0.057,responseQueueTime:0.024,sendTime:0.107,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,766] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347683, txnLastUpdateTimestamp=1602759347766) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,766] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=294 segment=[0:49852]) to (offset=295 segment=[0:50046]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,766] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,766] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,766] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,766] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,766] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347683, txnLastUpdateTimestamp=1602759347766) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,766] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347683, txnLastUpdateTimestamp=1602759347766) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,766] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347683, txnLastUpdateTimestamp=1602759347766) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,766] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=63) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.645,requestQueueTime:0.027,localTime:0.537,remoteTime:0.0,throttleTime:0.024,responseQueueTime:0.025,sendTime:0.055,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,767] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:47,767] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=64) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=51} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.261,requestQueueTime:0.035,localTime:0.143,remoteTime:0.0,throttleTime:0.039,responseQueueTime:0.023,sendTime:0.058,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,767] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:47,767] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=145 segment=[0:11164]) to (offset=146 segment=[0:11242]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,768] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:47,768] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=65) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=51}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.28,requestQueueTime:0.032,localTime:0.173,remoteTime:0.0,throttleTime:0.067,responseQueueTime:0.023,sendTime:0.05,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,768] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:47,768] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,768] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,768] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,768] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:47,768] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=145 segment=[0:16785]) to (offset=146 segment=[0:16863]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,768] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,768] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,768] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,768] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,769] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 10:55:47,769] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=72) -- {transaction_markers=[{producer_id=0,producer_epoch=3,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.92,requestQueueTime:0.036,localTime:1.708,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.019,sendTime:0.155,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:47,769] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=18) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=144,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=146,last_stable_offset=146,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=11088, end=11242)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:105.855,requestQueueTime:0.051,localTime:0.23,remoteTime:104.401,throttleTime:0.465,responseQueueTime:0.494,sendTime:0.212,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,769] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759347769, latencyMs=3, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=72), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@5586e518) from node 1001 with correlation id 72 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 10:55:47,769] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:47,769] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=3, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759347683, txnLastUpdateTimestamp=1602759347766) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 10:55:47,770] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=295 segment=[0:50046]) to (offset=296 segment=[0:50175]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,770] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,770] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,770] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,770] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,770] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347683, txnLastUpdateTimestamp=1602759347766) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,770] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347683, txnLastUpdateTimestamp=1602759347766) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,770] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,788] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347788, txnLastUpdateTimestamp=1602759347788) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,788] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=296 segment=[0:50175]) to (offset=297 segment=[0:50341]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,788] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,788] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,788] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,789] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,789] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347788, txnLastUpdateTimestamp=1602759347788) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,789] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347788, txnLastUpdateTimestamp=1602759347788) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,789] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=66) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.805,requestQueueTime:0.04,localTime:0.683,remoteTime:0.0,throttleTime:0.065,responseQueueTime:0.022,sendTime:0.059,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,789] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=146 segment=[0:11242])) (kafka.log.Log)
[2020-10-15 10:55:47,789] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=146 segment=[0:11242]) to (offset=147 segment=[0:11318]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,789] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,789] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,789] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,789] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,790] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=33) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=146,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.804,requestQueueTime:0.092,localTime:0.628,remoteTime:0.0,throttleTime:0.057,responseQueueTime:0.023,sendTime:0.059,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,868] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347788, txnLastUpdateTimestamp=1602759347868) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,868] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=297 segment=[0:50341]) to (offset=298 segment=[0:50535]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,868] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,868] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,868] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,868] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,869] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347788, txnLastUpdateTimestamp=1602759347868) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,869] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347788, txnLastUpdateTimestamp=1602759347868) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,869] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=67) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.692,requestQueueTime:0.03,localTime:0.58,remoteTime:0.0,throttleTime:0.024,responseQueueTime:0.018,sendTime:0.062,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,869] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=146 segment=[0:16863])) (kafka.log.Log)
[2020-10-15 10:55:47,869] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=146 segment=[0:16863]) to (offset=147 segment=[0:17016]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,869] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,869] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,869] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,869] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,870] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=34) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=3,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=74,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.805,requestQueueTime:0.045,localTime:0.68,remoteTime:0.0,throttleTime:0.053,responseQueueTime:0.02,sendTime:0.058,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,870] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347788, txnLastUpdateTimestamp=1602759347870) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,870] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=298 segment=[0:50535]) to (offset=299 segment=[0:50729]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,870] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,870] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,870] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,870] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,870] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347788, txnLastUpdateTimestamp=1602759347870) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,870] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347788, txnLastUpdateTimestamp=1602759347870) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,870] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347788, txnLastUpdateTimestamp=1602759347870) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,871] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=68) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.687,requestQueueTime:0.027,localTime:0.575,remoteTime:0.0,throttleTime:0.028,responseQueueTime:0.031,sendTime:0.053,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,871] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:47,871] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:47,871] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=147 segment=[0:11318]) to (offset=148 segment=[0:11396]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,871] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=69) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=51} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.401,requestQueueTime:0.031,localTime:0.085,remoteTime:0.0,throttleTime:0.022,responseQueueTime:0.209,sendTime:0.074,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,872] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:47,872] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,872] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,872] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,872] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:47,872] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=19) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=146,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=148,last_stable_offset=148,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=11242, end=11396)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:102.936,requestQueueTime:0.041,localTime:0.172,remoteTime:102.348,throttleTime:0.21,responseQueueTime:0.024,sendTime:0.139,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,872] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:47,872] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:47,872] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=147 segment=[0:17016]) to (offset=148 segment=[0:17094]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,872] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,872] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,872] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,872] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,872] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=70) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=51}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.483,requestQueueTime:0.044,localTime:0.328,remoteTime:0.0,throttleTime:0.157,responseQueueTime:0.052,sendTime:0.057,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,872] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 10:55:47,873] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=73) -- {transaction_markers=[{producer_id=0,producer_epoch=3,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.757,requestQueueTime:0.031,localTime:1.624,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.044,sendTime:0.057,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:47,873] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759347873, latencyMs=2, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=73), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@65dc068) from node 1001 with correlation id 73 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 10:55:47,873] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=3, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759347788, txnLastUpdateTimestamp=1602759347870) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 10:55:47,873] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=299 segment=[0:50729]) to (offset=300 segment=[0:50858]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,873] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,873] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,873] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,873] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,873] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347788, txnLastUpdateTimestamp=1602759347870) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,873] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347788, txnLastUpdateTimestamp=1602759347870) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,873] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,893] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347893, txnLastUpdateTimestamp=1602759347893) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,893] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=300 segment=[0:50858]) to (offset=301 segment=[0:51024]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,893] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,893] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,893] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,893] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,893] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347893, txnLastUpdateTimestamp=1602759347893) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,893] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347893, txnLastUpdateTimestamp=1602759347893) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,894] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=71) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:1.009,requestQueueTime:0.05,localTime:0.867,remoteTime:0.0,throttleTime:0.068,responseQueueTime:0.022,sendTime:0.069,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,894] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=148 segment=[0:11396])) (kafka.log.Log)
[2020-10-15 10:55:47,894] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=148 segment=[0:11396]) to (offset=149 segment=[0:11472]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,894] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,894] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,894] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,894] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,894] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=35) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=148,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.634,requestQueueTime:0.047,localTime:0.5,remoteTime:0.0,throttleTime:0.045,responseQueueTime:0.025,sendTime:0.061,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,972] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347893, txnLastUpdateTimestamp=1602759347972) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,972] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=301 segment=[0:51024]) to (offset=302 segment=[0:51218]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,972] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,972] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,972] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,972] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,972] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347893, txnLastUpdateTimestamp=1602759347972) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,972] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347893, txnLastUpdateTimestamp=1602759347972) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,972] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=72) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.693,requestQueueTime:0.034,localTime:0.589,remoteTime:0.0,throttleTime:0.027,responseQueueTime:0.02,sendTime:0.048,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,973] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=148 segment=[0:17094])) (kafka.log.Log)
[2020-10-15 10:55:47,973] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=148 segment=[0:17094]) to (offset=149 segment=[0:17247]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,973] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,973] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,973] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,973] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,973] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=36) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=3,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=75,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.823,requestQueueTime:0.036,localTime:0.709,remoteTime:0.0,throttleTime:0.056,responseQueueTime:0.022,sendTime:0.053,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,974] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347893, txnLastUpdateTimestamp=1602759347974) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,974] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=302 segment=[0:51218]) to (offset=303 segment=[0:51412]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,974] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,974] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,974] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,974] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,974] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347893, txnLastUpdateTimestamp=1602759347974) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,974] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347893, txnLastUpdateTimestamp=1602759347974) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,974] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347893, txnLastUpdateTimestamp=1602759347974) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,974] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=73) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.608,requestQueueTime:0.028,localTime:0.507,remoteTime:0.0,throttleTime:0.023,responseQueueTime:0.02,sendTime:0.052,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,974] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:47,975] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=74) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=51} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.228,requestQueueTime:0.027,localTime:0.076,remoteTime:0.0,throttleTime:0.019,responseQueueTime:0.071,sendTime:0.052,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,975] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:47,975] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=149 segment=[0:11472]) to (offset=150 segment=[0:11550]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,975] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:47,975] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:47,975] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,975] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,975] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,976] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=75) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=51}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.215,requestQueueTime:0.022,localTime:0.145,remoteTime:0.0,throttleTime:0.055,responseQueueTime:0.011,sendTime:0.035,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,976] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:47,976] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=149 segment=[0:17247]) to (offset=150 segment=[0:17325]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,976] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,976] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,976] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,976] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,976] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=20) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=148,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=150,last_stable_offset=150,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=11396, end=11550)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:103.57,requestQueueTime:0.052,localTime:0.217,remoteTime:102.957,throttleTime:0.136,responseQueueTime:0.028,sendTime:0.178,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,976] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 10:55:47,976] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:47,976] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=74) -- {transaction_markers=[{producer_id=0,producer_epoch=3,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.328,requestQueueTime:0.04,localTime:1.243,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.012,sendTime:0.032,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:47,976] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759347976, latencyMs=2, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=74), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@d01521b) from node 1001 with correlation id 74 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 10:55:47,976] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=3, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759347893, txnLastUpdateTimestamp=1602759347974) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 10:55:47,976] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=303 segment=[0:51412]) to (offset=304 segment=[0:51541]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,976] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,976] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,976] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,976] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,977] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347893, txnLastUpdateTimestamp=1602759347974) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,977] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347893, txnLastUpdateTimestamp=1602759347974) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,977] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,996] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347996, txnLastUpdateTimestamp=1602759347996) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,996] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=304 segment=[0:51541]) to (offset=305 segment=[0:51707]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,996] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,996] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,996] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,996] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,996] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347996, txnLastUpdateTimestamp=1602759347996) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:47,996] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759347996, txnLastUpdateTimestamp=1602759347996) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:47,996] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=76) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.662,requestQueueTime:0.033,localTime:0.553,remoteTime:0.0,throttleTime:0.045,responseQueueTime:0.019,sendTime:0.055,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:47,997] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=150 segment=[0:11550])) (kafka.log.Log)
[2020-10-15 10:55:47,997] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=150 segment=[0:11550]) to (offset=151 segment=[0:11626]) (kafka.cluster.Partition)
[2020-10-15 10:55:47,997] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,997] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,997] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:47,997] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:47,997] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=37) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=150,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.669,requestQueueTime:0.048,localTime:0.562,remoteTime:0.0,throttleTime:0.049,responseQueueTime:0.017,sendTime:0.041,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,071] DEBUG Request key MemberKey(kafka-tr-issue-201011-pr,rdkafka-d47e6757-9256-4bf4-a74d-5beea7624a67) unblocked 1 Heartbeat operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,071] DEBUG Completed request:RequestHeader(apiKey=HEARTBEAT, apiVersion=3, clientId=rdkafka, correlationId=9) -- {group_id=kafka-tr-issue-201011-pr,generation_id=7,member_id=rdkafka-d47e6757-9256-4bf4-a74d-5beea7624a67,group_instance_id=null},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46100-9;totalTime:0.486,requestQueueTime:0.032,localTime:0.366,remoteTime:0.0,throttleTime:0.04,responseQueueTime:0.022,sendTime:0.065,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,076] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347996, txnLastUpdateTimestamp=1602759348076) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,076] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=305 segment=[0:51707]) to (offset=306 segment=[0:51901]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,076] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,076] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,076] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,076] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,076] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347996, txnLastUpdateTimestamp=1602759348076) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,076] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347996, txnLastUpdateTimestamp=1602759348076) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:48,076] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=77) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.692,requestQueueTime:0.043,localTime:0.581,remoteTime:0.0,throttleTime:0.029,responseQueueTime:0.021,sendTime:0.045,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,077] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=150 segment=[0:17325])) (kafka.log.Log)
[2020-10-15 10:55:48,077] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=150 segment=[0:17325]) to (offset=151 segment=[0:17478]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,077] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,077] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,077] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,077] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,077] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=38) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=3,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=76,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.652,requestQueueTime:0.04,localTime:0.537,remoteTime:0.0,throttleTime:0.049,responseQueueTime:0.019,sendTime:0.054,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,077] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347996, txnLastUpdateTimestamp=1602759348077) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,077] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=306 segment=[0:51901]) to (offset=307 segment=[0:52095]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,077] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,077] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,077] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,078] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,078] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347996, txnLastUpdateTimestamp=1602759348077) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,078] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759347996, txnLastUpdateTimestamp=1602759348077) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:48,078] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347996, txnLastUpdateTimestamp=1602759348078) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,078] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=78) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.621,requestQueueTime:0.04,localTime:0.508,remoteTime:0.0,throttleTime:0.023,responseQueueTime:0.019,sendTime:0.052,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,078] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:48,078] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=79) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=51} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.232,requestQueueTime:0.045,localTime:0.108,remoteTime:0.0,throttleTime:0.023,responseQueueTime:0.024,sendTime:0.055,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,078] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:48,078] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=151 segment=[0:11626]) to (offset=152 segment=[0:11704]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,079] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:48,079] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,079] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,079] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,079] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:48,079] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:48,079] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=151 segment=[0:17478]) to (offset=152 segment=[0:17556]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,079] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,079] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,079] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,079] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,079] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=80) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=51}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.324,requestQueueTime:0.034,localTime:0.155,remoteTime:0.0,throttleTime:0.062,responseQueueTime:0.013,sendTime:0.122,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,079] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 10:55:48,079] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=21) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=150,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=152,last_stable_offset=152,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=11550, end=11704)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:103.491,requestQueueTime:0.045,localTime:0.251,remoteTime:102.71,throttleTime:0.124,responseQueueTime:0.023,sendTime:0.336,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,079] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:48,080] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=75) -- {transaction_markers=[{producer_id=0,producer_epoch=3,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.433,requestQueueTime:0.094,localTime:1.26,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.033,sendTime:0.045,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:48,080] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759348080, latencyMs=2, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=75), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@745ff56b) from node 1001 with correlation id 75 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 10:55:48,080] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=3, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759347996, txnLastUpdateTimestamp=1602759348077) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 10:55:48,080] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=307 segment=[0:52095]) to (offset=308 segment=[0:52224]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,080] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,080] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,080] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,080] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,080] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347996, txnLastUpdateTimestamp=1602759348078) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,080] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759347996, txnLastUpdateTimestamp=1602759348078) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:48,080] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,099] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759348099, txnLastUpdateTimestamp=1602759348099) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,100] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=308 segment=[0:52224]) to (offset=309 segment=[0:52390]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,100] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,100] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,100] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,100] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,100] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759348099, txnLastUpdateTimestamp=1602759348099) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,100] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759348099, txnLastUpdateTimestamp=1602759348099) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:48,100] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=81) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.685,requestQueueTime:0.032,localTime:0.578,remoteTime:0.0,throttleTime:0.064,responseQueueTime:0.02,sendTime:0.053,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,101] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=152 segment=[0:11704])) (kafka.log.Log)
[2020-10-15 10:55:48,101] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=152 segment=[0:11704]) to (offset=153 segment=[0:11780]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,101] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,101] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,101] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,101] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,101] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=39) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=152,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.634,requestQueueTime:0.049,localTime:0.51,remoteTime:0.0,throttleTime:0.047,responseQueueTime:0.021,sendTime:0.053,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,179] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759348099, txnLastUpdateTimestamp=1602759348179) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,180] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=309 segment=[0:52390]) to (offset=310 segment=[0:52584]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,180] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,180] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,180] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,180] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,180] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759348099, txnLastUpdateTimestamp=1602759348179) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,180] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759348099, txnLastUpdateTimestamp=1602759348179) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:48,180] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=82) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.714,requestQueueTime:0.029,localTime:0.623,remoteTime:0.0,throttleTime:0.026,responseQueueTime:0.017,sendTime:0.043,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,180] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=152 segment=[0:17556])) (kafka.log.Log)
[2020-10-15 10:55:48,180] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=152 segment=[0:17556]) to (offset=153 segment=[0:17709]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,180] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,181] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,181] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,181] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,181] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=40) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=3,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=77,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.698,requestQueueTime:0.032,localTime:0.613,remoteTime:0.0,throttleTime:0.051,responseQueueTime:0.017,sendTime:0.033,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,181] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759348099, txnLastUpdateTimestamp=1602759348181) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,181] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=310 segment=[0:52584]) to (offset=311 segment=[0:52778]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,181] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,181] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,181] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,181] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,181] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759348099, txnLastUpdateTimestamp=1602759348181) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,181] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759348099, txnLastUpdateTimestamp=1602759348181) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:48,181] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759348099, txnLastUpdateTimestamp=1602759348181) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,182] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=83) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.711,requestQueueTime:0.03,localTime:0.614,remoteTime:0.0,throttleTime:0.027,responseQueueTime:0.02,sendTime:0.045,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,182] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:48,182] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=84) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=51} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.148,requestQueueTime:0.021,localTime:0.077,remoteTime:0.0,throttleTime:0.021,responseQueueTime:0.013,sendTime:0.035,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,182] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:48,182] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=153 segment=[0:11780]) to (offset=154 segment=[0:11858]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,183] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:48,183] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:48,183] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,183] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,183] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,183] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=22) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=152,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=154,last_stable_offset=154,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=11704, end=11858)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:103.585,requestQueueTime:0.042,localTime:0.187,remoteTime:103.092,throttleTime:0.126,responseQueueTime:0.014,sendTime:0.123,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,183] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:48,183] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=153 segment=[0:17709]) to (offset=154 segment=[0:17787]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,183] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,183] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,183] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,183] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,183] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:48,183] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=85) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=51}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.401,requestQueueTime:0.03,localTime:0.32,remoteTime:0.0,throttleTime:0.24,responseQueueTime:0.015,sendTime:0.034,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,183] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 10:55:48,183] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=76) -- {transaction_markers=[{producer_id=0,producer_epoch=3,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.439,requestQueueTime:0.136,localTime:1.242,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.014,sendTime:0.046,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:48,184] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759348183, latencyMs=1, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=76), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@161370dd) from node 1001 with correlation id 76 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 10:55:48,184] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=3, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759348099, txnLastUpdateTimestamp=1602759348181) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 10:55:48,184] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=311 segment=[0:52778]) to (offset=312 segment=[0:52907]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,184] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,184] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,184] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,184] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,184] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759348099, txnLastUpdateTimestamp=1602759348181) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,184] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759348099, txnLastUpdateTimestamp=1602759348181) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:48,184] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,204] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759348203, txnLastUpdateTimestamp=1602759348203) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,204] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=312 segment=[0:52907]) to (offset=313 segment=[0:53073]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,204] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,204] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,204] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,204] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,204] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759348203, txnLastUpdateTimestamp=1602759348203) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,204] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759348203, txnLastUpdateTimestamp=1602759348203) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:48,204] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=86) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.707,requestQueueTime:0.038,localTime:0.599,remoteTime:0.0,throttleTime:0.052,responseQueueTime:0.019,sendTime:0.049,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,205] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=154 segment=[0:11858])) (kafka.log.Log)
[2020-10-15 10:55:48,205] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=154 segment=[0:11858]) to (offset=155 segment=[0:11934]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,205] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,205] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,205] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,205] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,205] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=41) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=154,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.647,requestQueueTime:0.045,localTime:0.555,remoteTime:0.0,throttleTime:0.051,responseQueueTime:0.015,sendTime:0.032,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,226] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:48,226] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=28) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=80,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=80,last_stable_offset=80,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=MemoryRecords(size=0, buffer=java.nio.HeapByteBuffer[pos=0 lim=0 cap=0])}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:500.881,requestQueueTime:0.07,localTime:0.166,remoteTime:500.296,throttleTime:0.16,responseQueueTime:0.039,sendTime:0.148,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,226] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:48,282] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759348203, txnLastUpdateTimestamp=1602759348282) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,283] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=313 segment=[0:53073]) to (offset=314 segment=[0:53267]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,283] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,283] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,283] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,283] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,283] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759348203, txnLastUpdateTimestamp=1602759348282) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,283] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759348203, txnLastUpdateTimestamp=1602759348282) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:48,283] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=87) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.716,requestQueueTime:0.033,localTime:0.603,remoteTime:0.0,throttleTime:0.036,responseQueueTime:0.022,sendTime:0.055,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,284] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=154 segment=[0:17787])) (kafka.log.Log)
[2020-10-15 10:55:48,284] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=154 segment=[0:17787]) to (offset=155 segment=[0:17940]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,284] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,284] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,284] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,284] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,284] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=42) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=3,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=78,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.981,requestQueueTime:0.043,localTime:0.863,remoteTime:0.0,throttleTime:0.063,responseQueueTime:0.019,sendTime:0.055,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,285] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759348203, txnLastUpdateTimestamp=1602759348284) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,285] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=314 segment=[0:53267]) to (offset=315 segment=[0:53461]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,285] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,285] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,285] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,285] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,285] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759348203, txnLastUpdateTimestamp=1602759348284) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,285] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759348203, txnLastUpdateTimestamp=1602759348284) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:48,285] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759348203, txnLastUpdateTimestamp=1602759348285) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,285] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=88) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.664,requestQueueTime:0.028,localTime:0.576,remoteTime:0.0,throttleTime:0.024,responseQueueTime:0.014,sendTime:0.045,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,286] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:48,286] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=89) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=51} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.178,requestQueueTime:0.028,localTime:0.091,remoteTime:0.0,throttleTime:0.023,responseQueueTime:0.012,sendTime:0.045,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,286] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:48,287] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:48,287] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=155 segment=[0:11934]) to (offset=156 segment=[0:12012]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,287] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=90) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=51}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.258,requestQueueTime:0.035,localTime:0.142,remoteTime:0.0,throttleTime:0.048,responseQueueTime:0.034,sendTime:0.045,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,287] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:48,287] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,287] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,287] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,287] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=23) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=154,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=156,last_stable_offset=156,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=11858, end=12012)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:103.932,requestQueueTime:0.038,localTime:0.222,remoteTime:103.394,throttleTime:0.129,responseQueueTime:0.02,sendTime:0.126,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,287] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:48,287] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=155 segment=[0:17940]) to (offset=156 segment=[0:18018]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,287] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,287] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,287] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,287] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,287] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:48,287] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 10:55:48,288] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=77) -- {transaction_markers=[{producer_id=0,producer_epoch=3,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.348,requestQueueTime:0.039,localTime:1.26,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.012,sendTime:0.035,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:48,288] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759348288, latencyMs=3, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=77), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@7ea5bcf7) from node 1001 with correlation id 77 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 10:55:48,288] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=3, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759348203, txnLastUpdateTimestamp=1602759348284) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 10:55:48,288] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=315 segment=[0:53461]) to (offset=316 segment=[0:53590]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,288] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,288] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,288] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,288] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,288] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759348203, txnLastUpdateTimestamp=1602759348285) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,288] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759348203, txnLastUpdateTimestamp=1602759348285) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:48,288] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,307] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759348307, txnLastUpdateTimestamp=1602759348307) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,307] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=316 segment=[0:53590]) to (offset=317 segment=[0:53756]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,307] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,307] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,307] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,307] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,307] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759348307, txnLastUpdateTimestamp=1602759348307) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,307] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759348307, txnLastUpdateTimestamp=1602759348307) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:48,308] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=91) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.74,requestQueueTime:0.038,localTime:0.62,remoteTime:0.0,throttleTime:0.049,responseQueueTime:0.023,sendTime:0.058,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,308] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=156 segment=[0:12012])) (kafka.log.Log)
[2020-10-15 10:55:48,308] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=156 segment=[0:12012]) to (offset=157 segment=[0:12088]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,308] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,308] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,308] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,308] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,308] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=43) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=156,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.738,requestQueueTime:0.049,localTime:0.607,remoteTime:0.0,throttleTime:0.061,responseQueueTime:0.027,sendTime:0.053,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,387] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759348307, txnLastUpdateTimestamp=1602759348387) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,387] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=317 segment=[0:53756]) to (offset=318 segment=[0:53950]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,387] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,387] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,387] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,387] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,387] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759348307, txnLastUpdateTimestamp=1602759348387) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,387] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759348307, txnLastUpdateTimestamp=1602759348387) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:48,387] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=92) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.559,requestQueueTime:0.028,localTime:0.474,remoteTime:0.0,throttleTime:0.02,responseQueueTime:0.013,sendTime:0.043,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,388] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=156 segment=[0:18018])) (kafka.log.Log)
[2020-10-15 10:55:48,388] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=156 segment=[0:18018]) to (offset=157 segment=[0:18171]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,388] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,388] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,388] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,388] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,388] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=44) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=3,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=79,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.714,requestQueueTime:0.039,localTime:0.593,remoteTime:0.0,throttleTime:0.049,responseQueueTime:0.026,sendTime:0.055,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,388] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759348307, txnLastUpdateTimestamp=1602759348388) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,389] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=318 segment=[0:53950]) to (offset=319 segment=[0:54144]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,389] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,389] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,389] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,389] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,389] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759348307, txnLastUpdateTimestamp=1602759348388) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,389] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759348307, txnLastUpdateTimestamp=1602759348388) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:48,389] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759348307, txnLastUpdateTimestamp=1602759348389) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,389] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=93) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.571,requestQueueTime:0.029,localTime:0.485,remoteTime:0.0,throttleTime:0.022,responseQueueTime:0.012,sendTime:0.044,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,389] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:48,389] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=94) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=51} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.23,requestQueueTime:0.026,localTime:0.082,remoteTime:0.0,throttleTime:0.021,responseQueueTime:0.018,sendTime:0.102,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,390] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:48,390] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=157 segment=[0:12088]) to (offset=158 segment=[0:12166]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,390] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:48,390] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,390] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,390] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,390] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=24) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=156,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=158,last_stable_offset=158,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=12012, end=12166)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:102.852,requestQueueTime:0.043,localTime:0.142,remoteTime:102.417,throttleTime:0.113,responseQueueTime:0.017,sendTime:0.117,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,390] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:48,390] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=157 segment=[0:18171]) to (offset=158 segment=[0:18249]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,390] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,390] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,390] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:48,390] DEBUG [TransactionCoordinator id=1001] Returning CONCURRENT_TRANSACTIONS error code to client for eos-transactions.py's AddPartitions request (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 10:55:48,390] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,390] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,390] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 10:55:48,390] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=95) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=51}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.314,requestQueueTime:0.061,localTime:0.174,remoteTime:0.0,throttleTime:0.046,responseQueueTime:0.029,sendTime:0.049,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,391] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=78) -- {transaction_markers=[{producer_id=0,producer_epoch=3,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.411,requestQueueTime:0.028,localTime:1.314,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.02,sendTime:0.048,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:48,391] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759348391, latencyMs=2, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=78), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@7933a8b2) from node 1001 with correlation id 78 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 10:55:48,391] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=3, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759348307, txnLastUpdateTimestamp=1602759348388) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 10:55:48,391] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=319 segment=[0:54144]) to (offset=320 segment=[0:54273]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,391] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,391] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,391] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,391] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,391] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759348307, txnLastUpdateTimestamp=1602759348389) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,391] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759348307, txnLastUpdateTimestamp=1602759348389) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:48,392] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,411] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759348411, txnLastUpdateTimestamp=1602759348411) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,411] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=320 segment=[0:54273]) to (offset=321 segment=[0:54439]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,411] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,411] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,411] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,411] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,411] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759348411, txnLastUpdateTimestamp=1602759348411) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,411] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(demooutput1602758609-0), txnStartTimestamp=1602759348411, txnLastUpdateTimestamp=1602759348411) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:48,411] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=96) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.632,requestQueueTime:0.037,localTime:0.514,remoteTime:0.0,throttleTime:0.046,responseQueueTime:0.016,sendTime:0.063,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,412] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=158 segment=[0:12166])) (kafka.log.Log)
[2020-10-15 10:55:48,412] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=158 segment=[0:12166]) to (offset=159 segment=[0:12242]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,412] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,412] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,412] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,412] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,412] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=45) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=158,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.616,requestQueueTime:0.042,localTime:0.493,remoteTime:0.0,throttleTime:0.047,responseQueueTime:0.019,sendTime:0.06,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,490] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759348411, txnLastUpdateTimestamp=1602759348490) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,491] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=321 segment=[0:54439]) to (offset=322 segment=[0:54633]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,491] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,491] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,491] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,491] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,491] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759348411, txnLastUpdateTimestamp=1602759348490) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,491] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759348411, txnLastUpdateTimestamp=1602759348490) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:48,491] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=97) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.686,requestQueueTime:0.034,localTime:0.584,remoteTime:0.0,throttleTime:0.022,responseQueueTime:0.019,sendTime:0.048,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,492] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=158 segment=[0:18249])) (kafka.log.Log)
[2020-10-15 10:55:48,492] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=158 segment=[0:18249]) to (offset=159 segment=[0:18402]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,492] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,492] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,492] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,492] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,492] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=46) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=3,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=80,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46104-9;totalTime:0.767,requestQueueTime:0.041,localTime:0.658,remoteTime:0.0,throttleTime:0.052,responseQueueTime:0.022,sendTime:0.044,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,492] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759348411, txnLastUpdateTimestamp=1602759348492) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,493] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=322 segment=[0:54633]) to (offset=323 segment=[0:54827]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,493] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,493] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,493] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,493] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,493] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759348411, txnLastUpdateTimestamp=1602759348492) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,493] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759348411, txnLastUpdateTimestamp=1602759348492) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:48,493] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759348411, txnLastUpdateTimestamp=1602759348493) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,493] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=98) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=3,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46106-10;totalTime:0.705,requestQueueTime:0.029,localTime:0.613,remoteTime:0.0,throttleTime:0.023,responseQueueTime:0.015,sendTime:0.046,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,494] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:48,494] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=159 segment=[0:12242]) to (offset=160 segment=[0:12320]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,494] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:48,494] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,494] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,494] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,494] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 10:55:48,494] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=159 segment=[0:18402]) to (offset=160 segment=[0:18480]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,494] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,494] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,494] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,494] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=25) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=158,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=160,last_stable_offset=160,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=12166, end=12320)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:103.934,requestQueueTime:0.033,localTime:0.143,remoteTime:103.504,throttleTime:0.116,responseQueueTime:0.016,sendTime:0.12,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,494] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,494] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 10:55:48,495] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 10:55:48,495] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=79) -- {transaction_markers=[{producer_id=0,producer_epoch=3,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.379,requestQueueTime:0.039,localTime:1.289,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.012,sendTime:0.038,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 10:55:48,495] DEBUG [SocketServer brokerId=1001] Connection with /172.31.31.254 disconnected (org.apache.kafka.common.network.Selector)
java.io.EOFException
	at org.apache.kafka.common.network.NetworkReceive.readFrom(NetworkReceive.java:97)
	at org.apache.kafka.common.network.KafkaChannel.receive(KafkaChannel.java:448)
	at org.apache.kafka.common.network.KafkaChannel.read(KafkaChannel.java:398)
	at org.apache.kafka.common.network.Selector.attemptRead(Selector.java:678)
	at org.apache.kafka.common.network.Selector.pollSelectionKeys(Selector.java:580)
	at org.apache.kafka.common.network.Selector.poll(Selector.java:485)
	at kafka.network.Processor.poll(SocketServer.scala:861)
	at kafka.network.Processor.run(SocketServer.scala:760)
	at java.base/java.lang.Thread.run(Thread.java:834)
[2020-10-15 10:55:48,495] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759348495, latencyMs=2, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=79), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@724cfe52) from node 1001 with correlation id 79 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 10:55:48,495] DEBUG [SocketServer brokerId=1001] Connection with /172.31.31.254 disconnected (org.apache.kafka.common.network.Selector)
java.io.EOFException
	at org.apache.kafka.common.network.NetworkReceive.readFrom(NetworkReceive.java:97)
	at org.apache.kafka.common.network.KafkaChannel.receive(KafkaChannel.java:448)
	at org.apache.kafka.common.network.KafkaChannel.read(KafkaChannel.java:398)
	at org.apache.kafka.common.network.Selector.attemptRead(Selector.java:678)
	at org.apache.kafka.common.network.Selector.pollSelectionKeys(Selector.java:580)
	at org.apache.kafka.common.network.Selector.poll(Selector.java:485)
	at kafka.network.Processor.poll(SocketServer.scala:861)
	at kafka.network.Processor.run(SocketServer.scala:760)
	at java.base/java.lang.Thread.run(Thread.java:834)
[2020-10-15 10:55:48,495] DEBUG [SocketServer brokerId=1001] Connection with /172.31.31.254 disconnected (org.apache.kafka.common.network.Selector)
java.io.EOFException
	at org.apache.kafka.common.network.NetworkReceive.readFrom(NetworkReceive.java:97)
	at org.apache.kafka.common.network.KafkaChannel.receive(KafkaChannel.java:448)
	at org.apache.kafka.common.network.KafkaChannel.read(KafkaChannel.java:398)
	at org.apache.kafka.common.network.Selector.attemptRead(Selector.java:678)
	at org.apache.kafka.common.network.Selector.pollSelectionKeys(Selector.java:580)
	at org.apache.kafka.common.network.Selector.poll(Selector.java:485)
	at kafka.network.Processor.poll(SocketServer.scala:861)
	at kafka.network.Processor.run(SocketServer.scala:760)
	at java.base/java.lang.Thread.run(Thread.java:834)
[2020-10-15 10:55:48,497] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=3, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759348411, txnLastUpdateTimestamp=1602759348492) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 10:55:48,497] DEBUG Request key MemberKey(kafka-tr-issue-201011-pr,rdkafka-d47e6757-9256-4bf4-a74d-5beea7624a67) unblocked 1 Heartbeat operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,498] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=323 segment=[0:54827]) to (offset=324 segment=[0:54956]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,498] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,498] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,498] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,498] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,498] DEBUG [Partition __consumer_offsets-2 broker=1001] High watermark updated from (offset=11 segment=[0:2407]) to (offset=12 segment=[0:2560]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,498] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,2) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,498] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,2) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,498] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,2) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,498] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,498] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759348411, txnLastUpdateTimestamp=1602759348493) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 10:55:48,498] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=3, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759348411, txnLastUpdateTimestamp=1602759348493) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 10:55:48,498] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,498] DEBUG Completed request:RequestHeader(apiKey=OFFSET_COMMIT, apiVersion=7, clientId=rdkafka, correlationId=10) -- {group_id=kafka-tr-issue-201011-pr,generation_id=7,member_id=rdkafka-d47e6757-9256-4bf4-a74d-5beea7624a67,group_instance_id=null,topics=[{name=demooutput1602758609,partitions=[{partition_index=0,committed_offset=160,committed_leader_epoch=-1,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demooutput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46100-9;totalTime:0.939,requestQueueTime:0.039,localTime:0.817,remoteTime:0.0,throttleTime:0.048,responseQueueTime:0.02,sendTime:0.061,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,498] DEBUG Request key MemberKey(kafka-tr-issue-201011-pr,rdkafka-d47e6757-9256-4bf4-a74d-5beea7624a67) unblocked 1 Heartbeat operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,498] INFO [GroupCoordinator 1001]: Member[group.instance.id None, member.id rdkafka-d47e6757-9256-4bf4-a74d-5beea7624a67] in group kafka-tr-issue-201011-pr has left, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2020-10-15 10:55:48,499] INFO [GroupCoordinator 1001]: Preparing to rebalance group kafka-tr-issue-201011-pr in state PreparingRebalance with old generation 7 (__consumer_offsets-2) (reason: removing member rdkafka-d47e6757-9256-4bf4-a74d-5beea7624a67 on LeaveGroup) (kafka.coordinator.group.GroupCoordinator)
[2020-10-15 10:55:48,499] INFO [GroupCoordinator 1001]: Group kafka-tr-issue-201011-pr with generation 8 is now empty (__consumer_offsets-2) (kafka.coordinator.group.GroupCoordinator)
[2020-10-15 10:55:48,499] DEBUG [Partition __consumer_offsets-2 broker=1001] High watermark updated from (offset=12 segment=[0:2560]) to (offset=13 segment=[0:2689]) (kafka.cluster.Partition)
[2020-10-15 10:55:48,499] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,2) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,499] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,2) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,499] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,2) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 10:55:48,499] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 10:55:48,499] DEBUG Completed request:RequestHeader(apiKey=LEAVE_GROUP, apiVersion=1, clientId=rdkafka, correlationId=11) -- {group_id=kafka-tr-issue-201011-pr,member_id=rdkafka-d47e6757-9256-4bf4-a74d-5beea7624a67},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46100-9;totalTime:1.164,requestQueueTime:0.027,localTime:1.078,remoteTime:0.0,throttleTime:0.029,responseQueueTime:0.021,sendTime:0.036,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,499] DEBUG [SocketServer brokerId=1001] Connection with /172.31.31.254 disconnected (org.apache.kafka.common.network.Selector)
java.io.EOFException
	at org.apache.kafka.common.network.NetworkReceive.readFrom(NetworkReceive.java:97)
	at org.apache.kafka.common.network.KafkaChannel.receive(KafkaChannel.java:448)
	at org.apache.kafka.common.network.KafkaChannel.read(KafkaChannel.java:398)
	at org.apache.kafka.common.network.Selector.attemptRead(Selector.java:678)
	at org.apache.kafka.common.network.Selector.pollSelectionKeys(Selector.java:580)
	at org.apache.kafka.common.network.Selector.poll(Selector.java:485)
	at kafka.network.Processor.poll(SocketServer.scala:861)
	at kafka.network.Processor.run(SocketServer.scala:760)
	at java.base/java.lang.Thread.run(Thread.java:834)
[2020-10-15 10:55:48,504] DEBUG [SocketServer brokerId=1001] Connection with /172.31.31.254 disconnected (org.apache.kafka.common.network.Selector)
java.io.EOFException
	at org.apache.kafka.common.network.NetworkReceive.readFrom(NetworkReceive.java:97)
	at org.apache.kafka.common.network.KafkaChannel.receive(KafkaChannel.java:448)
	at org.apache.kafka.common.network.KafkaChannel.read(KafkaChannel.java:398)
	at org.apache.kafka.common.network.Selector.attemptRead(Selector.java:678)
	at org.apache.kafka.common.network.Selector.pollSelectionKeys(Selector.java:580)
	at org.apache.kafka.common.network.Selector.poll(Selector.java:485)
	at kafka.network.Processor.poll(SocketServer.scala:861)
	at kafka.network.Processor.run(SocketServer.scala:760)
	at java.base/java.lang.Thread.run(Thread.java:834)
[2020-10-15 10:55:48,577] DEBUG Got ping response for sessionid: 0x10000dc56b30003 after 0ms (org.apache.zookeeper.ClientCnxn)
[2020-10-15 10:55:48,727] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:48,728] DEBUG [SocketServer brokerId=1001] Connection with /172.31.31.254 disconnected (org.apache.kafka.common.network.Selector)
java.io.IOException: Broken pipe
	at java.base/sun.nio.ch.FileDispatcherImpl.writev0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.writev(SocketDispatcher.java:51)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:182)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:130)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:496)
	at java.base/java.nio.channels.SocketChannel.write(SocketChannel.java:507)
	at org.apache.kafka.common.network.PlaintextTransportLayer.write(PlaintextTransportLayer.java:152)
	at org.apache.kafka.common.network.ByteBufferSend.writeTo(ByteBufferSend.java:60)
	at org.apache.kafka.common.record.MultiRecordsSend.writeTo(MultiRecordsSend.java:93)
	at org.apache.kafka.common.network.KafkaChannel.write(KafkaChannel.java:426)
	at org.apache.kafka.common.network.Selector.write(Selector.java:648)
	at org.apache.kafka.common.network.Selector.attemptWrite(Selector.java:641)
	at org.apache.kafka.common.network.Selector.pollSelectionKeys(Selector.java:597)
	at org.apache.kafka.common.network.Selector.poll(Selector.java:485)
	at kafka.network.Processor.poll(SocketServer.scala:861)
	at kafka.network.Processor.run(SocketServer.scala:760)
	at java.base/java.lang.Thread.run(Thread.java:834)
[2020-10-15 10:55:48,728] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=29) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=80,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=80,last_stable_offset=80,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=MemoryRecords(size=0, buffer=java.nio.HeapByteBuffer[pos=0 lim=0 cap=0])}]}]} from connection 172.31.31.3:9092-172.31.31.254:46102-9;totalTime:501.848,requestQueueTime:0.055,localTime:0.222,remoteTime:500.672,throttleTime:0.229,responseQueueTime:0.038,sendTime:0.629,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 10:55:48,995] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 10:55:48,995] DEBUG [SocketServer brokerId=1001] Connection with /172.31.31.254 disconnected (org.apache.kafka.common.network.Selector)
java.io.IOException: Broken pipe
	at java.base/sun.nio.ch.FileDispatcherImpl.writev0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.writev(SocketDispatcher.java:51)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:182)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:130)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:496)
	at java.base/java.nio.channels.SocketChannel.write(SocketChannel.java:507)
	at org.apache.kafka.common.network.PlaintextTransportLayer.write(PlaintextTransportLayer.java:152)
	at org.apache.kafka.common.network.ByteBufferSend.writeTo(ByteBufferSend.java:60)
	at org.apache.kafka.common.record.MultiRecordsSend.writeTo(MultiRecordsSend.java:93)
	at org.apache.kafka.common.network.KafkaChannel.write(KafkaChannel.java:426)
	at org.apache.kafka.common.network.Selector.write(Selector.java:648)
	at org.apache.kafka.common.network.Selector.attemptWrite(Selector.java:641)
	at org.apache.kafka.common.network.Selector.pollSelectionKeys(Selector.java:597)
	at org.apache.kafka.common.network.Selector.poll(Selector.java:485)
	at kafka.network.Processor.poll(SocketServer.scala:861)
	at kafka.network.Processor.run(SocketServer.scala:760)
	at java.base/java.lang.Thread.run(Thread.java:834)
[2020-10-15 10:55:48,995] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=26) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=160,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=160,last_stable_offset=160,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=MemoryRecords(size=0, buffer=java.nio.HeapByteBuffer[pos=0 lim=0 cap=0])}]}]} from connection 172.31.31.3:9092-172.31.31.254:46096-8;totalTime:500.911,requestQueueTime:0.04,localTime:0.166,remoteTime:499.905,throttleTime:0.224,responseQueueTime:0.042,sendTime:0.53,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
