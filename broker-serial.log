SERIAL log (producer completed without going into retry-backoff)

[2020-10-15 11:05:03,333] DEBUG Accepted connection from /172.31.31.254:46528 on /172.31.31.3:9092 and assigned it to processor 0, sendBufferSize [actual|requested]: [102400|102400] recvBufferSize [actual|requested]: [102400|102400] (kafka.network.Acceptor)
[2020-10-15 11:05:03,333] DEBUG Processor 0 listening to new connection from /172.31.31.254:46528 (kafka.network.Processor)
[2020-10-15 11:05:03,333] DEBUG Accepted connection from /172.31.31.254:46530 on /172.31.31.3:9092 and assigned it to processor 1, sendBufferSize [actual|requested]: [102400|102400] recvBufferSize [actual|requested]: [102400|102400] (kafka.network.Acceptor)
[2020-10-15 11:05:03,333] DEBUG Processor 1 listening to new connection from /172.31.31.254:46530 (kafka.network.Processor)
[2020-10-15 11:05:03,333] DEBUG Completed request:RequestHeader(apiKey=API_VERSIONS, apiVersion=3, clientId=rdkafka, correlationId=1) -- {client_software_name=confluent-kafka-python,client_software_version=1.5.0-rdkafka-1.5.0,_tagged_fields={}},response:{error_code=0,api_keys=[{api_key=0,min_version=0,max_version=8,_tagged_fields={}},{api_key=1,min_version=0,max_version=11,_tagged_fields={}},{api_key=2,min_version=0,max_version=5,_tagged_fields={}},{api_key=3,min_version=0,max_version=9,_tagged_fields={}},{api_key=4,min_version=0,max_version=4,_tagged_fields={}},{api_key=5,min_version=0,max_version=2,_tagged_fields={}},{api_key=6,min_version=0,max_version=6,_tagged_fields={}},{api_key=7,min_version=0,max_version=3,_tagged_fields={}},{api_key=8,min_version=0,max_version=8,_tagged_fields={}},{api_key=9,min_version=0,max_version=7,_tagged_fields={}},{api_key=10,min_version=0,max_version=3,_tagged_fields={}},{api_key=11,min_version=0,max_version=7,_tagged_fields={}},{api_key=12,min_version=0,max_version=4,_tagged_fields={}},{api_key=13,min_version=0,max_version=4,_tagged_fields={}},{api_key=14,min_version=0,max_version=5,_tagged_fields={}},{api_key=15,min_version=0,max_version=5,_tagged_fields={}},{api_key=16,min_version=0,max_version=3,_tagged_fields={}},{api_key=17,min_version=0,max_version=1,_tagged_fields={}},{api_key=18,min_version=0,max_version=3,_tagged_fields={}},{api_key=19,min_version=0,max_version=5,_tagged_fields={}},{api_key=20,min_version=0,max_version=4,_tagged_fields={}},{api_key=21,min_version=0,max_version=1,_tagged_fields={}},{api_key=22,min_version=0,max_version=3,_tagged_fields={}},{api_key=23,min_version=0,max_version=3,_tagged_fields={}},{api_key=24,min_version=0,max_version=1,_tagged_fields={}},{api_key=25,min_version=0,max_version=1,_tagged_fields={}},{api_key=26,min_version=0,max_version=1,_tagged_fields={}},{api_key=27,min_version=0,max_version=0,_tagged_fields={}},{api_key=28,min_version=0,max_version=3,_tagged_fields={}},{api_key=29,min_version=0,max_version=2,_tagged_fields={}},{api_key=30,min_version=0,max_version=2,_tagged_fields={}},{api_key=31,min_version=0,max_version=2,_tagged_fields={}},{api_key=32,min_version=0,max_version=2,_tagged_fields={}},{api_key=33,min_version=0,max_version=1,_tagged_fields={}},{api_key=34,min_version=0,max_version=1,_tagged_fields={}},{api_key=35,min_version=0,max_version=1,_tagged_fields={}},{api_key=36,min_version=0,max_version=2,_tagged_fields={}},{api_key=37,min_version=0,max_version=2,_tagged_fields={}},{api_key=38,min_version=0,max_version=2,_tagged_fields={}},{api_key=39,min_version=0,max_version=2,_tagged_fields={}},{api_key=40,min_version=0,max_version=2,_tagged_fields={}},{api_key=41,min_version=0,max_version=2,_tagged_fields={}},{api_key=42,min_version=0,max_version=2,_tagged_fields={}},{api_key=43,min_version=0,max_version=2,_tagged_fields={}},{api_key=44,min_version=0,max_version=1,_tagged_fields={}},{api_key=45,min_version=0,max_version=0,_tagged_fields={}},{api_key=46,min_version=0,max_version=0,_tagged_fields={}},{api_key=47,min_version=0,max_version=0,_tagged_fields={}}],throttle_time_ms=0,_tagged_fields={}} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:0.503,requestQueueTime:0.112,localTime:0.233,remoteTime:0.0,throttleTime:0.215,responseQueueTime:0.029,sendTime:0.127,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:03,334] DEBUG Completed request:RequestHeader(apiKey=METADATA, apiVersion=4, clientId=rdkafka, correlationId=2) -- {topics=[],allow_auto_topic_creation=false},response:{throttle_time_ms=0,brokers=[{node_id=1001,host=172.31.31.3,port=9092,rack=null}],cluster_id=QiooE7cPQ-GwOKmM8lbPPg,controller_id=1001,topics=[]} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:0.34,requestQueueTime:0.034,localTime:0.256,remoteTime:0.0,throttleTime:0.105,responseQueueTime:0.016,sendTime:0.033,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:03,334] DEBUG Completed request:RequestHeader(apiKey=API_VERSIONS, apiVersion=3, clientId=rdkafka, correlationId=1) -- {client_software_name=confluent-kafka-python,client_software_version=1.5.0-rdkafka-1.5.0,_tagged_fields={}},response:{error_code=0,api_keys=[{api_key=0,min_version=0,max_version=8,_tagged_fields={}},{api_key=1,min_version=0,max_version=11,_tagged_fields={}},{api_key=2,min_version=0,max_version=5,_tagged_fields={}},{api_key=3,min_version=0,max_version=9,_tagged_fields={}},{api_key=4,min_version=0,max_version=4,_tagged_fields={}},{api_key=5,min_version=0,max_version=2,_tagged_fields={}},{api_key=6,min_version=0,max_version=6,_tagged_fields={}},{api_key=7,min_version=0,max_version=3,_tagged_fields={}},{api_key=8,min_version=0,max_version=8,_tagged_fields={}},{api_key=9,min_version=0,max_version=7,_tagged_fields={}},{api_key=10,min_version=0,max_version=3,_tagged_fields={}},{api_key=11,min_version=0,max_version=7,_tagged_fields={}},{api_key=12,min_version=0,max_version=4,_tagged_fields={}},{api_key=13,min_version=0,max_version=4,_tagged_fields={}},{api_key=14,min_version=0,max_version=5,_tagged_fields={}},{api_key=15,min_version=0,max_version=5,_tagged_fields={}},{api_key=16,min_version=0,max_version=3,_tagged_fields={}},{api_key=17,min_version=0,max_version=1,_tagged_fields={}},{api_key=18,min_version=0,max_version=3,_tagged_fields={}},{api_key=19,min_version=0,max_version=5,_tagged_fields={}},{api_key=20,min_version=0,max_version=4,_tagged_fields={}},{api_key=21,min_version=0,max_version=1,_tagged_fields={}},{api_key=22,min_version=0,max_version=3,_tagged_fields={}},{api_key=23,min_version=0,max_version=3,_tagged_fields={}},{api_key=24,min_version=0,max_version=1,_tagged_fields={}},{api_key=25,min_version=0,max_version=1,_tagged_fields={}},{api_key=26,min_version=0,max_version=1,_tagged_fields={}},{api_key=27,min_version=0,max_version=0,_tagged_fields={}},{api_key=28,min_version=0,max_version=3,_tagged_fields={}},{api_key=29,min_version=0,max_version=2,_tagged_fields={}},{api_key=30,min_version=0,max_version=2,_tagged_fields={}},{api_key=31,min_version=0,max_version=2,_tagged_fields={}},{api_key=32,min_version=0,max_version=2,_tagged_fields={}},{api_key=33,min_version=0,max_version=1,_tagged_fields={}},{api_key=34,min_version=0,max_version=1,_tagged_fields={}},{api_key=35,min_version=0,max_version=1,_tagged_fields={}},{api_key=36,min_version=0,max_version=2,_tagged_fields={}},{api_key=37,min_version=0,max_version=2,_tagged_fields={}},{api_key=38,min_version=0,max_version=2,_tagged_fields={}},{api_key=39,min_version=0,max_version=2,_tagged_fields={}},{api_key=40,min_version=0,max_version=2,_tagged_fields={}},{api_key=41,min_version=0,max_version=2,_tagged_fields={}},{api_key=42,min_version=0,max_version=2,_tagged_fields={}},{api_key=43,min_version=0,max_version=2,_tagged_fields={}},{api_key=44,min_version=0,max_version=1,_tagged_fields={}},{api_key=45,min_version=0,max_version=0,_tagged_fields={}},{api_key=46,min_version=0,max_version=0,_tagged_fields={}},{api_key=47,min_version=0,max_version=0,_tagged_fields={}}],throttle_time_ms=0,_tagged_fields={}} from connection 172.31.31.3:9092-172.31.31.254:46530-11;totalTime:1.055,requestQueueTime:0.042,localTime:0.241,remoteTime:0.0,throttleTime:0.228,responseQueueTime:0.731,sendTime:0.039,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:03,334] DEBUG Completed request:RequestHeader(apiKey=FIND_COORDINATOR, apiVersion=2, clientId=rdkafka, correlationId=3) -- {key=kafka-tr-issue-201011-pr,key_type=0},response:{throttle_time_ms=0,error_code=0,error_message=NONE,node_id=1001,host=172.31.31.3,port=9092} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:0.26,requestQueueTime:0.024,localTime:0.196,remoteTime:0.0,throttleTime:0.052,responseQueueTime:0.01,sendTime:0.028,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:03,335] DEBUG Accepted connection from /172.31.31.254:46532 on /172.31.31.3:9092 and assigned it to processor 2, sendBufferSize [actual|requested]: [102400|102400] recvBufferSize [actual|requested]: [102400|102400] (kafka.network.Acceptor)
[2020-10-15 11:05:03,335] DEBUG Processor 2 listening to new connection from /172.31.31.254:46532 (kafka.network.Processor)
[2020-10-15 11:05:03,335] DEBUG Completed request:RequestHeader(apiKey=METADATA, apiVersion=4, clientId=rdkafka, correlationId=2) -- {topics=[],allow_auto_topic_creation=true},response:{throttle_time_ms=0,brokers=[{node_id=1001,host=172.31.31.3,port=9092,rack=null}],cluster_id=QiooE7cPQ-GwOKmM8lbPPg,controller_id=1001,topics=[]} from connection 172.31.31.3:9092-172.31.31.254:46530-11;totalTime:0.316,requestQueueTime:0.075,localTime:0.112,remoteTime:0.0,throttleTime:0.032,responseQueueTime:0.099,sendTime:0.029,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:03,335] DEBUG Completed request:RequestHeader(apiKey=FIND_COORDINATOR, apiVersion=2, clientId=rdkafka, correlationId=4) -- {key=kafka-tr-issue-201011-pr,key_type=0},response:{throttle_time_ms=0,error_code=0,error_message=NONE,node_id=1001,host=172.31.31.3,port=9092} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:0.316,requestQueueTime:0.144,localTime:0.08,remoteTime:0.0,throttleTime:0.026,responseQueueTime:0.069,sendTime:0.02,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:03,335] DEBUG Completed request:RequestHeader(apiKey=API_VERSIONS, apiVersion=3, clientId=rdkafka, correlationId=1) -- {client_software_name=confluent-kafka-python,client_software_version=1.5.0-rdkafka-1.5.0,_tagged_fields={}},response:{error_code=0,api_keys=[{api_key=0,min_version=0,max_version=8,_tagged_fields={}},{api_key=1,min_version=0,max_version=11,_tagged_fields={}},{api_key=2,min_version=0,max_version=5,_tagged_fields={}},{api_key=3,min_version=0,max_version=9,_tagged_fields={}},{api_key=4,min_version=0,max_version=4,_tagged_fields={}},{api_key=5,min_version=0,max_version=2,_tagged_fields={}},{api_key=6,min_version=0,max_version=6,_tagged_fields={}},{api_key=7,min_version=0,max_version=3,_tagged_fields={}},{api_key=8,min_version=0,max_version=8,_tagged_fields={}},{api_key=9,min_version=0,max_version=7,_tagged_fields={}},{api_key=10,min_version=0,max_version=3,_tagged_fields={}},{api_key=11,min_version=0,max_version=7,_tagged_fields={}},{api_key=12,min_version=0,max_version=4,_tagged_fields={}},{api_key=13,min_version=0,max_version=4,_tagged_fields={}},{api_key=14,min_version=0,max_version=5,_tagged_fields={}},{api_key=15,min_version=0,max_version=5,_tagged_fields={}},{api_key=16,min_version=0,max_version=3,_tagged_fields={}},{api_key=17,min_version=0,max_version=1,_tagged_fields={}},{api_key=18,min_version=0,max_version=3,_tagged_fields={}},{api_key=19,min_version=0,max_version=5,_tagged_fields={}},{api_key=20,min_version=0,max_version=4,_tagged_fields={}},{api_key=21,min_version=0,max_version=1,_tagged_fields={}},{api_key=22,min_version=0,max_version=3,_tagged_fields={}},{api_key=23,min_version=0,max_version=3,_tagged_fields={}},{api_key=24,min_version=0,max_version=1,_tagged_fields={}},{api_key=25,min_version=0,max_version=1,_tagged_fields={}},{api_key=26,min_version=0,max_version=1,_tagged_fields={}},{api_key=27,min_version=0,max_version=0,_tagged_fields={}},{api_key=28,min_version=0,max_version=3,_tagged_fields={}},{api_key=29,min_version=0,max_version=2,_tagged_fields={}},{api_key=30,min_version=0,max_version=2,_tagged_fields={}},{api_key=31,min_version=0,max_version=2,_tagged_fields={}},{api_key=32,min_version=0,max_version=2,_tagged_fields={}},{api_key=33,min_version=0,max_version=1,_tagged_fields={}},{api_key=34,min_version=0,max_version=1,_tagged_fields={}},{api_key=35,min_version=0,max_version=1,_tagged_fields={}},{api_key=36,min_version=0,max_version=2,_tagged_fields={}},{api_key=37,min_version=0,max_version=2,_tagged_fields={}},{api_key=38,min_version=0,max_version=2,_tagged_fields={}},{api_key=39,min_version=0,max_version=2,_tagged_fields={}},{api_key=40,min_version=0,max_version=2,_tagged_fields={}},{api_key=41,min_version=0,max_version=2,_tagged_fields={}},{api_key=42,min_version=0,max_version=2,_tagged_fields={}},{api_key=43,min_version=0,max_version=2,_tagged_fields={}},{api_key=44,min_version=0,max_version=1,_tagged_fields={}},{api_key=45,min_version=0,max_version=0,_tagged_fields={}},{api_key=46,min_version=0,max_version=0,_tagged_fields={}},{api_key=47,min_version=0,max_version=0,_tagged_fields={}}],throttle_time_ms=0,_tagged_fields={}} from connection 172.31.31.3:9092-172.31.31.254:46532-11;totalTime:0.257,requestQueueTime:0.13,localTime:0.071,remoteTime:0.0,throttleTime:0.065,responseQueueTime:0.019,sendTime:0.035,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:03,335] DEBUG Completed request:RequestHeader(apiKey=METADATA, apiVersion=4, clientId=rdkafka, correlationId=2) -- {topics=[],allow_auto_topic_creation=false},response:{throttle_time_ms=0,brokers=[{node_id=1001,host=172.31.31.3,port=9092,rack=null}],cluster_id=QiooE7cPQ-GwOKmM8lbPPg,controller_id=1001,topics=[]} from connection 172.31.31.3:9092-172.31.31.254:46532-11;totalTime:0.136,requestQueueTime:0.016,localTime:0.072,remoteTime:0.0,throttleTime:0.027,responseQueueTime:0.021,sendTime:0.025,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:03,335] DEBUG Completed request:RequestHeader(apiKey=METADATA, apiVersion=4, clientId=rdkafka, correlationId=5) -- {topics=[{name=demooutput1602758609}],allow_auto_topic_creation=false},response:{throttle_time_ms=0,brokers=[{node_id=1001,host=172.31.31.3,port=9092,rack=null}],cluster_id=QiooE7cPQ-GwOKmM8lbPPg,controller_id=1001,topics=[{error_code=0,name=demooutput1602758609,is_internal=false,partitions=[{error_code=0,partition_index=0,leader_id=1001,replica_nodes=[1001],isr_nodes=[1001]}]}]} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:0.198,requestQueueTime:0.015,localTime:0.143,remoteTime:0.0,throttleTime:0.049,responseQueueTime:0.01,sendTime:0.029,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:03,336] DEBUG [GroupCoordinator 1001]: Dynamic member with unknown member id joins group kafka-tr-issue-201011-pr in Empty state. Created a new member id rdkafka-a431afa2-c280-4b2b-ae77-52d6aadc21bd and request the member to rejoin with this id. (kafka.coordinator.group.GroupCoordinator)
[2020-10-15 11:05:03,336] DEBUG Completed request:RequestHeader(apiKey=JOIN_GROUP, apiVersion=5, clientId=rdkafka, correlationId=3) -- {group_id=kafka-tr-issue-201011-pr,session_timeout_ms=10000,rebalance_timeout_ms=300000,member_id=,group_instance_id=null,protocol_type=consumer,protocols=[{name=range,metadata=java.nio.HeapByteBuffer[pos=0 lim=38 cap=38]},{name=roundrobin,metadata=java.nio.HeapByteBuffer[pos=0 lim=38 cap=38]}]},response:{throttle_time_ms=0,error_code=79,generation_id=-1,protocol_name=,leader=,member_id=rdkafka-a431afa2-c280-4b2b-ae77-52d6aadc21bd,members=[]} from connection 172.31.31.3:9092-172.31.31.254:46532-11;totalTime:0.439,requestQueueTime:0.044,localTime:0.221,remoteTime:0.0,throttleTime:0.026,responseQueueTime:0.142,sendTime:0.031,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:03,336] DEBUG [GroupCoordinator 1001]: Dynamic Member with specific member id rdkafka-a431afa2-c280-4b2b-ae77-52d6aadc21bd joins group kafka-tr-issue-201011-pr in Empty state. Adding to the group now. (kafka.coordinator.group.GroupCoordinator)
[2020-10-15 11:05:03,337] DEBUG Request key MemberKey(kafka-tr-issue-201011-pr,rdkafka-a431afa2-c280-4b2b-ae77-52d6aadc21bd) unblocked 1 Heartbeat operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:03,337] INFO [GroupCoordinator 1001]: Preparing to rebalance group kafka-tr-issue-201011-pr in state PreparingRebalance with old generation 8 (__consumer_offsets-2) (reason: Adding new member rdkafka-a431afa2-c280-4b2b-ae77-52d6aadc21bd with group instance id None) (kafka.coordinator.group.GroupCoordinator)
[2020-10-15 11:05:03,337] DEBUG Request key GroupKey(kafka-tr-issue-201011-pr) unblocked 0 Rebalance operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:03,337] INFO [GroupCoordinator 1001]: Stabilized group kafka-tr-issue-201011-pr generation 9 (__consumer_offsets-2) (kafka.coordinator.group.GroupCoordinator)
[2020-10-15 11:05:03,337] DEBUG Request key MemberKey(kafka-tr-issue-201011-pr,rdkafka-a431afa2-c280-4b2b-ae77-52d6aadc21bd) unblocked 1 Heartbeat operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:03,338] DEBUG Completed request:RequestHeader(apiKey=JOIN_GROUP, apiVersion=5, clientId=rdkafka, correlationId=4) -- {group_id=kafka-tr-issue-201011-pr,session_timeout_ms=10000,rebalance_timeout_ms=300000,member_id=rdkafka-a431afa2-c280-4b2b-ae77-52d6aadc21bd,group_instance_id=null,protocol_type=consumer,protocols=[{name=range,metadata=java.nio.HeapByteBuffer[pos=0 lim=38 cap=38]},{name=roundrobin,metadata=java.nio.HeapByteBuffer[pos=0 lim=38 cap=38]}]},response:{throttle_time_ms=0,error_code=0,generation_id=9,protocol_name=range,leader=rdkafka-a431afa2-c280-4b2b-ae77-52d6aadc21bd,member_id=rdkafka-a431afa2-c280-4b2b-ae77-52d6aadc21bd,members=[{member_id=rdkafka-a431afa2-c280-4b2b-ae77-52d6aadc21bd,group_instance_id=null,metadata=java.nio.HeapByteBuffer[pos=0 lim=38 cap=38]}]} from connection 172.31.31.3:9092-172.31.31.254:46532-11;totalTime:1.275,requestQueueTime:0.071,localTime:0.556,remoteTime:0.47,throttleTime:0.061,responseQueueTime:0.017,sendTime:0.097,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:03,338] DEBUG Completed request:RequestHeader(apiKey=METADATA, apiVersion=4, clientId=rdkafka, correlationId=5) -- {topics=[{name=demooutput1602758609}],allow_auto_topic_creation=false},response:{throttle_time_ms=0,brokers=[{node_id=1001,host=172.31.31.3,port=9092,rack=null}],cluster_id=QiooE7cPQ-GwOKmM8lbPPg,controller_id=1001,topics=[{error_code=0,name=demooutput1602758609,is_internal=false,partitions=[{error_code=0,partition_index=0,leader_id=1001,replica_nodes=[1001],isr_nodes=[1001]}]}]} from connection 172.31.31.3:9092-172.31.31.254:46532-11;totalTime:0.293,requestQueueTime:0.023,localTime:0.212,remoteTime:0.0,throttleTime:0.068,responseQueueTime:0.013,sendTime:0.043,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:03,338] INFO [GroupCoordinator 1001]: Assignment received from leader for group kafka-tr-issue-201011-pr for generation 9 (kafka.coordinator.group.GroupCoordinator)
[2020-10-15 11:05:03,338] DEBUG [Partition __consumer_offsets-2 broker=1001] High watermark updated from (offset=13 segment=[0:2689]) to (offset=14 segment=[0:3041]) (kafka.cluster.Partition)
[2020-10-15 11:05:03,338] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,2) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:03,338] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,2) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:03,338] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,2) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:03,338] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:03,339] DEBUG Request key MemberKey(kafka-tr-issue-201011-pr,rdkafka-a431afa2-c280-4b2b-ae77-52d6aadc21bd) unblocked 1 Heartbeat operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:03,339] DEBUG Completed request:RequestHeader(apiKey=SYNC_GROUP, apiVersion=3, clientId=rdkafka, correlationId=6) -- {group_id=kafka-tr-issue-201011-pr,generation_id=9,member_id=rdkafka-a431afa2-c280-4b2b-ae77-52d6aadc21bd,group_instance_id=null,assignments=[{member_id=rdkafka-a431afa2-c280-4b2b-ae77-52d6aadc21bd,assignment=java.nio.HeapByteBuffer[pos=0 lim=46 cap=46]}]},response:{throttle_time_ms=0,error_code=0,assignment=java.nio.HeapByteBuffer[pos=0 lim=46 cap=46]} from connection 172.31.31.3:9092-172.31.31.254:46532-11;totalTime:0.781,requestQueueTime:0.022,localTime:0.569,remoteTime:0.0,throttleTime:0.019,responseQueueTime:0.013,sendTime:0.176,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:03,339] DEBUG Request key MemberKey(kafka-tr-issue-201011-pr,rdkafka-a431afa2-c280-4b2b-ae77-52d6aadc21bd) unblocked 1 Heartbeat operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:03,339] DEBUG Completed request:RequestHeader(apiKey=HEARTBEAT, apiVersion=3, clientId=rdkafka, correlationId=7) -- {group_id=kafka-tr-issue-201011-pr,generation_id=9,member_id=rdkafka-a431afa2-c280-4b2b-ae77-52d6aadc21bd,group_instance_id=null},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46532-11;totalTime:0.19,requestQueueTime:0.022,localTime:0.137,remoteTime:0.0,throttleTime:0.014,responseQueueTime:0.005,sendTime:0.023,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:03,384] DEBUG Processor 0 listening to new connection from /172.31.31.254:46534 (kafka.network.Processor)
[2020-10-15 11:05:03,384] DEBUG Accepted connection from /172.31.31.254:46534 on /172.31.31.3:9092 and assigned it to processor 0, sendBufferSize [actual|requested]: [102400|102400] recvBufferSize [actual|requested]: [102400|102400] (kafka.network.Acceptor)
[2020-10-15 11:05:03,384] DEBUG Completed request:RequestHeader(apiKey=API_VERSIONS, apiVersion=3, clientId=rdkafka, correlationId=1) -- {client_software_name=confluent-kafka-python,client_software_version=1.5.0-rdkafka-1.5.0,_tagged_fields={}},response:{error_code=0,api_keys=[{api_key=0,min_version=0,max_version=8,_tagged_fields={}},{api_key=1,min_version=0,max_version=11,_tagged_fields={}},{api_key=2,min_version=0,max_version=5,_tagged_fields={}},{api_key=3,min_version=0,max_version=9,_tagged_fields={}},{api_key=4,min_version=0,max_version=4,_tagged_fields={}},{api_key=5,min_version=0,max_version=2,_tagged_fields={}},{api_key=6,min_version=0,max_version=6,_tagged_fields={}},{api_key=7,min_version=0,max_version=3,_tagged_fields={}},{api_key=8,min_version=0,max_version=8,_tagged_fields={}},{api_key=9,min_version=0,max_version=7,_tagged_fields={}},{api_key=10,min_version=0,max_version=3,_tagged_fields={}},{api_key=11,min_version=0,max_version=7,_tagged_fields={}},{api_key=12,min_version=0,max_version=4,_tagged_fields={}},{api_key=13,min_version=0,max_version=4,_tagged_fields={}},{api_key=14,min_version=0,max_version=5,_tagged_fields={}},{api_key=15,min_version=0,max_version=5,_tagged_fields={}},{api_key=16,min_version=0,max_version=3,_tagged_fields={}},{api_key=17,min_version=0,max_version=1,_tagged_fields={}},{api_key=18,min_version=0,max_version=3,_tagged_fields={}},{api_key=19,min_version=0,max_version=5,_tagged_fields={}},{api_key=20,min_version=0,max_version=4,_tagged_fields={}},{api_key=21,min_version=0,max_version=1,_tagged_fields={}},{api_key=22,min_version=0,max_version=3,_tagged_fields={}},{api_key=23,min_version=0,max_version=3,_tagged_fields={}},{api_key=24,min_version=0,max_version=1,_tagged_fields={}},{api_key=25,min_version=0,max_version=1,_tagged_fields={}},{api_key=26,min_version=0,max_version=1,_tagged_fields={}},{api_key=27,min_version=0,max_version=0,_tagged_fields={}},{api_key=28,min_version=0,max_version=3,_tagged_fields={}},{api_key=29,min_version=0,max_version=2,_tagged_fields={}},{api_key=30,min_version=0,max_version=2,_tagged_fields={}},{api_key=31,min_version=0,max_version=2,_tagged_fields={}},{api_key=32,min_version=0,max_version=2,_tagged_fields={}},{api_key=33,min_version=0,max_version=1,_tagged_fields={}},{api_key=34,min_version=0,max_version=1,_tagged_fields={}},{api_key=35,min_version=0,max_version=1,_tagged_fields={}},{api_key=36,min_version=0,max_version=2,_tagged_fields={}},{api_key=37,min_version=0,max_version=2,_tagged_fields={}},{api_key=38,min_version=0,max_version=2,_tagged_fields={}},{api_key=39,min_version=0,max_version=2,_tagged_fields={}},{api_key=40,min_version=0,max_version=2,_tagged_fields={}},{api_key=41,min_version=0,max_version=2,_tagged_fields={}},{api_key=42,min_version=0,max_version=2,_tagged_fields={}},{api_key=43,min_version=0,max_version=2,_tagged_fields={}},{api_key=44,min_version=0,max_version=1,_tagged_fields={}},{api_key=45,min_version=0,max_version=0,_tagged_fields={}},{api_key=46,min_version=0,max_version=0,_tagged_fields={}},{api_key=47,min_version=0,max_version=0,_tagged_fields={}}],throttle_time_ms=0,_tagged_fields={}} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:0.273,requestQueueTime:0.056,localTime:0.155,remoteTime:0.0,throttleTime:0.147,responseQueueTime:0.019,sendTime:0.041,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:03,385] DEBUG Processor 1 listening to new connection from /172.31.31.254:46536 (kafka.network.Processor)
[2020-10-15 11:05:03,385] DEBUG Accepted connection from /172.31.31.254:46536 on /172.31.31.3:9092 and assigned it to processor 1, sendBufferSize [actual|requested]: [102400|102400] recvBufferSize [actual|requested]: [102400|102400] (kafka.network.Acceptor)
[2020-10-15 11:05:03,385] DEBUG Completed request:RequestHeader(apiKey=METADATA, apiVersion=4, clientId=rdkafka, correlationId=2) -- {topics=[{name=demoinput1602758609}],allow_auto_topic_creation=false},response:{throttle_time_ms=0,brokers=[{node_id=1001,host=172.31.31.3,port=9092,rack=null}],cluster_id=QiooE7cPQ-GwOKmM8lbPPg,controller_id=1001,topics=[{error_code=0,name=demoinput1602758609,is_internal=false,partitions=[{error_code=0,partition_index=0,leader_id=1001,replica_nodes=[1001],isr_nodes=[1001]}]}]} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:0.414,requestQueueTime:0.036,localTime:0.327,remoteTime:0.0,throttleTime:0.109,responseQueueTime:0.017,sendTime:0.032,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:03,385] DEBUG Completed request:RequestHeader(apiKey=API_VERSIONS, apiVersion=3, clientId=rdkafka, correlationId=1) -- {client_software_name=confluent-kafka-python,client_software_version=1.5.0-rdkafka-1.5.0,_tagged_fields={}},response:{error_code=0,api_keys=[{api_key=0,min_version=0,max_version=8,_tagged_fields={}},{api_key=1,min_version=0,max_version=11,_tagged_fields={}},{api_key=2,min_version=0,max_version=5,_tagged_fields={}},{api_key=3,min_version=0,max_version=9,_tagged_fields={}},{api_key=4,min_version=0,max_version=4,_tagged_fields={}},{api_key=5,min_version=0,max_version=2,_tagged_fields={}},{api_key=6,min_version=0,max_version=6,_tagged_fields={}},{api_key=7,min_version=0,max_version=3,_tagged_fields={}},{api_key=8,min_version=0,max_version=8,_tagged_fields={}},{api_key=9,min_version=0,max_version=7,_tagged_fields={}},{api_key=10,min_version=0,max_version=3,_tagged_fields={}},{api_key=11,min_version=0,max_version=7,_tagged_fields={}},{api_key=12,min_version=0,max_version=4,_tagged_fields={}},{api_key=13,min_version=0,max_version=4,_tagged_fields={}},{api_key=14,min_version=0,max_version=5,_tagged_fields={}},{api_key=15,min_version=0,max_version=5,_tagged_fields={}},{api_key=16,min_version=0,max_version=3,_tagged_fields={}},{api_key=17,min_version=0,max_version=1,_tagged_fields={}},{api_key=18,min_version=0,max_version=3,_tagged_fields={}},{api_key=19,min_version=0,max_version=5,_tagged_fields={}},{api_key=20,min_version=0,max_version=4,_tagged_fields={}},{api_key=21,min_version=0,max_version=1,_tagged_fields={}},{api_key=22,min_version=0,max_version=3,_tagged_fields={}},{api_key=23,min_version=0,max_version=3,_tagged_fields={}},{api_key=24,min_version=0,max_version=1,_tagged_fields={}},{api_key=25,min_version=0,max_version=1,_tagged_fields={}},{api_key=26,min_version=0,max_version=1,_tagged_fields={}},{api_key=27,min_version=0,max_version=0,_tagged_fields={}},{api_key=28,min_version=0,max_version=3,_tagged_fields={}},{api_key=29,min_version=0,max_version=2,_tagged_fields={}},{api_key=30,min_version=0,max_version=2,_tagged_fields={}},{api_key=31,min_version=0,max_version=2,_tagged_fields={}},{api_key=32,min_version=0,max_version=2,_tagged_fields={}},{api_key=33,min_version=0,max_version=1,_tagged_fields={}},{api_key=34,min_version=0,max_version=1,_tagged_fields={}},{api_key=35,min_version=0,max_version=1,_tagged_fields={}},{api_key=36,min_version=0,max_version=2,_tagged_fields={}},{api_key=37,min_version=0,max_version=2,_tagged_fields={}},{api_key=38,min_version=0,max_version=2,_tagged_fields={}},{api_key=39,min_version=0,max_version=2,_tagged_fields={}},{api_key=40,min_version=0,max_version=2,_tagged_fields={}},{api_key=41,min_version=0,max_version=2,_tagged_fields={}},{api_key=42,min_version=0,max_version=2,_tagged_fields={}},{api_key=43,min_version=0,max_version=2,_tagged_fields={}},{api_key=44,min_version=0,max_version=1,_tagged_fields={}},{api_key=45,min_version=0,max_version=0,_tagged_fields={}},{api_key=46,min_version=0,max_version=0,_tagged_fields={}},{api_key=47,min_version=0,max_version=0,_tagged_fields={}}],throttle_time_ms=0,_tagged_fields={}} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.142,requestQueueTime:0.045,localTime:0.057,remoteTime:0.0,throttleTime:0.054,responseQueueTime:0.01,sendTime:0.029,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:03,386] DEBUG Completed request:RequestHeader(apiKey=METADATA, apiVersion=4, clientId=rdkafka, correlationId=2) -- {topics=[],allow_auto_topic_creation=true},response:{throttle_time_ms=0,brokers=[{node_id=1001,host=172.31.31.3,port=9092,rack=null}],cluster_id=QiooE7cPQ-GwOKmM8lbPPg,controller_id=1001,topics=[]} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.143,requestQueueTime:0.018,localTime:0.086,remoteTime:0.0,throttleTime:0.035,responseQueueTime:0.01,sendTime:0.027,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:03,386] DEBUG Completed request:RequestHeader(apiKey=FIND_COORDINATOR, apiVersion=2, clientId=rdkafka, correlationId=3) -- {key=eos-transactions.py,key_type=1},response:{throttle_time_ms=0,error_code=0,error_message=NONE,node_id=1001,host=172.31.31.3,port=9092} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.252,requestQueueTime:0.019,localTime:0.125,remoteTime:0.0,throttleTime:0.052,responseQueueTime:0.063,sendTime:0.043,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:03,387] DEBUG Completed request:RequestHeader(apiKey=METADATA, apiVersion=4, clientId=rdkafka, correlationId=4) -- {topics=[],allow_auto_topic_creation=true},response:{throttle_time_ms=0,brokers=[{node_id=1001,host=172.31.31.3,port=9092,rack=null}],cluster_id=QiooE7cPQ-GwOKmM8lbPPg,controller_id=1001,topics=[]} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.218,requestQueueTime:0.017,localTime:0.086,remoteTime:0.0,throttleTime:0.037,responseQueueTime:0.086,sendTime:0.028,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:03,387] DEBUG Completed request:RequestHeader(apiKey=FIND_COORDINATOR, apiVersion=2, clientId=rdkafka, correlationId=3) -- {key=kafka-tr-issue-201011-tr,key_type=0},response:{throttle_time_ms=0,error_code=0,error_message=NONE,node_id=1001,host=172.31.31.3,port=9092} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:0.158,requestQueueTime:0.018,localTime:0.097,remoteTime:0.0,throttleTime:0.033,responseQueueTime:0.011,sendTime:0.03,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:03,387] DEBUG Processor 2 listening to new connection from /172.31.31.254:46538 (kafka.network.Processor)
[2020-10-15 11:05:03,387] DEBUG Accepted connection from /172.31.31.254:46538 on /172.31.31.3:9092 and assigned it to processor 2, sendBufferSize [actual|requested]: [102400|102400] recvBufferSize [actual|requested]: [102400|102400] (kafka.network.Acceptor)
[2020-10-15 11:05:03,388] DEBUG Completed request:RequestHeader(apiKey=FIND_COORDINATOR, apiVersion=2, clientId=rdkafka, correlationId=4) -- {key=kafka-tr-issue-201011-tr,key_type=0},response:{throttle_time_ms=0,error_code=0,error_message=NONE,node_id=1001,host=172.31.31.3,port=9092} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:0.537,requestQueueTime:0.046,localTime:0.309,remoteTime:0.0,throttleTime:0.106,responseQueueTime:0.03,sendTime:0.151,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:03,388] DEBUG Completed request:RequestHeader(apiKey=API_VERSIONS, apiVersion=3, clientId=rdkafka, correlationId=1) -- {client_software_name=confluent-kafka-python,client_software_version=1.5.0-rdkafka-1.5.0,_tagged_fields={}},response:{error_code=0,api_keys=[{api_key=0,min_version=0,max_version=8,_tagged_fields={}},{api_key=1,min_version=0,max_version=11,_tagged_fields={}},{api_key=2,min_version=0,max_version=5,_tagged_fields={}},{api_key=3,min_version=0,max_version=9,_tagged_fields={}},{api_key=4,min_version=0,max_version=4,_tagged_fields={}},{api_key=5,min_version=0,max_version=2,_tagged_fields={}},{api_key=6,min_version=0,max_version=6,_tagged_fields={}},{api_key=7,min_version=0,max_version=3,_tagged_fields={}},{api_key=8,min_version=0,max_version=8,_tagged_fields={}},{api_key=9,min_version=0,max_version=7,_tagged_fields={}},{api_key=10,min_version=0,max_version=3,_tagged_fields={}},{api_key=11,min_version=0,max_version=7,_tagged_fields={}},{api_key=12,min_version=0,max_version=4,_tagged_fields={}},{api_key=13,min_version=0,max_version=4,_tagged_fields={}},{api_key=14,min_version=0,max_version=5,_tagged_fields={}},{api_key=15,min_version=0,max_version=5,_tagged_fields={}},{api_key=16,min_version=0,max_version=3,_tagged_fields={}},{api_key=17,min_version=0,max_version=1,_tagged_fields={}},{api_key=18,min_version=0,max_version=3,_tagged_fields={}},{api_key=19,min_version=0,max_version=5,_tagged_fields={}},{api_key=20,min_version=0,max_version=4,_tagged_fields={}},{api_key=21,min_version=0,max_version=1,_tagged_fields={}},{api_key=22,min_version=0,max_version=3,_tagged_fields={}},{api_key=23,min_version=0,max_version=3,_tagged_fields={}},{api_key=24,min_version=0,max_version=1,_tagged_fields={}},{api_key=25,min_version=0,max_version=1,_tagged_fields={}},{api_key=26,min_version=0,max_version=1,_tagged_fields={}},{api_key=27,min_version=0,max_version=0,_tagged_fields={}},{api_key=28,min_version=0,max_version=3,_tagged_fields={}},{api_key=29,min_version=0,max_version=2,_tagged_fields={}},{api_key=30,min_version=0,max_version=2,_tagged_fields={}},{api_key=31,min_version=0,max_version=2,_tagged_fields={}},{api_key=32,min_version=0,max_version=2,_tagged_fields={}},{api_key=33,min_version=0,max_version=1,_tagged_fields={}},{api_key=34,min_version=0,max_version=1,_tagged_fields={}},{api_key=35,min_version=0,max_version=1,_tagged_fields={}},{api_key=36,min_version=0,max_version=2,_tagged_fields={}},{api_key=37,min_version=0,max_version=2,_tagged_fields={}},{api_key=38,min_version=0,max_version=2,_tagged_fields={}},{api_key=39,min_version=0,max_version=2,_tagged_fields={}},{api_key=40,min_version=0,max_version=2,_tagged_fields={}},{api_key=41,min_version=0,max_version=2,_tagged_fields={}},{api_key=42,min_version=0,max_version=2,_tagged_fields={}},{api_key=43,min_version=0,max_version=2,_tagged_fields={}},{api_key=44,min_version=0,max_version=1,_tagged_fields={}},{api_key=45,min_version=0,max_version=0,_tagged_fields={}},{api_key=46,min_version=0,max_version=0,_tagged_fields={}},{api_key=47,min_version=0,max_version=0,_tagged_fields={}}],throttle_time_ms=0,_tagged_fields={}} from connection 172.31.31.3:9092-172.31.31.254:46538-12;totalTime:0.155,requestQueueTime:0.04,localTime:0.069,remoteTime:0.0,throttleTime:0.066,responseQueueTime:0.007,sendTime:0.037,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:03,388] DEBUG Completed request:RequestHeader(apiKey=FIND_COORDINATOR, apiVersion=2, clientId=rdkafka, correlationId=5) -- {key=eos-transactions.py,key_type=1},response:{throttle_time_ms=0,error_code=0,error_message=NONE,node_id=1001,host=172.31.31.3,port=9092} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.354,requestQueueTime:0.074,localTime:0.118,remoteTime:0.0,throttleTime:0.045,responseQueueTime:0.13,sendTime:0.03,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:03,388] DEBUG Processor 0 listening to new connection from /172.31.31.254:46540 (kafka.network.Processor)
[2020-10-15 11:05:03,388] DEBUG Accepted connection from /172.31.31.254:46540 on /172.31.31.3:9092 and assigned it to processor 0, sendBufferSize [actual|requested]: [102400|102400] recvBufferSize [actual|requested]: [102400|102400] (kafka.network.Acceptor)
[2020-10-15 11:05:03,389] DEBUG Completed request:RequestHeader(apiKey=API_VERSIONS, apiVersion=3, clientId=rdkafka, correlationId=1) -- {client_software_name=confluent-kafka-python,client_software_version=1.5.0-rdkafka-1.5.0,_tagged_fields={}},response:{error_code=0,api_keys=[{api_key=0,min_version=0,max_version=8,_tagged_fields={}},{api_key=1,min_version=0,max_version=11,_tagged_fields={}},{api_key=2,min_version=0,max_version=5,_tagged_fields={}},{api_key=3,min_version=0,max_version=9,_tagged_fields={}},{api_key=4,min_version=0,max_version=4,_tagged_fields={}},{api_key=5,min_version=0,max_version=2,_tagged_fields={}},{api_key=6,min_version=0,max_version=6,_tagged_fields={}},{api_key=7,min_version=0,max_version=3,_tagged_fields={}},{api_key=8,min_version=0,max_version=8,_tagged_fields={}},{api_key=9,min_version=0,max_version=7,_tagged_fields={}},{api_key=10,min_version=0,max_version=3,_tagged_fields={}},{api_key=11,min_version=0,max_version=7,_tagged_fields={}},{api_key=12,min_version=0,max_version=4,_tagged_fields={}},{api_key=13,min_version=0,max_version=4,_tagged_fields={}},{api_key=14,min_version=0,max_version=5,_tagged_fields={}},{api_key=15,min_version=0,max_version=5,_tagged_fields={}},{api_key=16,min_version=0,max_version=3,_tagged_fields={}},{api_key=17,min_version=0,max_version=1,_tagged_fields={}},{api_key=18,min_version=0,max_version=3,_tagged_fields={}},{api_key=19,min_version=0,max_version=5,_tagged_fields={}},{api_key=20,min_version=0,max_version=4,_tagged_fields={}},{api_key=21,min_version=0,max_version=1,_tagged_fields={}},{api_key=22,min_version=0,max_version=3,_tagged_fields={}},{api_key=23,min_version=0,max_version=3,_tagged_fields={}},{api_key=24,min_version=0,max_version=1,_tagged_fields={}},{api_key=25,min_version=0,max_version=1,_tagged_fields={}},{api_key=26,min_version=0,max_version=1,_tagged_fields={}},{api_key=27,min_version=0,max_version=0,_tagged_fields={}},{api_key=28,min_version=0,max_version=3,_tagged_fields={}},{api_key=29,min_version=0,max_version=2,_tagged_fields={}},{api_key=30,min_version=0,max_version=2,_tagged_fields={}},{api_key=31,min_version=0,max_version=2,_tagged_fields={}},{api_key=32,min_version=0,max_version=2,_tagged_fields={}},{api_key=33,min_version=0,max_version=1,_tagged_fields={}},{api_key=34,min_version=0,max_version=1,_tagged_fields={}},{api_key=35,min_version=0,max_version=1,_tagged_fields={}},{api_key=36,min_version=0,max_version=2,_tagged_fields={}},{api_key=37,min_version=0,max_version=2,_tagged_fields={}},{api_key=38,min_version=0,max_version=2,_tagged_fields={}},{api_key=39,min_version=0,max_version=2,_tagged_fields={}},{api_key=40,min_version=0,max_version=2,_tagged_fields={}},{api_key=41,min_version=0,max_version=2,_tagged_fields={}},{api_key=42,min_version=0,max_version=2,_tagged_fields={}},{api_key=43,min_version=0,max_version=2,_tagged_fields={}},{api_key=44,min_version=0,max_version=1,_tagged_fields={}},{api_key=45,min_version=0,max_version=0,_tagged_fields={}},{api_key=46,min_version=0,max_version=0,_tagged_fields={}},{api_key=47,min_version=0,max_version=0,_tagged_fields={}}],throttle_time_ms=0,_tagged_fields={}} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.151,requestQueueTime:0.041,localTime:0.057,remoteTime:0.0,throttleTime:0.054,responseQueueTime:0.012,sendTime:0.04,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:03,389] DEBUG Completed request:RequestHeader(apiKey=METADATA, apiVersion=4, clientId=rdkafka, correlationId=2) -- {topics=[],allow_auto_topic_creation=true},response:{throttle_time_ms=0,brokers=[{node_id=1001,host=172.31.31.3,port=9092,rack=null}],cluster_id=QiooE7cPQ-GwOKmM8lbPPg,controller_id=1001,topics=[]} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.255,requestQueueTime:0.024,localTime:0.174,remoteTime:0.0,throttleTime:0.078,responseQueueTime:0.015,sendTime:0.04,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:03,389] DEBUG Completed request:RequestHeader(apiKey=OFFSET_FETCH, apiVersion=1, clientId=rdkafka, correlationId=2) -- {group_id=kafka-tr-issue-201011-tr,topics=[{name=demoinput1602758609,partition_indexes=[0]}]},response:{topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=80,metadata=,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46538-12;totalTime:0.212,requestQueueTime:0.03,localTime:0.125,remoteTime:0.0,throttleTime:0.119,responseQueueTime:0.015,sendTime:0.04,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:03,389] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Empty, topicPartitions=Set(), txnStartTimestamp=-1, txnLastUpdateTimestamp=1602759903389) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:03,389] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:03,389] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=324 segment=[0:54956]) to (offset=325 segment=[0:55085]) (kafka.cluster.Partition)
[2020-10-15 11:05:03,390] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:03,390] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:03,390] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:03,390] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:03,390] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Empty, topicPartitions=Set(), txnStartTimestamp=-1, txnLastUpdateTimestamp=1602759903389) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:03,390] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Empty, topicPartitions=Set(), txnStartTimestamp=-1, txnLastUpdateTimestamp=1602759903389) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:03,390] INFO [TransactionCoordinator id=1001] Initialized transactionalId eos-transactions.py with producerId 0 and producer epoch 4 on partition __transaction_state-26 (kafka.coordinator.transaction.TransactionCoordinator)
[2020-10-15 11:05:03,390] DEBUG Completed request:RequestHeader(apiKey=INIT_PRODUCER_ID, apiVersion=1, clientId=rdkafka, correlationId=3) -- {transactional_id=eos-transactions.py,transaction_timeout_ms=60000},response:{throttle_time_ms=0,error_code=0,producer_id=0,producer_epoch=4} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.743,requestQueueTime:0.017,localTime:0.668,remoteTime:0.0,throttleTime:0.02,responseQueueTime:0.01,sendTime:0.046,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:03,887] DEBUG Completed request:RequestHeader(apiKey=FIND_COORDINATOR, apiVersion=2, clientId=rdkafka, correlationId=6) -- {key=eos-transactions.py,key_type=1},response:{throttle_time_ms=0,error_code=0,error_message=NONE,node_id=1001,host=172.31.31.3,port=9092} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.501,requestQueueTime:0.049,localTime:0.313,remoteTime:0.0,throttleTime:0.104,responseQueueTime:0.023,sendTime:0.115,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:03,890] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:03,891] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=5) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=80,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=80,last_stable_offset=80,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=MemoryRecords(size=0, buffer=java.nio.HeapByteBuffer[pos=0 lim=0 cap=0])}]}]} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:501.413,requestQueueTime:0.073,localTime:0.251,remoteTime:500.718,throttleTime:0.175,responseQueueTime:0.039,sendTime:0.154,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:03,891] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:04,391] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:04,391] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=6) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=80,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=80,last_stable_offset=80,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=MemoryRecords(size=0, buffer=java.nio.HeapByteBuffer[pos=0 lim=0 cap=0])}]}]} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:500.268,requestQueueTime:0.064,localTime:0.262,remoteTime:499.503,throttleTime:0.234,responseQueueTime:0.032,sendTime:0.169,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:04,391] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:04,892] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:04,893] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=7) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=80,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=80,last_stable_offset=80,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=MemoryRecords(size=0, buffer=java.nio.HeapByteBuffer[pos=0 lim=0 cap=0])}]}]} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:501.218,requestQueueTime:0.063,localTime:0.247,remoteTime:500.398,throttleTime:0.248,responseQueueTime:0.082,sendTime:0.177,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:04,893] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,333] DEBUG Completed request:RequestHeader(apiKey=METADATA, apiVersion=4, clientId=rdkafka, correlationId=3) -- {topics=[{name=demoinput1602758609}],allow_auto_topic_creation=true},response:{throttle_time_ms=0,brokers=[{node_id=1001,host=172.31.31.3,port=9092,rack=null}],cluster_id=QiooE7cPQ-GwOKmM8lbPPg,controller_id=1001,topics=[{error_code=0,name=demoinput1602758609,is_internal=false,partitions=[{error_code=0,partition_index=0,leader_id=1001,replica_nodes=[1001],isr_nodes=[1001]}]}]} from connection 172.31.31.3:9092-172.31.31.254:46530-11;totalTime:0.667,requestQueueTime:0.087,localTime:0.485,remoteTime:0.0,throttleTime:0.187,responseQueueTime:0.023,sendTime:0.072,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,333] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=80 segment=[0:5720]) to (offset=81 segment=[0:5791]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,333] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,334] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,334] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,334] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,334] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,334] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=4) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=80,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46530-11;totalTime:1.177,requestQueueTime:0.053,localTime:1.062,remoteTime:0.0,throttleTime:0.052,responseQueueTime:0.016,sendTime:0.045,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,334] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=8) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=80,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=81,last_stable_offset=81,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=71, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=5720, end=5791)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:441.165,requestQueueTime:0.062,localTime:0.191,remoteTime:440.499,throttleTime:0.144,responseQueueTime:0.041,sendTime:0.225,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,334] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,334] DEBUG Completed request:RequestHeader(apiKey=OFFSET_FETCH, apiVersion=1, clientId=rdkafka, correlationId=8) -- {group_id=kafka-tr-issue-201011-pr,topics=[{name=demooutput1602758609,partition_indexes=[0]}]},response:{topics=[{name=demooutput1602758609,partitions=[{partition_index=0,committed_offset=160,metadata=,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46532-11;totalTime:0.276,requestQueueTime:0.036,localTime:0.163,remoteTime:0.0,throttleTime:0.155,responseQueueTime:0.018,sendTime:0.057,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,335] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,335] DEBUG TransactionalId eos-transactions.py prepare transition from Empty to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905335, txnLastUpdateTimestamp=1602759905335) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,335] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=325 segment=[0:55085]) to (offset=326 segment=[0:55243]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,335] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,335] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,335] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,335] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,335] DEBUG TransactionalId eos-transactions.py complete transition from Empty to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905335, txnLastUpdateTimestamp=1602759905335) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,335] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905335, txnLastUpdateTimestamp=1602759905335) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,335] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=4) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.939,requestQueueTime:0.021,localTime:0.83,remoteTime:0.0,throttleTime:0.031,responseQueueTime:0.019,sendTime:0.068,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,336] DEBUG Completed request:RequestHeader(apiKey=FIND_COORDINATOR, apiVersion=2, clientId=rdkafka, correlationId=7) -- {key=kafka-tr-issue-201011-tr,key_type=0},response:{throttle_time_ms=0,error_code=0,error_message=NONE,node_id=1001,host=172.31.31.3,port=9092} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.352,requestQueueTime:0.028,localTime:0.241,remoteTime:0.0,throttleTime:0.075,responseQueueTime:0.021,sendTime:0.06,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,337] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=160 segment=[0:18480])) (kafka.log.Log)
[2020-10-15 11:05:05,337] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=160 segment=[0:18480]) to (offset=161 segment=[0:18633]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,337] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,337] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,337] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,337] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,337] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=8) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=4,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=81,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.895,requestQueueTime:0.044,localTime:0.785,remoteTime:0.0,throttleTime:0.054,responseQueueTime:0.017,sendTime:0.048,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,385] DEBUG Completed request:RequestHeader(apiKey=METADATA, apiVersion=4, clientId=rdkafka, correlationId=9) -- {topics=[{name=demooutput1602758609}],allow_auto_topic_creation=true},response:{throttle_time_ms=0,brokers=[{node_id=1001,host=172.31.31.3,port=9092,rack=null}],cluster_id=QiooE7cPQ-GwOKmM8lbPPg,controller_id=1001,topics=[{error_code=0,name=demooutput1602758609,is_internal=false,partitions=[{error_code=0,partition_index=0,leader_id=1001,replica_nodes=[1001],isr_nodes=[1001]}]}]} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.465,requestQueueTime:0.036,localTime:0.356,remoteTime:0.0,throttleTime:0.122,responseQueueTime:0.022,sendTime:0.05,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,386] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905335, txnLastUpdateTimestamp=1602759905386) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,386] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=326 segment=[0:55243]) to (offset=327 segment=[0:55437]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,386] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,386] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,386] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,386] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,386] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905335, txnLastUpdateTimestamp=1602759905386) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,386] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905335, txnLastUpdateTimestamp=1602759905386) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,387] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=5) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.826,requestQueueTime:0.027,localTime:0.704,remoteTime:0.0,throttleTime:0.049,responseQueueTime:0.029,sendTime:0.065,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,387] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=160 segment=[0:12320])) (kafka.log.Log)
[2020-10-15 11:05:05,387] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=160 segment=[0:12320]) to (offset=161 segment=[0:12396]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,387] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,387] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,387] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,387] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,387] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=10) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=160,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.629,requestQueueTime:0.056,localTime:0.484,remoteTime:0.0,throttleTime:0.051,responseQueueTime:0.022,sendTime:0.065,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,388] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905335, txnLastUpdateTimestamp=1602759905388) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,388] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=327 segment=[0:55437]) to (offset=328 segment=[0:55631]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,388] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,388] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,388] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,388] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,388] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905335, txnLastUpdateTimestamp=1602759905388) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,388] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905335, txnLastUpdateTimestamp=1602759905388) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,388] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905335, txnLastUpdateTimestamp=1602759905388) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,388] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=6) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.501,requestQueueTime:0.027,localTime:0.389,remoteTime:0.0,throttleTime:0.017,responseQueueTime:0.028,sendTime:0.055,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,389] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,389] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=161 segment=[0:12396]) to (offset=162 segment=[0:12474]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,389] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,389] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,389] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,389] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,389] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,389] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=161 segment=[0:18633]) to (offset=162 segment=[0:18711]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,389] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,389] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,389] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,389] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=6) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=160,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=162,last_stable_offset=162,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=12320, end=12474)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:54.932,requestQueueTime:0.043,localTime:0.13,remoteTime:54.436,throttleTime:0.139,responseQueueTime:0.023,sendTime:0.16,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,389] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,390] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 11:05:05,390] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,390] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=80) -- {transaction_markers=[{producer_id=0,producer_epoch=4,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.339,requestQueueTime:0.042,localTime:1.214,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.022,sendTime:0.061,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:05,390] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759905390, latencyMs=2, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=80), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@7fd4ed5e) from node 1001 with correlation id 80 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 11:05:05,390] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=4, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759905335, txnLastUpdateTimestamp=1602759905388) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 11:05:05,390] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=328 segment=[0:55631]) to (offset=329 segment=[0:55760]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,390] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,390] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,390] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,390] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,390] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905335, txnLastUpdateTimestamp=1602759905388) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,391] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905335, txnLastUpdateTimestamp=1602759905388) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,391] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,395] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=81 segment=[0:5791]) to (offset=82 segment=[0:5862]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,395] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,395] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,395] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,395] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,395] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,395] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=9) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=81,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=82,last_stable_offset=82,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=71, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=5791, end=5862)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:61.086,requestQueueTime:0.083,localTime:0.268,remoteTime:60.52,throttleTime:0.059,responseQueueTime:0.015,sendTime:0.138,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,395] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=5) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=81,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46530-11;totalTime:0.513,requestQueueTime:0.039,localTime:0.388,remoteTime:0.0,throttleTime:0.025,responseQueueTime:0.026,sendTime:0.059,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,395] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,396] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905396, txnLastUpdateTimestamp=1602759905396) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,396] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=329 segment=[0:55760]) to (offset=330 segment=[0:55918]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,396] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,396] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,396] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,396] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,396] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905396, txnLastUpdateTimestamp=1602759905396) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,396] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905396, txnLastUpdateTimestamp=1602759905396) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,396] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=7) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.64,requestQueueTime:0.024,localTime:0.533,remoteTime:0.0,throttleTime:0.089,responseQueueTime:0.022,sendTime:0.059,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,396] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905396, txnLastUpdateTimestamp=1602759905396) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,397] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=330 segment=[0:55918]) to (offset=331 segment=[0:56112]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,397] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,397] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=162 segment=[0:18711])) (kafka.log.Log)
[2020-10-15 11:05:05,397] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=162 segment=[0:18711]) to (offset=163 segment=[0:18864]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,397] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,397] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,397] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,397] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,397] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,397] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,397] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,397] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905396, txnLastUpdateTimestamp=1602759905396) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,397] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905396, txnLastUpdateTimestamp=1602759905396) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,397] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=8) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.641,requestQueueTime:0.04,localTime:0.525,remoteTime:0.0,throttleTime:0.041,responseQueueTime:0.019,sendTime:0.056,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,397] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=11) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=4,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=82,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.707,requestQueueTime:0.037,localTime:0.594,remoteTime:0.0,throttleTime:0.048,responseQueueTime:0.019,sendTime:0.057,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,401] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=162 segment=[0:12474])) (kafka.log.Log)
[2020-10-15 11:05:05,401] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=162 segment=[0:12474]) to (offset=163 segment=[0:12550]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,401] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,401] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,401] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,401] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,402] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=12) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=162,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.481,requestQueueTime:0.041,localTime:0.371,remoteTime:0.0,throttleTime:0.029,responseQueueTime:0.033,sendTime:0.034,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,402] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905396, txnLastUpdateTimestamp=1602759905402) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,402] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=331 segment=[0:56112]) to (offset=332 segment=[0:56306]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,402] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,402] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,402] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,402] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,402] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905396, txnLastUpdateTimestamp=1602759905402) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,402] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905396, txnLastUpdateTimestamp=1602759905402) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,402] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905396, txnLastUpdateTimestamp=1602759905402) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,402] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=9) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.474,requestQueueTime:0.026,localTime:0.326,remoteTime:0.0,throttleTime:0.015,responseQueueTime:0.042,sendTime:0.078,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,403] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,403] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=163 segment=[0:12550]) to (offset=164 segment=[0:12628]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,403] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,403] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,403] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,403] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,403] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,403] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=163 segment=[0:18864]) to (offset=164 segment=[0:18942]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,403] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,403] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,403] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,403] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=7) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=162,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=164,last_stable_offset=164,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=12474, end=12628)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:13.624,requestQueueTime:0.039,localTime:0.088,remoteTime:13.214,throttleTime:0.108,responseQueueTime:0.019,sendTime:0.152,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,403] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,403] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,403] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 11:05:05,404] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=81) -- {transaction_markers=[{producer_id=0,producer_epoch=4,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.128,requestQueueTime:0.037,localTime:1.003,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.032,sendTime:0.054,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:05,404] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759905404, latencyMs=2, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=81), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@2cc5b457) from node 1001 with correlation id 81 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 11:05:05,404] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=4, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759905396, txnLastUpdateTimestamp=1602759905402) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 11:05:05,404] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=332 segment=[0:56306]) to (offset=333 segment=[0:56435]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,404] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,404] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,404] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,404] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,404] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905396, txnLastUpdateTimestamp=1602759905402) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,404] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905396, txnLastUpdateTimestamp=1602759905402) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,404] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,409] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=82 segment=[0:5862]) to (offset=83 segment=[0:5933]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,409] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,409] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,409] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,409] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,409] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,409] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=10) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=82,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=83,last_stable_offset=83,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=71, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=5862, end=5933)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:13.805,requestQueueTime:0.033,localTime:0.122,remoteTime:13.4,throttleTime:0.1,responseQueueTime:0.027,sendTime:0.121,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,409] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=6) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=82,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46530-11;totalTime:0.756,requestQueueTime:0.054,localTime:0.615,remoteTime:0.0,throttleTime:0.038,responseQueueTime:0.018,sendTime:0.067,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,409] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,410] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905410, txnLastUpdateTimestamp=1602759905410) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,410] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=333 segment=[0:56435]) to (offset=334 segment=[0:56593]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,410] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,410] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,410] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,410] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,410] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905410, txnLastUpdateTimestamp=1602759905410) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,410] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905410, txnLastUpdateTimestamp=1602759905410) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,410] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=10) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.837,requestQueueTime:0.02,localTime:0.641,remoteTime:0.0,throttleTime:0.032,responseQueueTime:0.104,sendTime:0.07,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,411] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905410, txnLastUpdateTimestamp=1602759905411) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,411] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=334 segment=[0:56593]) to (offset=335 segment=[0:56787]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,411] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,411] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,411] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,411] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=164 segment=[0:18942])) (kafka.log.Log)
[2020-10-15 11:05:05,411] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=164 segment=[0:18942]) to (offset=165 segment=[0:19095]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,411] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,411] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,411] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,411] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,411] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,411] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905410, txnLastUpdateTimestamp=1602759905411) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,411] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905410, txnLastUpdateTimestamp=1602759905411) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,411] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=13) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=4,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=83,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.769,requestQueueTime:0.041,localTime:0.636,remoteTime:0.0,throttleTime:0.052,responseQueueTime:0.018,sendTime:0.072,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,411] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=11) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.843,requestQueueTime:0.035,localTime:0.565,remoteTime:0.0,throttleTime:0.044,responseQueueTime:0.031,sendTime:0.211,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,415] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=164 segment=[0:12628])) (kafka.log.Log)
[2020-10-15 11:05:05,415] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=164 segment=[0:12628]) to (offset=165 segment=[0:12704]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,415] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,415] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,415] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,415] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,415] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=14) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=164,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.543,requestQueueTime:0.045,localTime:0.426,remoteTime:0.0,throttleTime:0.033,responseQueueTime:0.019,sendTime:0.052,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,415] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905410, txnLastUpdateTimestamp=1602759905415) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,415] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=335 segment=[0:56787]) to (offset=336 segment=[0:56981]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,415] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,415] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,415] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,415] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,415] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905410, txnLastUpdateTimestamp=1602759905415) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,415] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905410, txnLastUpdateTimestamp=1602759905415) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,415] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905410, txnLastUpdateTimestamp=1602759905415) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,416] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=12) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.648,requestQueueTime:0.03,localTime:0.392,remoteTime:0.0,throttleTime:0.018,responseQueueTime:0.015,sendTime:0.209,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,416] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,416] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=165 segment=[0:12704]) to (offset=166 segment=[0:12782]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,416] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,416] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,416] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,416] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,416] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,416] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=165 segment=[0:19095]) to (offset=166 segment=[0:19173]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,416] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,416] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,416] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,416] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,417] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 11:05:05,417] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=82) -- {transaction_markers=[{producer_id=0,producer_epoch=4,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:0.917,requestQueueTime:0.032,localTime:0.806,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.032,sendTime:0.047,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:05,417] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759905417, latencyMs=1, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=82), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@4857ef45) from node 1001 with correlation id 82 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 11:05:05,417] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=8) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=164,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=166,last_stable_offset=166,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=12628, end=12782)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:13.456,requestQueueTime:0.041,localTime:0.141,remoteTime:12.675,throttleTime:0.086,responseQueueTime:0.021,sendTime:0.489,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,417] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=4, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759905410, txnLastUpdateTimestamp=1602759905415) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 11:05:05,417] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,417] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=336 segment=[0:56981]) to (offset=337 segment=[0:57110]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,417] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,417] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,417] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,417] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,417] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905410, txnLastUpdateTimestamp=1602759905415) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,417] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905410, txnLastUpdateTimestamp=1602759905415) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,417] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,422] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=83 segment=[0:5933]) to (offset=84 segment=[0:6004]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,423] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,423] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,423] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,423] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,423] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,423] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=11) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=83,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=84,last_stable_offset=84,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=71, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=5933, end=6004)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:13.614,requestQueueTime:0.033,localTime:0.2,remoteTime:13.038,throttleTime:0.173,responseQueueTime:0.03,sendTime:0.136,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,423] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=7) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=83,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46530-11;totalTime:1.074,requestQueueTime:0.058,localTime:0.877,remoteTime:0.0,throttleTime:0.047,responseQueueTime:0.025,sendTime:0.112,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,423] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,423] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905423, txnLastUpdateTimestamp=1602759905423) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,424] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=337 segment=[0:57110]) to (offset=338 segment=[0:57268]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,424] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,424] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,424] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,424] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,424] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905423, txnLastUpdateTimestamp=1602759905423) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,424] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905423, txnLastUpdateTimestamp=1602759905423) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,424] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=13) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.561,requestQueueTime:0.019,localTime:0.483,remoteTime:0.0,throttleTime:0.017,responseQueueTime:0.02,sendTime:0.039,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,424] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905423, txnLastUpdateTimestamp=1602759905424) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,424] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=338 segment=[0:57268]) to (offset=339 segment=[0:57462]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,424] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,424] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,424] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,424] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,424] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905423, txnLastUpdateTimestamp=1602759905424) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,424] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905423, txnLastUpdateTimestamp=1602759905424) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,425] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=14) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.508,requestQueueTime:0.022,localTime:0.429,remoteTime:0.0,throttleTime:0.034,responseQueueTime:0.015,sendTime:0.04,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,425] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=166 segment=[0:19173])) (kafka.log.Log)
[2020-10-15 11:05:05,425] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=166 segment=[0:19173]) to (offset=167 segment=[0:19326]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,425] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,425] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,425] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,425] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,426] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=15) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=4,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=84,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:1.658,requestQueueTime:0.137,localTime:1.476,remoteTime:0.0,throttleTime:0.055,responseQueueTime:0.015,sendTime:0.028,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,429] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=166 segment=[0:12782])) (kafka.log.Log)
[2020-10-15 11:05:05,429] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=166 segment=[0:12782]) to (offset=167 segment=[0:12858]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,429] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,429] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,429] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,429] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,430] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=16) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=166,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.728,requestQueueTime:0.045,localTime:0.606,remoteTime:0.0,throttleTime:0.045,responseQueueTime:0.02,sendTime:0.055,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,430] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905423, txnLastUpdateTimestamp=1602759905430) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,430] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=339 segment=[0:57462]) to (offset=340 segment=[0:57656]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,430] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,430] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,430] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,430] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,430] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905423, txnLastUpdateTimestamp=1602759905430) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,430] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905423, txnLastUpdateTimestamp=1602759905430) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,430] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905423, txnLastUpdateTimestamp=1602759905430) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,430] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=15) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.709,requestQueueTime:0.025,localTime:0.484,remoteTime:0.0,throttleTime:0.031,responseQueueTime:0.019,sendTime:0.18,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,431] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,431] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=167 segment=[0:12858]) to (offset=168 segment=[0:12936]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,431] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,431] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,431] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,431] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,431] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=9) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=166,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=168,last_stable_offset=168,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=12782, end=12936)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:14.476,requestQueueTime:0.037,localTime:0.217,remoteTime:13.96,throttleTime:0.115,responseQueueTime:0.017,sendTime:0.128,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,432] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,432] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,432] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=167 segment=[0:19326]) to (offset=168 segment=[0:19404]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,432] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,432] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,432] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,432] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,432] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 11:05:05,432] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=83) -- {transaction_markers=[{producer_id=0,producer_epoch=4,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.434,requestQueueTime:0.033,localTime:1.35,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.017,sendTime:0.033,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:05,432] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759905432, latencyMs=2, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=83), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@5d7c3673) from node 1001 with correlation id 83 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 11:05:05,432] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=4, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759905423, txnLastUpdateTimestamp=1602759905430) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 11:05:05,432] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=340 segment=[0:57656]) to (offset=341 segment=[0:57785]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,432] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,432] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,432] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,432] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,433] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905423, txnLastUpdateTimestamp=1602759905430) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,433] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905423, txnLastUpdateTimestamp=1602759905430) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,433] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,437] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=84 segment=[0:6004]) to (offset=85 segment=[0:6075]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,437] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,437] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,437] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,437] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,437] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,438] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=12) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=84,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=85,last_stable_offset=85,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=71, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=6004, end=6075)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:14.456,requestQueueTime:0.037,localTime:0.315,remoteTime:13.82,throttleTime:0.147,responseQueueTime:0.019,sendTime:0.116,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,438] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,438] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=8) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=84,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46530-11;totalTime:1.036,requestQueueTime:0.043,localTime:0.906,remoteTime:0.0,throttleTime:0.052,responseQueueTime:0.027,sendTime:0.059,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,438] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905438, txnLastUpdateTimestamp=1602759905438) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,438] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=341 segment=[0:57785]) to (offset=342 segment=[0:57943]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,438] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,439] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,439] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,439] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,439] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905438, txnLastUpdateTimestamp=1602759905438) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,439] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905438, txnLastUpdateTimestamp=1602759905438) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,439] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=16) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.884,requestQueueTime:0.025,localTime:0.769,remoteTime:0.0,throttleTime:0.029,responseQueueTime:0.023,sendTime:0.066,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,439] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905438, txnLastUpdateTimestamp=1602759905439) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,439] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=342 segment=[0:57943]) to (offset=343 segment=[0:58137]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,439] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,440] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,440] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,440] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,440] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905438, txnLastUpdateTimestamp=1602759905439) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,440] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905438, txnLastUpdateTimestamp=1602759905439) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,440] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=168 segment=[0:19404])) (kafka.log.Log)
[2020-10-15 11:05:05,440] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=168 segment=[0:19404]) to (offset=169 segment=[0:19557]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,440] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,440] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,440] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=17) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.684,requestQueueTime:0.064,localTime:0.497,remoteTime:0.0,throttleTime:0.044,responseQueueTime:0.021,sendTime:0.1,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,440] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,440] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,440] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=17) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=4,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=85,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:1.193,requestQueueTime:0.042,localTime:1.082,remoteTime:0.0,throttleTime:0.056,responseQueueTime:0.025,sendTime:0.043,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,444] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=168 segment=[0:12936])) (kafka.log.Log)
[2020-10-15 11:05:05,444] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=168 segment=[0:12936]) to (offset=169 segment=[0:13012]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,444] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,444] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,444] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,444] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,445] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=18) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=168,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:1.099,requestQueueTime:0.072,localTime:0.944,remoteTime:0.0,throttleTime:0.081,responseQueueTime:0.021,sendTime:0.061,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,445] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905438, txnLastUpdateTimestamp=1602759905445) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,445] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=343 segment=[0:58137]) to (offset=344 segment=[0:58331]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,445] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,445] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,445] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,445] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,445] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905438, txnLastUpdateTimestamp=1602759905445) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,445] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905438, txnLastUpdateTimestamp=1602759905445) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,445] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905438, txnLastUpdateTimestamp=1602759905445) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,446] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=18) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.924,requestQueueTime:0.039,localTime:0.637,remoteTime:0.0,throttleTime:0.027,responseQueueTime:0.018,sendTime:0.229,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,446] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,446] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=169 segment=[0:13012]) to (offset=170 segment=[0:13090]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,447] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,447] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,447] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,447] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,447] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,447] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=169 segment=[0:19557]) to (offset=170 segment=[0:19635]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,447] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,447] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,447] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,447] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,447] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 11:05:05,447] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=84) -- {transaction_markers=[{producer_id=0,producer_epoch=4,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.136,requestQueueTime:0.032,localTime:1.04,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.024,sendTime:0.038,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:05,447] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759905447, latencyMs=1, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=84), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@59a8e9f) from node 1001 with correlation id 84 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 11:05:05,447] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=4, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759905438, txnLastUpdateTimestamp=1602759905445) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 11:05:05,447] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=344 segment=[0:58331]) to (offset=345 segment=[0:58460]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,447] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,448] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,448] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,448] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,448] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905438, txnLastUpdateTimestamp=1602759905445) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,448] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905438, txnLastUpdateTimestamp=1602759905445) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,448] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,448] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=10) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=168,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=170,last_stable_offset=170,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=12936, end=13090)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:16.066,requestQueueTime:0.04,localTime:1.143,remoteTime:13.834,throttleTime:0.113,responseQueueTime:0.019,sendTime:0.913,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,448] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,453] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=85 segment=[0:6075]) to (offset=86 segment=[0:6146]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,453] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,454] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,454] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,454] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,454] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,454] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=9) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=85,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46530-11;totalTime:1.171,requestQueueTime:0.065,localTime:0.998,remoteTime:0.0,throttleTime:0.043,responseQueueTime:0.022,sendTime:0.084,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,454] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=13) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=85,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=86,last_stable_offset=86,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=71, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=6075, end=6146)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:16.557,requestQueueTime:0.038,localTime:0.148,remoteTime:15.623,throttleTime:0.148,responseQueueTime:0.026,sendTime:0.571,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,455] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,456] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905455, txnLastUpdateTimestamp=1602759905455) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,456] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=345 segment=[0:58460]) to (offset=346 segment=[0:58618]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,456] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,456] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,456] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,456] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,456] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905455, txnLastUpdateTimestamp=1602759905455) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,456] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905455, txnLastUpdateTimestamp=1602759905455) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,456] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=19) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.798,requestQueueTime:0.028,localTime:0.701,remoteTime:0.0,throttleTime:0.042,responseQueueTime:0.017,sendTime:0.051,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,456] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905455, txnLastUpdateTimestamp=1602759905456) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,457] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=346 segment=[0:58618]) to (offset=347 segment=[0:58812]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,457] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,457] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,457] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,457] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,457] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=170 segment=[0:19635])) (kafka.log.Log)
[2020-10-15 11:05:05,457] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905455, txnLastUpdateTimestamp=1602759905456) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,457] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=170 segment=[0:19635]) to (offset=171 segment=[0:19788]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,457] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905455, txnLastUpdateTimestamp=1602759905456) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,457] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,457] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,457] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,457] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,457] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=20) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.72,requestQueueTime:0.028,localTime:0.594,remoteTime:0.0,throttleTime:0.051,responseQueueTime:0.016,sendTime:0.081,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,457] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=19) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=4,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=86,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.875,requestQueueTime:0.03,localTime:0.783,remoteTime:0.0,throttleTime:0.169,responseQueueTime:0.018,sendTime:0.042,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,461] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=170 segment=[0:13090])) (kafka.log.Log)
[2020-10-15 11:05:05,461] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=170 segment=[0:13090]) to (offset=171 segment=[0:13166]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,461] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,461] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,461] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,461] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,461] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=20) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=170,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.836,requestQueueTime:0.039,localTime:0.753,remoteTime:0.0,throttleTime:0.081,responseQueueTime:0.018,sendTime:0.025,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,461] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905455, txnLastUpdateTimestamp=1602759905461) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,462] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=347 segment=[0:58812]) to (offset=348 segment=[0:59006]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,462] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,462] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,462] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,462] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,462] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905455, txnLastUpdateTimestamp=1602759905461) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,462] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905455, txnLastUpdateTimestamp=1602759905461) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,462] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905455, txnLastUpdateTimestamp=1602759905462) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,462] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=21) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.445,requestQueueTime:0.021,localTime:0.349,remoteTime:0.0,throttleTime:0.023,responseQueueTime:0.022,sendTime:0.051,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,463] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,463] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=171 segment=[0:13166]) to (offset=172 segment=[0:13244]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,463] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,463] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,463] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,463] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,463] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,463] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=171 segment=[0:19788]) to (offset=172 segment=[0:19866]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,463] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,463] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,463] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,463] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=11) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=170,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=172,last_stable_offset=172,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=13090, end=13244)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:15.232,requestQueueTime:0.044,localTime:0.433,remoteTime:14.505,throttleTime:0.122,responseQueueTime:0.018,sendTime:0.108,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,463] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,463] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,463] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 11:05:05,463] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=85) -- {transaction_markers=[{producer_id=0,producer_epoch=4,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.183,requestQueueTime:0.036,localTime:1.054,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.044,sendTime:0.048,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:05,463] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759905463, latencyMs=1, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=85), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@47cf577) from node 1001 with correlation id 85 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 11:05:05,464] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=4, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759905455, txnLastUpdateTimestamp=1602759905461) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 11:05:05,464] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=348 segment=[0:59006]) to (offset=349 segment=[0:59135]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,464] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,464] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,464] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,464] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,464] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905455, txnLastUpdateTimestamp=1602759905462) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,464] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905455, txnLastUpdateTimestamp=1602759905462) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,464] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,468] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=86 segment=[0:6146]) to (offset=87 segment=[0:6217]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,468] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,469] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,469] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,469] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,469] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,469] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=10) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=86,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46530-11;totalTime:0.53,requestQueueTime:0.042,localTime:0.446,remoteTime:0.0,throttleTime:0.028,responseQueueTime:0.013,sendTime:0.028,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,469] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=14) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=86,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=87,last_stable_offset=87,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=71, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=6146, end=6217)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:13.488,requestQueueTime:0.038,localTime:0.171,remoteTime:13.073,throttleTime:0.065,responseQueueTime:0.013,sendTime:0.127,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,469] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,469] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905469, txnLastUpdateTimestamp=1602759905469) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,469] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=349 segment=[0:59135]) to (offset=350 segment=[0:59293]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,469] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,469] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,469] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,469] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,469] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905469, txnLastUpdateTimestamp=1602759905469) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,469] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905469, txnLastUpdateTimestamp=1602759905469) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,470] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=22) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.566,requestQueueTime:0.019,localTime:0.45,remoteTime:0.0,throttleTime:0.022,responseQueueTime:0.018,sendTime:0.078,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,470] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=172 segment=[0:19866])) (kafka.log.Log)
[2020-10-15 11:05:05,470] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=172 segment=[0:19866]) to (offset=173 segment=[0:20019]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,470] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,470] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,470] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,470] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,470] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905469, txnLastUpdateTimestamp=1602759905470) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,470] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=21) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=4,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=87,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.677,requestQueueTime:0.038,localTime:0.563,remoteTime:0.0,throttleTime:0.05,responseQueueTime:0.019,sendTime:0.056,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,471] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=350 segment=[0:59293]) to (offset=351 segment=[0:59487]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,471] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,471] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,471] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,471] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,471] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905469, txnLastUpdateTimestamp=1602759905470) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,471] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905469, txnLastUpdateTimestamp=1602759905470) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,471] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=23) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:1.27,requestQueueTime:0.029,localTime:1.157,remoteTime:0.0,throttleTime:0.077,responseQueueTime:0.023,sendTime:0.059,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,475] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=172 segment=[0:13244])) (kafka.log.Log)
[2020-10-15 11:05:05,475] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=172 segment=[0:13244]) to (offset=173 segment=[0:13320]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,475] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,475] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,475] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,475] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,475] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=22) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=172,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.499,requestQueueTime:0.045,localTime:0.372,remoteTime:0.0,throttleTime:0.036,responseQueueTime:0.025,sendTime:0.056,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,475] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905469, txnLastUpdateTimestamp=1602759905475) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,475] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=351 segment=[0:59487]) to (offset=352 segment=[0:59681]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,475] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,475] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,475] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,475] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,475] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905469, txnLastUpdateTimestamp=1602759905475) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,475] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905469, txnLastUpdateTimestamp=1602759905475) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,475] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905469, txnLastUpdateTimestamp=1602759905475) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,476] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=24) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.663,requestQueueTime:0.022,localTime:0.542,remoteTime:0.0,throttleTime:0.023,responseQueueTime:0.016,sendTime:0.082,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,476] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,476] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=173 segment=[0:13320]) to (offset=174 segment=[0:13398]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,476] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,477] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,477] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,477] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,477] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=12) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=172,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=174,last_stable_offset=174,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=13244, end=13398)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:13.474,requestQueueTime:0.049,localTime:0.154,remoteTime:13.052,throttleTime:0.118,responseQueueTime:0.011,sendTime:0.089,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,477] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,477] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=173 segment=[0:20019]) to (offset=174 segment=[0:20097]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,477] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,477] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,477] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,477] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,477] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,477] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 11:05:05,477] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=86) -- {transaction_markers=[{producer_id=0,producer_epoch=4,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.153,requestQueueTime:0.047,localTime:1.065,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.012,sendTime:0.027,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:05,477] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759905477, latencyMs=1, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=86), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@73a61f7a) from node 1001 with correlation id 86 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 11:05:05,477] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=4, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759905469, txnLastUpdateTimestamp=1602759905475) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 11:05:05,477] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=352 segment=[0:59681]) to (offset=353 segment=[0:59810]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,477] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,477] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,477] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,477] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,477] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905469, txnLastUpdateTimestamp=1602759905475) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,477] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905469, txnLastUpdateTimestamp=1602759905475) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,477] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,482] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=87 segment=[0:6217]) to (offset=88 segment=[0:6288]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,482] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,482] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,482] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,482] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,482] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,482] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=11) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=87,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46530-11;totalTime:0.468,requestQueueTime:0.038,localTime:0.391,remoteTime:0.0,throttleTime:0.021,responseQueueTime:0.01,sendTime:0.027,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,482] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=15) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=87,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=88,last_stable_offset=88,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=71, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=6217, end=6288)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:13.528,requestQueueTime:0.031,localTime:0.107,remoteTime:13.088,throttleTime:0.071,responseQueueTime:0.017,sendTime:0.213,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,483] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,483] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905483, txnLastUpdateTimestamp=1602759905483) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,483] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=353 segment=[0:59810]) to (offset=354 segment=[0:59968]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,483] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,483] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,483] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,483] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,483] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905483, txnLastUpdateTimestamp=1602759905483) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,483] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905483, txnLastUpdateTimestamp=1602759905483) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,483] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=25) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.613,requestQueueTime:0.029,localTime:0.451,remoteTime:0.0,throttleTime:0.02,responseQueueTime:0.02,sendTime:0.112,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,484] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905483, txnLastUpdateTimestamp=1602759905484) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,484] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=174 segment=[0:20097])) (kafka.log.Log)
[2020-10-15 11:05:05,484] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=174 segment=[0:20097]) to (offset=175 segment=[0:20250]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,484] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,484] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,484] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,484] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=354 segment=[0:59968]) to (offset=355 segment=[0:60162]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,484] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,484] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,484] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,484] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,484] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,484] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905483, txnLastUpdateTimestamp=1602759905484) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,484] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905483, txnLastUpdateTimestamp=1602759905484) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,484] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=26) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.614,requestQueueTime:0.03,localTime:0.511,remoteTime:0.0,throttleTime:0.042,responseQueueTime:0.018,sendTime:0.054,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,484] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=23) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=4,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=88,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:1.196,requestQueueTime:0.036,localTime:1.082,remoteTime:0.0,throttleTime:0.139,responseQueueTime:0.024,sendTime:0.053,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,488] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=174 segment=[0:13398])) (kafka.log.Log)
[2020-10-15 11:05:05,488] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=174 segment=[0:13398]) to (offset=175 segment=[0:13474]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,488] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,488] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,488] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,488] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,488] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=24) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=174,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.484,requestQueueTime:0.045,localTime:0.371,remoteTime:0.0,throttleTime:0.033,responseQueueTime:0.018,sendTime:0.049,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,488] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905483, txnLastUpdateTimestamp=1602759905488) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,489] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=355 segment=[0:60162]) to (offset=356 segment=[0:60356]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,489] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,489] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,489] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,489] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,489] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905483, txnLastUpdateTimestamp=1602759905488) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,489] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905483, txnLastUpdateTimestamp=1602759905488) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,489] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905483, txnLastUpdateTimestamp=1602759905489) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,489] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=27) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.586,requestQueueTime:0.028,localTime:0.511,remoteTime:0.0,throttleTime:0.023,responseQueueTime:0.011,sendTime:0.035,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,489] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,489] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=175 segment=[0:13474]) to (offset=176 segment=[0:13552]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,490] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,490] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,490] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,490] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,490] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=13) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=174,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=176,last_stable_offset=176,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=13398, end=13552)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:13.028,requestQueueTime:0.026,localTime:0.124,remoteTime:12.665,throttleTime:0.114,responseQueueTime:0.011,sendTime:0.086,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,490] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,490] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,490] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=175 segment=[0:20250]) to (offset=176 segment=[0:20328]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,490] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,490] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,490] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,490] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,490] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 11:05:05,490] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=87) -- {transaction_markers=[{producer_id=0,producer_epoch=4,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.302,requestQueueTime:0.029,localTime:1.232,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.012,sendTime:0.028,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:05,490] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759905490, latencyMs=1, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=87), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@4f5560d3) from node 1001 with correlation id 87 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 11:05:05,490] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=4, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759905483, txnLastUpdateTimestamp=1602759905488) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 11:05:05,491] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=356 segment=[0:60356]) to (offset=357 segment=[0:60485]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,491] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,491] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,491] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,491] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,491] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905483, txnLastUpdateTimestamp=1602759905489) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,491] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905483, txnLastUpdateTimestamp=1602759905489) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,491] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,495] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=88 segment=[0:6288]) to (offset=89 segment=[0:6359]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,495] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,495] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,495] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,495] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,495] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,496] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=16) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=88,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=89,last_stable_offset=89,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=71, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=6288, end=6359)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:13.07,requestQueueTime:0.037,localTime:0.239,remoteTime:12.613,throttleTime:0.099,responseQueueTime:0.016,sendTime:0.064,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,496] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,496] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905496, txnLastUpdateTimestamp=1602759905496) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,496] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=357 segment=[0:60485]) to (offset=358 segment=[0:60643]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,496] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,496] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,496] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,496] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,496] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905496, txnLastUpdateTimestamp=1602759905496) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,496] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905496, txnLastUpdateTimestamp=1602759905496) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,496] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=12) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=88,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46530-11;totalTime:1.115,requestQueueTime:0.026,localTime:1.047,remoteTime:0.0,throttleTime:0.509,responseQueueTime:0.01,sendTime:0.03,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,496] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=28) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.451,requestQueueTime:0.018,localTime:0.244,remoteTime:0.0,throttleTime:0.012,responseQueueTime:0.013,sendTime:0.174,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,497] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=176 segment=[0:20328])) (kafka.log.Log)
[2020-10-15 11:05:05,497] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=176 segment=[0:20328]) to (offset=177 segment=[0:20481]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,497] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,497] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,497] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,497] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,497] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905496, txnLastUpdateTimestamp=1602759905497) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,497] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=358 segment=[0:60643]) to (offset=359 segment=[0:60837]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,497] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,497] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,497] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,497] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,497] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=25) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=4,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=89,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.857,requestQueueTime:0.025,localTime:0.69,remoteTime:0.0,throttleTime:0.048,responseQueueTime:0.03,sendTime:0.11,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,497] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905496, txnLastUpdateTimestamp=1602759905497) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,497] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905496, txnLastUpdateTimestamp=1602759905497) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,497] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=29) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.611,requestQueueTime:0.03,localTime:0.51,remoteTime:0.0,throttleTime:0.042,responseQueueTime:0.019,sendTime:0.051,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,502] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=176 segment=[0:13552])) (kafka.log.Log)
[2020-10-15 11:05:05,502] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=176 segment=[0:13552]) to (offset=177 segment=[0:13628]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,502] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,502] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,502] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,502] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,502] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=26) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=176,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.612,requestQueueTime:0.069,localTime:0.454,remoteTime:0.0,throttleTime:0.042,responseQueueTime:0.02,sendTime:0.067,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,502] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905496, txnLastUpdateTimestamp=1602759905502) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,503] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=359 segment=[0:60837]) to (offset=360 segment=[0:61031]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,503] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,503] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,503] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,503] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,503] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905496, txnLastUpdateTimestamp=1602759905502) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,503] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905496, txnLastUpdateTimestamp=1602759905502) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,503] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905496, txnLastUpdateTimestamp=1602759905503) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,503] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=30) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.529,requestQueueTime:0.023,localTime:0.461,remoteTime:0.0,throttleTime:0.02,responseQueueTime:0.015,sendTime:0.028,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,503] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,503] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=177 segment=[0:13628]) to (offset=178 segment=[0:13706]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,504] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,504] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,504] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,504] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,504] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=14) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=176,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=178,last_stable_offset=178,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=13552, end=13706)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:13.924,requestQueueTime:0.032,localTime:0.138,remoteTime:13.515,throttleTime:0.119,responseQueueTime:0.017,sendTime:0.1,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,504] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,504] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=177 segment=[0:20481]) to (offset=178 segment=[0:20559]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,504] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,504] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,504] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,504] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,504] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,504] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 11:05:05,504] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=88) -- {transaction_markers=[{producer_id=0,producer_epoch=4,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.118,requestQueueTime:0.036,localTime:1.015,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.019,sendTime:0.047,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:05,504] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759905504, latencyMs=1, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=88), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@1eeae1d0) from node 1001 with correlation id 88 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 11:05:05,504] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=4, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759905496, txnLastUpdateTimestamp=1602759905502) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 11:05:05,505] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=360 segment=[0:61031]) to (offset=361 segment=[0:61160]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,505] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,505] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,505] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,505] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,505] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905496, txnLastUpdateTimestamp=1602759905503) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,505] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905496, txnLastUpdateTimestamp=1602759905503) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,505] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,509] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=89 segment=[0:6359]) to (offset=90 segment=[0:6430]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,509] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,509] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,509] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,509] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,509] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,510] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=13) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=89,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46530-11;totalTime:0.652,requestQueueTime:0.045,localTime:0.526,remoteTime:0.0,throttleTime:0.059,responseQueueTime:0.021,sendTime:0.059,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,510] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=17) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=89,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=90,last_stable_offset=90,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=71, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=6359, end=6430)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:13.926,requestQueueTime:0.031,localTime:0.157,remoteTime:13.49,throttleTime:0.083,responseQueueTime:0.03,sendTime:0.132,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,510] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,510] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905510, txnLastUpdateTimestamp=1602759905510) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,511] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=361 segment=[0:61160]) to (offset=362 segment=[0:61318]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,511] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,511] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,511] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,511] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,511] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905510, txnLastUpdateTimestamp=1602759905510) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,511] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905510, txnLastUpdateTimestamp=1602759905510) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,511] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=31) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.773,requestQueueTime:0.038,localTime:0.612,remoteTime:0.0,throttleTime:0.027,responseQueueTime:0.02,sendTime:0.101,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,511] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905510, txnLastUpdateTimestamp=1602759905511) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,512] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=362 segment=[0:61318]) to (offset=363 segment=[0:61512]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,512] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,512] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,512] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,512] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=178 segment=[0:20559])) (kafka.log.Log)
[2020-10-15 11:05:05,512] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,512] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=178 segment=[0:20559]) to (offset=179 segment=[0:20712]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,512] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,512] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,512] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,512] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,512] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905510, txnLastUpdateTimestamp=1602759905511) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,512] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905510, txnLastUpdateTimestamp=1602759905511) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,512] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=32) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.743,requestQueueTime:0.032,localTime:0.638,remoteTime:0.0,throttleTime:0.044,responseQueueTime:0.019,sendTime:0.052,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,512] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=27) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=4,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=90,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.684,requestQueueTime:0.044,localTime:0.565,remoteTime:0.0,throttleTime:0.046,responseQueueTime:0.02,sendTime:0.054,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,515] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=178 segment=[0:13706])) (kafka.log.Log)
[2020-10-15 11:05:05,515] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=178 segment=[0:13706]) to (offset=179 segment=[0:13782]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,515] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,515] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,515] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,516] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,516] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=28) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=178,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.614,requestQueueTime:0.06,localTime:0.481,remoteTime:0.0,throttleTime:0.04,responseQueueTime:0.02,sendTime:0.051,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,516] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905510, txnLastUpdateTimestamp=1602759905516) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,516] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=363 segment=[0:61512]) to (offset=364 segment=[0:61706]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,516] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,516] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,516] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,516] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,516] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905510, txnLastUpdateTimestamp=1602759905516) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,516] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905510, txnLastUpdateTimestamp=1602759905516) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,516] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905510, txnLastUpdateTimestamp=1602759905516) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,516] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=33) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.585,requestQueueTime:0.033,localTime:0.47,remoteTime:0.0,throttleTime:0.022,responseQueueTime:0.023,sendTime:0.057,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,517] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,517] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=179 segment=[0:13782]) to (offset=180 segment=[0:13860]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,517] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,517] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,517] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,517] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,517] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,517] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=179 segment=[0:20712]) to (offset=180 segment=[0:20790]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,517] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,517] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,517] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,517] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,517] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=15) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=178,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=180,last_stable_offset=180,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=13706, end=13860)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:13.471,requestQueueTime:0.037,localTime:0.126,remoteTime:13.029,throttleTime:0.11,responseQueueTime:0.022,sendTime:0.145,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,518] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 11:05:05,518] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,518] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=89) -- {transaction_markers=[{producer_id=0,producer_epoch=4,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.023,requestQueueTime:0.036,localTime:0.922,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.023,sendTime:0.04,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:05,518] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759905518, latencyMs=2, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=89), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@7dde6837) from node 1001 with correlation id 89 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 11:05:05,518] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=4, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759905510, txnLastUpdateTimestamp=1602759905516) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 11:05:05,518] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=364 segment=[0:61706]) to (offset=365 segment=[0:61835]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,518] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,518] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,518] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,518] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,518] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905510, txnLastUpdateTimestamp=1602759905516) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,518] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905510, txnLastUpdateTimestamp=1602759905516) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,518] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,523] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=90 segment=[0:6430]) to (offset=91 segment=[0:6502]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,523] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,523] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,523] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,523] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,523] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,524] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=18) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=90,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=91,last_stable_offset=91,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=72, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=6430, end=6502)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:13.251,requestQueueTime:0.045,localTime:0.132,remoteTime:12.742,throttleTime:0.175,responseQueueTime:0.029,sendTime:0.127,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,524] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=14) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=90,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46530-11;totalTime:1.024,requestQueueTime:0.053,localTime:0.896,remoteTime:0.0,throttleTime:0.052,responseQueueTime:0.019,sendTime:0.055,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,524] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,524] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905524, txnLastUpdateTimestamp=1602759905524) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,524] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=365 segment=[0:61835]) to (offset=366 segment=[0:61993]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,524] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,524] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,524] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,524] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,524] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905524, txnLastUpdateTimestamp=1602759905524) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,524] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905524, txnLastUpdateTimestamp=1602759905524) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,524] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=34) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.531,requestQueueTime:0.02,localTime:0.461,remoteTime:0.0,throttleTime:0.022,responseQueueTime:0.014,sendTime:0.034,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,525] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905524, txnLastUpdateTimestamp=1602759905525) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,525] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=180 segment=[0:20790])) (kafka.log.Log)
[2020-10-15 11:05:05,525] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=180 segment=[0:20790]) to (offset=181 segment=[0:20943]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,525] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,525] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,525] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,525] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,525] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=366 segment=[0:61993]) to (offset=367 segment=[0:62187]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,525] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,525] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,525] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,525] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,525] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905524, txnLastUpdateTimestamp=1602759905525) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,525] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905524, txnLastUpdateTimestamp=1602759905525) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,525] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=29) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=4,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=91,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.838,requestQueueTime:0.032,localTime:0.698,remoteTime:0.0,throttleTime:0.053,responseQueueTime:0.052,sendTime:0.054,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,525] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=35) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.611,requestQueueTime:0.03,localTime:0.496,remoteTime:0.0,throttleTime:0.04,responseQueueTime:0.033,sendTime:0.05,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,530] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=180 segment=[0:13860])) (kafka.log.Log)
[2020-10-15 11:05:05,530] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=180 segment=[0:13860]) to (offset=181 segment=[0:13936]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,530] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,530] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,530] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,530] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,530] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=30) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=180,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.548,requestQueueTime:0.044,localTime:0.444,remoteTime:0.0,throttleTime:0.043,responseQueueTime:0.015,sendTime:0.043,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,530] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905524, txnLastUpdateTimestamp=1602759905530) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,530] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=367 segment=[0:62187]) to (offset=368 segment=[0:62381]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,530] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,530] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,530] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,530] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,531] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905524, txnLastUpdateTimestamp=1602759905530) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,531] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905524, txnLastUpdateTimestamp=1602759905530) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,531] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905524, txnLastUpdateTimestamp=1602759905531) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,531] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=36) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.566,requestQueueTime:0.035,localTime:0.466,remoteTime:0.0,throttleTime:0.024,responseQueueTime:0.013,sendTime:0.051,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,531] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,531] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=181 segment=[0:13936]) to (offset=182 segment=[0:14014]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,532] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,532] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,532] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,532] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,532] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=16) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=180,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=182,last_stable_offset=182,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=13860, end=14014)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:14.42,requestQueueTime:0.057,localTime:0.13,remoteTime:13.97,throttleTime:0.127,responseQueueTime:0.017,sendTime:0.118,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,532] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,532] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=181 segment=[0:20943]) to (offset=182 segment=[0:21021]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,532] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,532] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,532] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,532] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,532] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,532] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 11:05:05,532] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=90) -- {transaction_markers=[{producer_id=0,producer_epoch=4,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.273,requestQueueTime:0.033,localTime:1.183,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.019,sendTime:0.036,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:05,532] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759905532, latencyMs=1, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=90), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@3e40f539) from node 1001 with correlation id 90 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 11:05:05,532] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=4, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759905524, txnLastUpdateTimestamp=1602759905530) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 11:05:05,533] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=368 segment=[0:62381]) to (offset=369 segment=[0:62510]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,533] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,533] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,533] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,533] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,533] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905524, txnLastUpdateTimestamp=1602759905531) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,533] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905524, txnLastUpdateTimestamp=1602759905531) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,533] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,537] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=91 segment=[0:6502]) to (offset=92 segment=[0:6574]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,538] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,538] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,538] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,538] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,538] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,538] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=19) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=91,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=92,last_stable_offset=92,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=72, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=6502, end=6574)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:14.352,requestQueueTime:0.036,localTime:0.18,remoteTime:13.829,throttleTime:0.163,responseQueueTime:0.019,sendTime:0.122,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,538] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,538] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=15) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=91,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46530-11;totalTime:1.231,requestQueueTime:0.064,localTime:0.994,remoteTime:0.0,throttleTime:0.091,responseQueueTime:0.074,sendTime:0.097,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,538] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905538, txnLastUpdateTimestamp=1602759905538) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,539] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=369 segment=[0:62510]) to (offset=370 segment=[0:62668]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,539] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,539] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,539] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,539] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,539] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905538, txnLastUpdateTimestamp=1602759905538) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,539] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905538, txnLastUpdateTimestamp=1602759905538) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,539] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=37) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:1.003,requestQueueTime:0.039,localTime:0.878,remoteTime:0.0,throttleTime:0.113,responseQueueTime:0.026,sendTime:0.059,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,539] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905538, txnLastUpdateTimestamp=1602759905539) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,540] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=370 segment=[0:62668]) to (offset=371 segment=[0:62862]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,540] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,540] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,540] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,540] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,540] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=182 segment=[0:21021])) (kafka.log.Log)
[2020-10-15 11:05:05,540] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905538, txnLastUpdateTimestamp=1602759905539) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,540] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=182 segment=[0:21021]) to (offset=183 segment=[0:21174]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,540] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905538, txnLastUpdateTimestamp=1602759905539) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,540] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,540] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,540] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,540] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,540] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=38) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.636,requestQueueTime:0.025,localTime:0.546,remoteTime:0.0,throttleTime:0.046,responseQueueTime:0.016,sendTime:0.046,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,540] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=31) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=4,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=92,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.725,requestQueueTime:0.037,localTime:0.57,remoteTime:0.0,throttleTime:0.044,responseQueueTime:0.065,sendTime:0.052,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,544] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=182 segment=[0:14014])) (kafka.log.Log)
[2020-10-15 11:05:05,544] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=182 segment=[0:14014]) to (offset=183 segment=[0:14090]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,544] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,544] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,544] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,544] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,544] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=32) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=182,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.538,requestQueueTime:0.053,localTime:0.4,remoteTime:0.0,throttleTime:0.035,responseQueueTime:0.024,sendTime:0.059,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,544] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905538, txnLastUpdateTimestamp=1602759905544) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,544] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=371 segment=[0:62862]) to (offset=372 segment=[0:63056]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,544] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,544] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,544] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,544] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,544] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905538, txnLastUpdateTimestamp=1602759905544) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,544] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905538, txnLastUpdateTimestamp=1602759905544) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,544] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905538, txnLastUpdateTimestamp=1602759905544) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,545] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=39) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.686,requestQueueTime:0.023,localTime:0.61,remoteTime:0.0,throttleTime:0.023,responseQueueTime:0.015,sendTime:0.037,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,545] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,545] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=183 segment=[0:14090]) to (offset=184 segment=[0:14168]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,545] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,545] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,545] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,545] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,545] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,545] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=183 segment=[0:21174]) to (offset=184 segment=[0:21252]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,545] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,545] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,545] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,545] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,546] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=17) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=182,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=184,last_stable_offset=184,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=14014, end=14168)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:13.409,requestQueueTime:0.045,localTime:0.132,remoteTime:13.016,throttleTime:0.076,responseQueueTime:0.019,sendTime:0.118,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,546] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 11:05:05,546] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,546] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=91) -- {transaction_markers=[{producer_id=0,producer_epoch=4,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:0.727,requestQueueTime:0.024,localTime:0.658,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.018,sendTime:0.026,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:05,546] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759905546, latencyMs=1, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=91), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@5a7749da) from node 1001 with correlation id 91 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 11:05:05,546] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=4, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759905538, txnLastUpdateTimestamp=1602759905544) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 11:05:05,546] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=372 segment=[0:63056]) to (offset=373 segment=[0:63185]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,546] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,546] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,546] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,546] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,546] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905538, txnLastUpdateTimestamp=1602759905544) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,546] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905538, txnLastUpdateTimestamp=1602759905544) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,546] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,551] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=92 segment=[0:6574]) to (offset=93 segment=[0:6646]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,551] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,551] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,551] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,551] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,551] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,552] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=16) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=92,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46530-11;totalTime:0.865,requestQueueTime:0.034,localTime:0.746,remoteTime:0.0,throttleTime:0.044,responseQueueTime:0.027,sendTime:0.057,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,552] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=20) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=92,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=93,last_stable_offset=93,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=72, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=6574, end=6646)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:13.531,requestQueueTime:0.062,localTime:0.147,remoteTime:12.833,throttleTime:0.147,responseQueueTime:0.027,sendTime:0.313,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,552] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,552] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905552, txnLastUpdateTimestamp=1602759905552) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,553] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=373 segment=[0:63185]) to (offset=374 segment=[0:63343]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,553] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,553] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,553] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,553] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,553] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905552, txnLastUpdateTimestamp=1602759905552) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,553] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905552, txnLastUpdateTimestamp=1602759905552) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,553] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=40) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.617,requestQueueTime:0.026,localTime:0.526,remoteTime:0.0,throttleTime:0.022,responseQueueTime:0.014,sendTime:0.049,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,553] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905552, txnLastUpdateTimestamp=1602759905553) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,553] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=374 segment=[0:63343]) to (offset=375 segment=[0:63537]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,553] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,553] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,553] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,553] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,553] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905552, txnLastUpdateTimestamp=1602759905553) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,553] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905552, txnLastUpdateTimestamp=1602759905553) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,553] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=41) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.386,requestQueueTime:0.024,localTime:0.29,remoteTime:0.0,throttleTime:0.024,responseQueueTime:0.019,sendTime:0.051,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,553] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=184 segment=[0:21252])) (kafka.log.Log)
[2020-10-15 11:05:05,553] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=184 segment=[0:21252]) to (offset=185 segment=[0:21405]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,553] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,553] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,553] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,553] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,554] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=33) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=4,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=93,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.661,requestQueueTime:0.052,localTime:0.567,remoteTime:0.0,throttleTime:0.048,responseQueueTime:0.011,sendTime:0.029,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,558] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=184 segment=[0:14168])) (kafka.log.Log)
[2020-10-15 11:05:05,558] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=184 segment=[0:14168]) to (offset=185 segment=[0:14244]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,558] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,558] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,558] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,558] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,558] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=34) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=184,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.685,requestQueueTime:0.049,localTime:0.521,remoteTime:0.0,throttleTime:0.053,responseQueueTime:0.026,sendTime:0.087,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,559] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905552, txnLastUpdateTimestamp=1602759905559) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,559] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=375 segment=[0:63537]) to (offset=376 segment=[0:63731]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,559] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,559] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,559] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,559] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,559] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905552, txnLastUpdateTimestamp=1602759905559) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,559] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905552, txnLastUpdateTimestamp=1602759905559) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,559] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905552, txnLastUpdateTimestamp=1602759905559) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,559] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=42) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.567,requestQueueTime:0.027,localTime:0.459,remoteTime:0.0,throttleTime:0.021,responseQueueTime:0.023,sendTime:0.056,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,560] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,560] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=185 segment=[0:14244]) to (offset=186 segment=[0:14322]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,560] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,560] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,560] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,560] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,560] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,560] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=18) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=184,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=186,last_stable_offset=186,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=14168, end=14322)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:14.588,requestQueueTime:0.038,localTime:0.223,remoteTime:14.002,throttleTime:0.167,responseQueueTime:0.022,sendTime:0.133,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,560] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=185 segment=[0:21405]) to (offset=186 segment=[0:21483]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,560] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,560] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,560] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,560] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,560] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,560] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 11:05:05,561] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=92) -- {transaction_markers=[{producer_id=0,producer_epoch=4,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.335,requestQueueTime:0.034,localTime:1.227,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.023,sendTime:0.05,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:05,561] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759905561, latencyMs=2, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=92), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@135ad725) from node 1001 with correlation id 92 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 11:05:05,561] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=4, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759905552, txnLastUpdateTimestamp=1602759905559) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 11:05:05,561] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=376 segment=[0:63731]) to (offset=377 segment=[0:63860]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,561] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,561] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,561] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,561] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,561] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905552, txnLastUpdateTimestamp=1602759905559) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,561] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905552, txnLastUpdateTimestamp=1602759905559) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,561] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,566] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=93 segment=[0:6646]) to (offset=94 segment=[0:6718]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,566] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,566] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,566] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,566] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,566] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,566] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=21) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=93,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=94,last_stable_offset=94,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=72, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=6646, end=6718)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:14.277,requestQueueTime:0.034,localTime:0.175,remoteTime:13.828,throttleTime:0.099,responseQueueTime:0.022,sendTime:0.117,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,566] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=17) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=93,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46530-11;totalTime:0.755,requestQueueTime:0.056,localTime:0.617,remoteTime:0.0,throttleTime:0.04,responseQueueTime:0.018,sendTime:0.063,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,566] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,566] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905566, txnLastUpdateTimestamp=1602759905566) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,566] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=377 segment=[0:63860]) to (offset=378 segment=[0:64018]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,566] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,567] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,567] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,567] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,567] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905566, txnLastUpdateTimestamp=1602759905566) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,567] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905566, txnLastUpdateTimestamp=1602759905566) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,567] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=43) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.595,requestQueueTime:0.03,localTime:0.441,remoteTime:0.0,throttleTime:0.022,responseQueueTime:0.019,sendTime:0.104,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,567] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905566, txnLastUpdateTimestamp=1602759905567) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,567] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=186 segment=[0:21483])) (kafka.log.Log)
[2020-10-15 11:05:05,567] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=186 segment=[0:21483]) to (offset=187 segment=[0:21636]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,567] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,567] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,567] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,567] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,568] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=35) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=4,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=94,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.835,requestQueueTime:0.103,localTime:0.64,remoteTime:0.0,throttleTime:0.053,responseQueueTime:0.03,sendTime:0.06,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,568] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=378 segment=[0:64018]) to (offset=379 segment=[0:64212]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,568] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,568] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,568] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,568] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,568] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905566, txnLastUpdateTimestamp=1602759905567) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,568] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905566, txnLastUpdateTimestamp=1602759905567) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,568] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=44) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.866,requestQueueTime:0.031,localTime:0.772,remoteTime:0.0,throttleTime:0.047,responseQueueTime:0.022,sendTime:0.04,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,572] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=186 segment=[0:14322])) (kafka.log.Log)
[2020-10-15 11:05:05,572] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=186 segment=[0:14322]) to (offset=187 segment=[0:14398]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,572] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,572] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,572] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,572] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,572] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=36) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=186,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.474,requestQueueTime:0.047,localTime:0.366,remoteTime:0.0,throttleTime:0.029,responseQueueTime:0.014,sendTime:0.045,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,572] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905566, txnLastUpdateTimestamp=1602759905572) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,572] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=379 segment=[0:64212]) to (offset=380 segment=[0:64406]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,572] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,572] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,572] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,572] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,572] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905566, txnLastUpdateTimestamp=1602759905572) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,572] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905566, txnLastUpdateTimestamp=1602759905572) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,572] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905566, txnLastUpdateTimestamp=1602759905572) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,572] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=45) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.536,requestQueueTime:0.021,localTime:0.482,remoteTime:0.0,throttleTime:0.023,responseQueueTime:0.009,sendTime:0.023,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,573] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,573] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=187 segment=[0:14398]) to (offset=188 segment=[0:14476]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,573] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,573] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,573] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,573] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,573] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=19) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=186,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=188,last_stable_offset=188,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=14322, end=14476)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:13.1,requestQueueTime:0.04,localTime:0.15,remoteTime:12.727,throttleTime:0.103,responseQueueTime:0.011,sendTime:0.065,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,573] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,573] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,574] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=187 segment=[0:21636]) to (offset=188 segment=[0:21714]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,574] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,574] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,574] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,574] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,574] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 11:05:05,574] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=93) -- {transaction_markers=[{producer_id=0,producer_epoch=4,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.297,requestQueueTime:0.022,localTime:1.241,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.013,sendTime:0.019,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:05,574] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759905574, latencyMs=2, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=93), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@1d4b9aa9) from node 1001 with correlation id 93 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 11:05:05,574] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=4, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759905566, txnLastUpdateTimestamp=1602759905572) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 11:05:05,574] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=380 segment=[0:64406]) to (offset=381 segment=[0:64535]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,574] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,574] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,574] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,574] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,574] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905566, txnLastUpdateTimestamp=1602759905572) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,574] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905566, txnLastUpdateTimestamp=1602759905572) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,574] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,579] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=94 segment=[0:6718]) to (offset=95 segment=[0:6790]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,579] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,579] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,579] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,579] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,579] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,579] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=18) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=94,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46530-11;totalTime:0.822,requestQueueTime:0.04,localTime:0.741,remoteTime:0.0,throttleTime:0.044,responseQueueTime:0.014,sendTime:0.027,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,579] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=22) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=94,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=95,last_stable_offset=95,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=72, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=6718, end=6790)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:13.162,requestQueueTime:0.04,localTime:0.171,remoteTime:12.692,throttleTime:0.137,responseQueueTime:0.024,sendTime:0.096,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,580] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,580] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905580, txnLastUpdateTimestamp=1602759905580) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,580] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=381 segment=[0:64535]) to (offset=382 segment=[0:64693]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,580] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,580] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,580] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,580] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,580] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905580, txnLastUpdateTimestamp=1602759905580) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,580] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905580, txnLastUpdateTimestamp=1602759905580) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,580] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=46) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.566,requestQueueTime:0.13,localTime:0.368,remoteTime:0.0,throttleTime:0.016,responseQueueTime:0.015,sendTime:0.053,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,581] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905580, txnLastUpdateTimestamp=1602759905581) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,581] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=382 segment=[0:64693]) to (offset=383 segment=[0:64887]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,581] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,581] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,581] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=188 segment=[0:21714])) (kafka.log.Log)
[2020-10-15 11:05:05,581] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=188 segment=[0:21714]) to (offset=189 segment=[0:21867]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,581] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,581] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,581] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,581] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,581] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,581] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,581] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905580, txnLastUpdateTimestamp=1602759905581) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,581] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905580, txnLastUpdateTimestamp=1602759905581) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,581] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=37) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=4,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=95,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.812,requestQueueTime:0.034,localTime:0.65,remoteTime:0.0,throttleTime:0.061,responseQueueTime:0.018,sendTime:0.108,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,581] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=47) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.648,requestQueueTime:0.03,localTime:0.547,remoteTime:0.0,throttleTime:0.061,responseQueueTime:0.019,sendTime:0.051,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,586] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=188 segment=[0:14476])) (kafka.log.Log)
[2020-10-15 11:05:05,586] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=188 segment=[0:14476]) to (offset=189 segment=[0:14552]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,586] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,586] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,586] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,586] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,586] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=38) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=188,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.567,requestQueueTime:0.045,localTime:0.449,remoteTime:0.0,throttleTime:0.045,responseQueueTime:0.02,sendTime:0.051,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,586] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905580, txnLastUpdateTimestamp=1602759905586) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,586] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=383 segment=[0:64887]) to (offset=384 segment=[0:65081]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,586] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,586] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,586] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,586] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,587] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905580, txnLastUpdateTimestamp=1602759905586) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,587] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905580, txnLastUpdateTimestamp=1602759905586) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,587] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905580, txnLastUpdateTimestamp=1602759905587) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,587] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=48) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.672,requestQueueTime:0.035,localTime:0.555,remoteTime:0.0,throttleTime:0.024,responseQueueTime:0.021,sendTime:0.06,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,587] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,587] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=189 segment=[0:14552]) to (offset=190 segment=[0:14630]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,588] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,588] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,588] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,588] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,588] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,588] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=189 segment=[0:21867]) to (offset=190 segment=[0:21945]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,588] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,588] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,588] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,588] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,588] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=20) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=188,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=190,last_stable_offset=190,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=14476, end=14630)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:14.445,requestQueueTime:0.027,localTime:0.213,remoteTime:13.88,throttleTime:0.106,responseQueueTime:0.021,sendTime:0.196,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,588] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 11:05:05,588] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=94) -- {transaction_markers=[{producer_id=0,producer_epoch=4,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.085,requestQueueTime:0.05,localTime:0.954,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.019,sendTime:0.06,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:05,588] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759905588, latencyMs=1, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=94), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@241b5d04) from node 1001 with correlation id 94 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 11:05:05,588] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=4, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759905580, txnLastUpdateTimestamp=1602759905586) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 11:05:05,588] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,589] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=384 segment=[0:65081]) to (offset=385 segment=[0:65210]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,589] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,589] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,589] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,589] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,589] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905580, txnLastUpdateTimestamp=1602759905587) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,589] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905580, txnLastUpdateTimestamp=1602759905587) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,589] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,593] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=95 segment=[0:6790]) to (offset=96 segment=[0:6862]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,594] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,594] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,594] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,594] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,594] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,594] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=19) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=95,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46530-11;totalTime:0.96,requestQueueTime:0.063,localTime:0.812,remoteTime:0.0,throttleTime:0.05,responseQueueTime:0.024,sendTime:0.059,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,594] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=23) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=95,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=96,last_stable_offset=96,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=72, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=6790, end=6862)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:14.887,requestQueueTime:0.387,localTime:0.144,remoteTime:13.649,throttleTime:0.135,responseQueueTime:0.028,sendTime:0.541,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,595] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,595] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905595, txnLastUpdateTimestamp=1602759905595) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,595] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=385 segment=[0:65210]) to (offset=386 segment=[0:65368]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,595] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,595] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,595] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,595] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,595] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905595, txnLastUpdateTimestamp=1602759905595) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,595] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905595, txnLastUpdateTimestamp=1602759905595) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,595] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=49) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.605,requestQueueTime:0.025,localTime:0.502,remoteTime:0.0,throttleTime:0.019,responseQueueTime:0.019,sendTime:0.058,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,596] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905595, txnLastUpdateTimestamp=1602759905596) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,596] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=190 segment=[0:21945])) (kafka.log.Log)
[2020-10-15 11:05:05,596] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=190 segment=[0:21945]) to (offset=191 segment=[0:22098]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,596] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,596] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,596] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,596] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,596] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=386 segment=[0:65368]) to (offset=387 segment=[0:65562]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,596] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,596] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,596] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,596] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,596] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905595, txnLastUpdateTimestamp=1602759905596) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,596] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905595, txnLastUpdateTimestamp=1602759905596) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,596] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=50) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.571,requestQueueTime:0.03,localTime:0.496,remoteTime:0.0,throttleTime:0.036,responseQueueTime:0.009,sendTime:0.035,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,596] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=39) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=4,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=96,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.882,requestQueueTime:0.033,localTime:0.737,remoteTime:0.0,throttleTime:0.063,responseQueueTime:0.027,sendTime:0.083,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,601] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=190 segment=[0:14630])) (kafka.log.Log)
[2020-10-15 11:05:05,601] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=190 segment=[0:14630]) to (offset=191 segment=[0:14706]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,601] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,601] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,601] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,601] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,601] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=40) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=190,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.614,requestQueueTime:0.048,localTime:0.486,remoteTime:0.0,throttleTime:0.054,responseQueueTime:0.018,sendTime:0.06,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,601] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905595, txnLastUpdateTimestamp=1602759905601) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,601] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=387 segment=[0:65562]) to (offset=388 segment=[0:65756]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,601] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,601] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,601] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,601] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,602] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905595, txnLastUpdateTimestamp=1602759905601) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,602] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905595, txnLastUpdateTimestamp=1602759905601) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,602] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905595, txnLastUpdateTimestamp=1602759905602) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,602] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=51) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.654,requestQueueTime:0.045,localTime:0.528,remoteTime:0.0,throttleTime:0.024,responseQueueTime:0.029,sendTime:0.051,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,602] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,602] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=191 segment=[0:14706]) to (offset=192 segment=[0:14784]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,603] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,603] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,603] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,603] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,603] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=21) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=190,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=192,last_stable_offset=192,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=14630, end=14784)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:14.615,requestQueueTime:0.068,localTime:0.226,remoteTime:14.073,throttleTime:0.108,responseQueueTime:0.017,sendTime:0.12,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,603] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,603] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=191 segment=[0:22098]) to (offset=192 segment=[0:22176]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,603] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,603] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,603] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,603] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,603] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,603] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 11:05:05,603] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=95) -- {transaction_markers=[{producer_id=0,producer_epoch=4,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.243,requestQueueTime:0.056,localTime:1.085,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.046,sendTime:0.054,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:05,604] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759905603, latencyMs=1, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=95), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@4442f9c4) from node 1001 with correlation id 95 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 11:05:05,604] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=4, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759905595, txnLastUpdateTimestamp=1602759905601) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 11:05:05,604] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=388 segment=[0:65756]) to (offset=389 segment=[0:65885]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,604] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,604] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,604] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,604] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,604] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905595, txnLastUpdateTimestamp=1602759905602) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,604] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905595, txnLastUpdateTimestamp=1602759905602) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,604] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,608] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=96 segment=[0:6862]) to (offset=97 segment=[0:6934]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,608] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,608] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,608] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,608] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,608] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,609] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=24) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=96,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=97,last_stable_offset=97,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=72, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=6862, end=6934)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:14.016,requestQueueTime:0.045,localTime:0.104,remoteTime:13.611,throttleTime:0.055,responseQueueTime:0.039,sendTime:0.159,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,609] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=20) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=96,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46530-11;totalTime:0.592,requestQueueTime:0.034,localTime:0.514,remoteTime:0.0,throttleTime:0.156,responseQueueTime:0.015,sendTime:0.028,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,609] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,609] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905609, txnLastUpdateTimestamp=1602759905609) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,609] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=389 segment=[0:65885]) to (offset=390 segment=[0:66043]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,609] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,609] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,609] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,609] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,609] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905609, txnLastUpdateTimestamp=1602759905609) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,609] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905609, txnLastUpdateTimestamp=1602759905609) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,609] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=52) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.579,requestQueueTime:0.023,localTime:0.482,remoteTime:0.0,throttleTime:0.019,responseQueueTime:0.024,sendTime:0.048,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,610] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905609, txnLastUpdateTimestamp=1602759905610) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,610] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=192 segment=[0:22176])) (kafka.log.Log)
[2020-10-15 11:05:05,610] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=192 segment=[0:22176]) to (offset=193 segment=[0:22329]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,610] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,610] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,610] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,610] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,610] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=390 segment=[0:66043]) to (offset=391 segment=[0:66237]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,610] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,610] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,610] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,610] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,610] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=41) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=4,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=97,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.76,requestQueueTime:0.027,localTime:0.652,remoteTime:0.0,throttleTime:0.049,responseQueueTime:0.028,sendTime:0.052,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,610] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905609, txnLastUpdateTimestamp=1602759905610) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,610] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905609, txnLastUpdateTimestamp=1602759905610) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,610] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=53) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.656,requestQueueTime:0.029,localTime:0.554,remoteTime:0.0,throttleTime:0.05,responseQueueTime:0.021,sendTime:0.05,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,615] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=192 segment=[0:14784])) (kafka.log.Log)
[2020-10-15 11:05:05,615] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=192 segment=[0:14784]) to (offset=193 segment=[0:14860]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,615] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,615] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,615] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,615] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,615] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=42) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=192,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.728,requestQueueTime:0.042,localTime:0.598,remoteTime:0.0,throttleTime:0.039,responseQueueTime:0.026,sendTime:0.061,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,615] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905609, txnLastUpdateTimestamp=1602759905615) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,616] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=391 segment=[0:66237]) to (offset=392 segment=[0:66431]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,616] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,616] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,616] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,616] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,616] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905609, txnLastUpdateTimestamp=1602759905615) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,616] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905609, txnLastUpdateTimestamp=1602759905615) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,616] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905609, txnLastUpdateTimestamp=1602759905616) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,616] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=54) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.426,requestQueueTime:0.031,localTime:0.327,remoteTime:0.0,throttleTime:0.012,responseQueueTime:0.016,sendTime:0.05,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,616] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,616] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=193 segment=[0:14860]) to (offset=194 segment=[0:14938]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,617] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,617] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,617] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,617] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,617] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,617] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=193 segment=[0:22329]) to (offset=194 segment=[0:22407]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,617] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,617] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,617] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,617] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,617] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=22) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=192,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=194,last_stable_offset=194,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=14784, end=14938)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:13.941,requestQueueTime:0.038,localTime:0.131,remoteTime:13.465,throttleTime:0.11,responseQueueTime:0.023,sendTime:0.173,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,617] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 11:05:05,617] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,617] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=96) -- {transaction_markers=[{producer_id=0,producer_epoch=4,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.126,requestQueueTime:0.043,localTime:0.978,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.047,sendTime:0.056,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:05,617] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759905617, latencyMs=1, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=96), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@164ed96) from node 1001 with correlation id 96 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 11:05:05,617] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=4, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759905609, txnLastUpdateTimestamp=1602759905615) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 11:05:05,618] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=392 segment=[0:66431]) to (offset=393 segment=[0:66560]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,618] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,618] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,618] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,618] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,618] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905609, txnLastUpdateTimestamp=1602759905616) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,618] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905609, txnLastUpdateTimestamp=1602759905616) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,618] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,622] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=97 segment=[0:6934]) to (offset=98 segment=[0:7006]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,622] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,623] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,623] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,623] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,623] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,623] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=21) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=97,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46530-11;totalTime:0.624,requestQueueTime:0.048,localTime:0.486,remoteTime:0.0,throttleTime:0.023,responseQueueTime:0.028,sendTime:0.059,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,623] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=25) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=97,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=98,last_stable_offset=98,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=72, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=6934, end=7006)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:13.969,requestQueueTime:0.033,localTime:0.088,remoteTime:13.61,throttleTime:0.08,responseQueueTime:0.022,sendTime:0.132,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,623] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,623] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905623, txnLastUpdateTimestamp=1602759905623) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,623] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=393 segment=[0:66560]) to (offset=394 segment=[0:66718]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,623] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,623] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,623] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,623] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,623] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905623, txnLastUpdateTimestamp=1602759905623) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,623] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905623, txnLastUpdateTimestamp=1602759905623) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,623] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=55) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.574,requestQueueTime:0.018,localTime:0.478,remoteTime:0.0,throttleTime:0.021,responseQueueTime:0.022,sendTime:0.055,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,624] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905623, txnLastUpdateTimestamp=1602759905624) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,624] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=194 segment=[0:22407])) (kafka.log.Log)
[2020-10-15 11:05:05,624] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=194 segment=[0:22407]) to (offset=195 segment=[0:22560]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,624] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,624] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,624] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,624] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,624] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=394 segment=[0:66718]) to (offset=395 segment=[0:66912]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,624] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,624] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,624] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,624] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,624] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905623, txnLastUpdateTimestamp=1602759905624) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,624] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905623, txnLastUpdateTimestamp=1602759905624) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,624] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=56) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.596,requestQueueTime:0.021,localTime:0.52,remoteTime:0.0,throttleTime:0.033,responseQueueTime:0.013,sendTime:0.04,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,625] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=43) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=4,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=98,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:1.039,requestQueueTime:0.034,localTime:0.953,remoteTime:0.0,throttleTime:0.122,responseQueueTime:0.018,sendTime:0.032,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,629] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=194 segment=[0:14938])) (kafka.log.Log)
[2020-10-15 11:05:05,629] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=194 segment=[0:14938]) to (offset=195 segment=[0:15014]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,629] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,629] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,629] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,629] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,629] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=44) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=194,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.431,requestQueueTime:0.036,localTime:0.327,remoteTime:0.0,throttleTime:0.018,responseQueueTime:0.015,sendTime:0.051,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,629] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905623, txnLastUpdateTimestamp=1602759905629) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,629] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=395 segment=[0:66912]) to (offset=396 segment=[0:67106]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,629] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,629] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,629] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,629] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,629] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905623, txnLastUpdateTimestamp=1602759905629) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,629] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905623, txnLastUpdateTimestamp=1602759905629) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,629] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905623, txnLastUpdateTimestamp=1602759905629) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,630] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=57) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.337,requestQueueTime:0.017,localTime:0.246,remoteTime:0.0,throttleTime:0.013,responseQueueTime:0.023,sendTime:0.05,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,630] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,630] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=195 segment=[0:15014]) to (offset=196 segment=[0:15092]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,630] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,630] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,630] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,630] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,631] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,631] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=195 segment=[0:22560]) to (offset=196 segment=[0:22638]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,631] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,631] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,631] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,631] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,631] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=23) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=194,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=196,last_stable_offset=196,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=14938, end=15092)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:13.52,requestQueueTime:0.081,localTime:0.119,remoteTime:13.078,throttleTime:0.101,responseQueueTime:0.019,sendTime:0.119,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,631] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,631] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 11:05:05,631] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=97) -- {transaction_markers=[{producer_id=0,producer_epoch=4,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.062,requestQueueTime:0.04,localTime:0.947,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.021,sendTime:0.052,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:05,631] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759905631, latencyMs=1, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=97), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@403bb1c1) from node 1001 with correlation id 97 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 11:05:05,631] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=4, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759905623, txnLastUpdateTimestamp=1602759905629) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 11:05:05,631] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=396 segment=[0:67106]) to (offset=397 segment=[0:67235]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,631] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,631] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,631] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,631] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,631] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905623, txnLastUpdateTimestamp=1602759905629) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,632] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905623, txnLastUpdateTimestamp=1602759905629) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,632] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,636] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=98 segment=[0:7006]) to (offset=99 segment=[0:7078]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,636] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,636] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,636] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,636] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,636] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,636] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=26) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=98,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=99,last_stable_offset=99,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=72, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=7006, end=7078)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:13.527,requestQueueTime:0.041,localTime:0.093,remoteTime:13.133,throttleTime:0.11,responseQueueTime:0.022,sendTime:0.125,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,637] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,637] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=22) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=98,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46530-11;totalTime:0.774,requestQueueTime:0.035,localTime:0.619,remoteTime:0.0,throttleTime:0.03,responseQueueTime:0.031,sendTime:0.088,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,637] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905637, txnLastUpdateTimestamp=1602759905637) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,637] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=397 segment=[0:67235]) to (offset=398 segment=[0:67393]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,637] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,637] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,637] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,637] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,637] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905637, txnLastUpdateTimestamp=1602759905637) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,637] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905637, txnLastUpdateTimestamp=1602759905637) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,637] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=58) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.472,requestQueueTime:0.022,localTime:0.38,remoteTime:0.0,throttleTime:0.019,responseQueueTime:0.019,sendTime:0.049,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,638] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905637, txnLastUpdateTimestamp=1602759905638) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,638] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=398 segment=[0:67393]) to (offset=399 segment=[0:67587]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,638] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,638] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,638] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,638] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=196 segment=[0:22638])) (kafka.log.Log)
[2020-10-15 11:05:05,638] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=196 segment=[0:22638]) to (offset=197 segment=[0:22791]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,638] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,638] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,638] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,638] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,638] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905637, txnLastUpdateTimestamp=1602759905638) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,638] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905637, txnLastUpdateTimestamp=1602759905638) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,638] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,639] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=59) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:1.023,requestQueueTime:0.023,localTime:0.946,remoteTime:0.0,throttleTime:0.06,responseQueueTime:0.019,sendTime:0.033,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,639] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=45) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=4,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=99,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:1.613,requestQueueTime:0.036,localTime:1.503,remoteTime:0.0,throttleTime:0.049,responseQueueTime:0.023,sendTime:0.05,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,642] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=196 segment=[0:15092])) (kafka.log.Log)
[2020-10-15 11:05:05,642] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=196 segment=[0:15092]) to (offset=197 segment=[0:15168]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,642] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,642] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,642] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,642] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,642] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=46) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=196,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.54,requestQueueTime:0.039,localTime:0.43,remoteTime:0.0,throttleTime:0.033,responseQueueTime:0.02,sendTime:0.049,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,643] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905637, txnLastUpdateTimestamp=1602759905643) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,643] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=399 segment=[0:67587]) to (offset=400 segment=[0:67781]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,643] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,643] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,643] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,643] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,643] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905637, txnLastUpdateTimestamp=1602759905643) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,643] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905637, txnLastUpdateTimestamp=1602759905643) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,643] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905637, txnLastUpdateTimestamp=1602759905643) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,643] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=60) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.449,requestQueueTime:0.028,localTime:0.351,remoteTime:0.0,throttleTime:0.017,responseQueueTime:0.016,sendTime:0.053,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,644] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,644] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=197 segment=[0:15168]) to (offset=198 segment=[0:15246]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,644] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,644] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,644] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,644] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,644] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,644] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=197 segment=[0:22791]) to (offset=198 segment=[0:22869]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,644] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,644] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,644] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,644] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=24) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=196,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=198,last_stable_offset=198,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=15092, end=15246)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:13.347,requestQueueTime:0.033,localTime:0.074,remoteTime:12.999,throttleTime:0.104,responseQueueTime:0.018,sendTime:0.116,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,644] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,644] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,644] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 11:05:05,644] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=98) -- {transaction_markers=[{producer_id=0,producer_epoch=4,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.1,requestQueueTime:0.039,localTime:0.986,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.021,sendTime:0.052,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:05,644] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759905644, latencyMs=1, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=98), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@3e3637bf) from node 1001 with correlation id 98 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 11:05:05,645] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=4, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759905637, txnLastUpdateTimestamp=1602759905643) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 11:05:05,645] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=400 segment=[0:67781]) to (offset=401 segment=[0:67910]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,645] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,645] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,645] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,645] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,645] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905637, txnLastUpdateTimestamp=1602759905643) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,645] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905637, txnLastUpdateTimestamp=1602759905643) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,645] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,649] DEBUG [Partition demoinput1602758609-0 broker=1001] High watermark updated from (offset=99 segment=[0:7078]) to (offset=100 segment=[0:7150]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,650] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,650] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,650] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,650] DEBUG Request key TopicPartitionOperationKey(demoinput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,650] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,650] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=27) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=99,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=100,last_stable_offset=100,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=72, file=/bitnami/kafka/data/demoinput1602758609-0/00000000000000000000.log, start=7078, end=7150)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:13.46,requestQueueTime:0.049,localTime:0.109,remoteTime:13.06,throttleTime:0.099,responseQueueTime:0.016,sendTime:0.123,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,650] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=23) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demoinput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=99,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46530-11;totalTime:0.818,requestQueueTime:0.052,localTime:0.645,remoteTime:0.0,throttleTime:0.028,responseQueueTime:0.033,sendTime:0.087,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,650] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,650] DEBUG TransactionalId eos-transactions.py prepare transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905650, txnLastUpdateTimestamp=1602759905650) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,651] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=401 segment=[0:67910]) to (offset=402 segment=[0:68068]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,651] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,651] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,651] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,651] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,651] DEBUG TransactionalId eos-transactions.py complete transition from CompleteCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905650, txnLastUpdateTimestamp=1602759905650) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,651] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26), txnStartTimestamp=1602759905650, txnLastUpdateTimestamp=1602759905650) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,651] DEBUG Completed request:RequestHeader(apiKey=ADD_OFFSETS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=61) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,group_id=kafka-tr-issue-201011-tr},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.564,requestQueueTime:0.029,localTime:0.46,remoteTime:0.0,throttleTime:0.038,responseQueueTime:0.021,sendTime:0.052,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,651] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905650, txnLastUpdateTimestamp=1602759905651) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,651] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=198 segment=[0:22869])) (kafka.log.Log)
[2020-10-15 11:05:05,651] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=198 segment=[0:22869]) to (offset=199 segment=[0:23022]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,651] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,651] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,651] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,651] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,651] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=402 segment=[0:68068]) to (offset=403 segment=[0:68262]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,651] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,651] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,651] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,652] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,652] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905650, txnLastUpdateTimestamp=1602759905651) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,652] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=Ongoing, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905650, txnLastUpdateTimestamp=1602759905651) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,652] DEBUG Completed request:RequestHeader(apiKey=ADD_PARTITIONS_TO_TXN, apiVersion=0, clientId=rdkafka, correlationId=62) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,topics=[{topic=demooutput1602758609,partitions=[0]}]},response:{throttle_time_ms=0,errors=[{topic=demooutput1602758609,partition_errors=[{partition=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.561,requestQueueTime:0.025,localTime:0.487,remoteTime:0.0,throttleTime:0.043,responseQueueTime:0.014,sendTime:0.033,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,652] DEBUG Completed request:RequestHeader(apiKey=TXN_OFFSET_COMMIT, apiVersion=0, clientId=rdkafka, correlationId=47) -- {transactional_id=eos-transactions.py,group_id=kafka-tr-issue-201011-tr,producer_id=0,producer_epoch=4,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,committed_offset=100,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demoinput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.86,requestQueueTime:0.056,localTime:0.734,remoteTime:0.0,throttleTime:0.052,responseQueueTime:0.021,sendTime:0.046,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,656] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to Some((offset=198 segment=[0:15246])) (kafka.log.Log)
[2020-10-15 11:05:05,656] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=198 segment=[0:15246]) to (offset=199 segment=[0:15322]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,656] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,656] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,656] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,656] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,657] DEBUG Completed request:RequestHeader(apiKey=PRODUCE, apiVersion=7, clientId=rdkafka, correlationId=48) -- {acks=-1,timeout=5000,numPartitions=1},response:{responses=[{topic=demooutput1602758609,partition_responses=[{partition=0,error_code=0,base_offset=198,log_append_time=-1,log_start_offset=0}]}],throttle_time_ms=0} from connection 172.31.31.3:9092-172.31.31.254:46536-12;totalTime:0.591,requestQueueTime:0.037,localTime:0.51,remoteTime:0.0,throttleTime:0.037,responseQueueTime:0.015,sendTime:0.028,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,657] DEBUG TransactionalId eos-transactions.py prepare transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905650, txnLastUpdateTimestamp=1602759905657) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,657] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=403 segment=[0:68262]) to (offset=404 segment=[0:68456]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,657] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,657] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,657] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,657] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,657] DEBUG TransactionalId eos-transactions.py complete transition from Ongoing to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905650, txnLastUpdateTimestamp=1602759905657) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,657] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=PrepareCommit, topicPartitions=Set(__consumer_offsets-26, demooutput1602758609-0), txnStartTimestamp=1602759905650, txnLastUpdateTimestamp=1602759905657) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,657] DEBUG TransactionalId eos-transactions.py prepare transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905650, txnLastUpdateTimestamp=1602759905657) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,657] DEBUG Completed request:RequestHeader(apiKey=END_TXN, apiVersion=1, clientId=rdkafka, correlationId=63) -- {transactional_id=eos-transactions.py,producer_id=0,producer_epoch=4,committed=true},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46540-13;totalTime:0.588,requestQueueTime:0.029,localTime:0.489,remoteTime:0.0,throttleTime:0.023,responseQueueTime:0.018,sendTime:0.05,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,658] DEBUG [Log partition=demooutput1602758609-0, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,658] DEBUG [Partition demooutput1602758609-0 broker=1001] High watermark updated from (offset=199 segment=[0:15322]) to (offset=200 segment=[0:15400]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,658] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:05,658] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 1 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,658] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,658] DEBUG Request key TopicPartitionOperationKey(demooutput1602758609,0) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,658] DEBUG [Log partition=__consumer_offsets-26, dir=/bitnami/kafka/data] First unstable offset updated to None (kafka.log.Log)
[2020-10-15 11:05:05,658] DEBUG [Partition __consumer_offsets-26 broker=1001] High watermark updated from (offset=199 segment=[0:23022]) to (offset=200 segment=[0:23100]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,658] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,658] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,658] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=25) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=198,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=200,last_stable_offset=200,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=FileRecords(size=154, file=/bitnami/kafka/data/demooutput1602758609-0/00000000000000000000.log, start=15246, end=15400)}]}]} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:14.212,requestQueueTime:0.036,localTime:0.122,remoteTime:13.778,throttleTime:0.128,responseQueueTime:0.026,sendTime:0.119,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,658] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,659] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,659] DEBUG Created a new full FetchContext with 1 partition(s). Will not try to create a new session. (kafka.server.FetchManager)
[2020-10-15 11:05:05,659] DEBUG Scheduling task handleTxnCompletion-0 with initial delay 0 ms and period -1 ms. (kafka.utils.KafkaScheduler)
[2020-10-15 11:05:05,659] DEBUG Completed request:RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=99) -- {transaction_markers=[{producer_id=0,producer_epoch=4,transaction_result=true,topics=[{topic=demooutput1602758609,partitions=[0]},{topic=__consumer_offsets,partitions=[26]}],coordinator_epoch=0}]},response:{transaction_markers=[{producer_id=0,topics=[{topic=demooutput1602758609,partitions=[{partition=0,error_code=0}]},{topic=__consumer_offsets,partitions=[{partition=26,error_code=0}]}]}]} from connection 172.31.31.3:9092-172.31.31.3:52940-10;totalTime:1.32,requestQueueTime:0.04,localTime:1.201,remoteTime:0.0,throttleTime:0.0,responseQueueTime:0.02,sendTime:0.058,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=unknown, softwareVersion=unknown) (kafka.request.logger)
[2020-10-15 11:05:05,659] DEBUG [Transaction Marker Request Completion Handler 1001]: Received WriteTxnMarker response ClientResponse(receivedTimeMs=1602759905659, latencyMs=2, disconnected=false, requestHeader=RequestHeader(apiKey=WRITE_TXN_MARKERS, apiVersion=0, clientId=broker-1001-txn-marker-sender, correlationId=99), responseBody=org.apache.kafka.common.requests.WriteTxnMarkersResponse@6de97564) from node 1001 with correlation id 99 (kafka.coordinator.transaction.TransactionMarkerRequestCompletionHandler)
[2020-10-15 11:05:05,659] DEBUG [Transaction Marker Channel Manager 1001]: Sending eos-transactions.py's transaction markers for TransactionMetadata(transactionalId=eos-transactions.py, producerId=0, producerEpoch=4, txnTimeoutMs=60000, state=PrepareCommit, pendingState=Some(CompleteCommit), topicPartitions=Set(), txnStartTimestamp=1602759905650, txnLastUpdateTimestamp=1602759905657) with coordinator epoch 0 succeeded, trying to append complete transaction log now (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2020-10-15 11:05:05,660] DEBUG [SocketServer brokerId=1001] Connection with /172.31.31.254 disconnected (org.apache.kafka.common.network.Selector)
java.io.EOFException
	at org.apache.kafka.common.network.NetworkReceive.readFrom(NetworkReceive.java:97)
	at org.apache.kafka.common.network.KafkaChannel.receive(KafkaChannel.java:448)
	at org.apache.kafka.common.network.KafkaChannel.read(KafkaChannel.java:398)
	at org.apache.kafka.common.network.Selector.attemptRead(Selector.java:678)
	at org.apache.kafka.common.network.Selector.pollSelectionKeys(Selector.java:580)
	at org.apache.kafka.common.network.Selector.poll(Selector.java:485)
	at kafka.network.Processor.poll(SocketServer.scala:861)
	at kafka.network.Processor.run(SocketServer.scala:760)
	at java.base/java.lang.Thread.run(Thread.java:834)
[2020-10-15 11:05:05,660] DEBUG [SocketServer brokerId=1001] Connection with /172.31.31.254 disconnected (org.apache.kafka.common.network.Selector)
java.io.EOFException
	at org.apache.kafka.common.network.NetworkReceive.readFrom(NetworkReceive.java:97)
	at org.apache.kafka.common.network.KafkaChannel.receive(KafkaChannel.java:448)
	at org.apache.kafka.common.network.KafkaChannel.read(KafkaChannel.java:398)
	at org.apache.kafka.common.network.Selector.attemptRead(Selector.java:678)
	at org.apache.kafka.common.network.Selector.pollSelectionKeys(Selector.java:580)
	at org.apache.kafka.common.network.Selector.poll(Selector.java:485)
	at kafka.network.Processor.poll(SocketServer.scala:861)
	at kafka.network.Processor.run(SocketServer.scala:760)
	at java.base/java.lang.Thread.run(Thread.java:834)
[2020-10-15 11:05:05,660] DEBUG [SocketServer brokerId=1001] Connection with /172.31.31.254 disconnected (org.apache.kafka.common.network.Selector)
java.io.EOFException
	at org.apache.kafka.common.network.NetworkReceive.readFrom(NetworkReceive.java:97)
	at org.apache.kafka.common.network.KafkaChannel.receive(KafkaChannel.java:448)
	at org.apache.kafka.common.network.KafkaChannel.read(KafkaChannel.java:398)
	at org.apache.kafka.common.network.Selector.attemptRead(Selector.java:678)
	at org.apache.kafka.common.network.Selector.pollSelectionKeys(Selector.java:580)
	at org.apache.kafka.common.network.Selector.poll(Selector.java:485)
	at kafka.network.Processor.poll(SocketServer.scala:861)
	at kafka.network.Processor.run(SocketServer.scala:760)
	at java.base/java.lang.Thread.run(Thread.java:834)
[2020-10-15 11:05:05,660] DEBUG [Partition __transaction_state-26 broker=1001] High watermark updated from (offset=404 segment=[0:68456]) to (offset=405 segment=[0:68585]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,660] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,660] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,661] DEBUG Request key TopicPartitionOperationKey(__transaction_state,26) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,661] DEBUG Request key MemberKey(kafka-tr-issue-201011-pr,rdkafka-a431afa2-c280-4b2b-ae77-52d6aadc21bd) unblocked 1 Heartbeat operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,661] DEBUG [ReplicaManager broker=1001] Produce to local log in 1 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,661] DEBUG TransactionalId eos-transactions.py complete transition from PrepareCommit to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905650, txnLastUpdateTimestamp=1602759905657) (kafka.coordinator.transaction.TransactionMetadata)
[2020-10-15 11:05:05,661] DEBUG [Transaction State Manager 1001]: Updating eos-transactions.py's transaction state to TxnTransitMetadata(producerId=0, lastProducerId=0, producerEpoch=4, lastProducerEpoch=-1, txnTimeoutMs=60000, txnState=CompleteCommit, topicPartitions=Set(), txnStartTimestamp=1602759905650, txnLastUpdateTimestamp=1602759905657) with coordinator epoch 0 for eos-transactions.py succeeded (kafka.coordinator.transaction.TransactionStateManager)
[2020-10-15 11:05:05,661] DEBUG Request key eos-transactions.py unblocked 1 txn-marker-purgatory operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,661] DEBUG [Partition __consumer_offsets-2 broker=1001] High watermark updated from (offset=14 segment=[0:3041]) to (offset=15 segment=[0:3194]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,661] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,2) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,661] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,2) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,661] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,2) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,661] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,661] DEBUG Completed request:RequestHeader(apiKey=OFFSET_COMMIT, apiVersion=7, clientId=rdkafka, correlationId=9) -- {group_id=kafka-tr-issue-201011-pr,generation_id=9,member_id=rdkafka-a431afa2-c280-4b2b-ae77-52d6aadc21bd,group_instance_id=null,topics=[{name=demooutput1602758609,partitions=[{partition_index=0,committed_offset=200,committed_leader_epoch=-1,committed_metadata=}]}]},response:{throttle_time_ms=0,topics=[{name=demooutput1602758609,partitions=[{partition_index=0,error_code=0}]}]} from connection 172.31.31.3:9092-172.31.31.254:46532-11;totalTime:0.97,requestQueueTime:0.036,localTime:0.85,remoteTime:0.0,throttleTime:0.056,responseQueueTime:0.022,sendTime:0.06,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,662] DEBUG Request key MemberKey(kafka-tr-issue-201011-pr,rdkafka-a431afa2-c280-4b2b-ae77-52d6aadc21bd) unblocked 1 Heartbeat operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,662] INFO [GroupCoordinator 1001]: Member[group.instance.id None, member.id rdkafka-a431afa2-c280-4b2b-ae77-52d6aadc21bd] in group kafka-tr-issue-201011-pr has left, removing it from the group (kafka.coordinator.group.GroupCoordinator)
[2020-10-15 11:05:05,662] INFO [GroupCoordinator 1001]: Preparing to rebalance group kafka-tr-issue-201011-pr in state PreparingRebalance with old generation 9 (__consumer_offsets-2) (reason: removing member rdkafka-a431afa2-c280-4b2b-ae77-52d6aadc21bd on LeaveGroup) (kafka.coordinator.group.GroupCoordinator)
[2020-10-15 11:05:05,662] INFO [GroupCoordinator 1001]: Group kafka-tr-issue-201011-pr with generation 10 is now empty (__consumer_offsets-2) (kafka.coordinator.group.GroupCoordinator)
[2020-10-15 11:05:05,662] DEBUG [Partition __consumer_offsets-2 broker=1001] High watermark updated from (offset=15 segment=[0:3194]) to (offset=16 segment=[0:3323]) (kafka.cluster.Partition)
[2020-10-15 11:05:05,662] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,2) unblocked 0 Fetch operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,662] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,2) unblocked 0 Produce operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,662] DEBUG Request key TopicPartitionOperationKey(__consumer_offsets,2) unblocked 0 DeleteRecords operations (kafka.server.DelayedOperationPurgatory)
[2020-10-15 11:05:05,662] DEBUG [ReplicaManager broker=1001] Produce to local log in 0 ms (kafka.server.ReplicaManager)
[2020-10-15 11:05:05,662] DEBUG Completed request:RequestHeader(apiKey=LEAVE_GROUP, apiVersion=1, clientId=rdkafka, correlationId=10) -- {group_id=kafka-tr-issue-201011-pr,member_id=rdkafka-a431afa2-c280-4b2b-ae77-52d6aadc21bd},response:{throttle_time_ms=0,error_code=0} from connection 172.31.31.3:9092-172.31.31.254:46532-11;totalTime:0.722,requestQueueTime:0.025,localTime:0.638,remoteTime:0.0,throttleTime:0.022,responseQueueTime:0.012,sendTime:0.046,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:05,662] DEBUG [SocketServer brokerId=1001] Connection with /172.31.31.254 disconnected (org.apache.kafka.common.network.Selector)
java.io.EOFException
	at org.apache.kafka.common.network.NetworkReceive.readFrom(NetworkReceive.java:97)
	at org.apache.kafka.common.network.KafkaChannel.receive(KafkaChannel.java:448)
	at org.apache.kafka.common.network.KafkaChannel.read(KafkaChannel.java:398)
	at org.apache.kafka.common.network.Selector.attemptRead(Selector.java:678)
	at org.apache.kafka.common.network.Selector.pollSelectionKeys(Selector.java:580)
	at org.apache.kafka.common.network.Selector.poll(Selector.java:485)
	at kafka.network.Processor.poll(SocketServer.scala:861)
	at kafka.network.Processor.run(SocketServer.scala:760)
	at java.base/java.lang.Thread.run(Thread.java:834)
[2020-10-15 11:05:05,665] DEBUG [SocketServer brokerId=1001] Connection with /172.31.31.254 disconnected (org.apache.kafka.common.network.Selector)
java.io.EOFException
	at org.apache.kafka.common.network.NetworkReceive.readFrom(NetworkReceive.java:97)
	at org.apache.kafka.common.network.KafkaChannel.receive(KafkaChannel.java:448)
	at org.apache.kafka.common.network.KafkaChannel.read(KafkaChannel.java:398)
	at org.apache.kafka.common.network.Selector.attemptRead(Selector.java:678)
	at org.apache.kafka.common.network.Selector.pollSelectionKeys(Selector.java:580)
	at org.apache.kafka.common.network.Selector.poll(Selector.java:485)
	at kafka.network.Processor.poll(SocketServer.scala:861)
	at kafka.network.Processor.run(SocketServer.scala:760)
	at java.base/java.lang.Thread.run(Thread.java:834)
[2020-10-15 11:05:06,151] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:06,151] DEBUG [SocketServer brokerId=1001] Connection with /172.31.31.254 disconnected (org.apache.kafka.common.network.Selector)
java.io.IOException: Broken pipe
	at java.base/sun.nio.ch.FileDispatcherImpl.writev0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.writev(SocketDispatcher.java:51)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:182)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:130)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:496)
	at java.base/java.nio.channels.SocketChannel.write(SocketChannel.java:507)
	at org.apache.kafka.common.network.PlaintextTransportLayer.write(PlaintextTransportLayer.java:152)
	at org.apache.kafka.common.network.ByteBufferSend.writeTo(ByteBufferSend.java:60)
	at org.apache.kafka.common.record.MultiRecordsSend.writeTo(MultiRecordsSend.java:93)
	at org.apache.kafka.common.network.KafkaChannel.write(KafkaChannel.java:426)
	at org.apache.kafka.common.network.Selector.write(Selector.java:648)
	at org.apache.kafka.common.network.Selector.attemptWrite(Selector.java:641)
	at org.apache.kafka.common.network.Selector.pollSelectionKeys(Selector.java:597)
	at org.apache.kafka.common.network.Selector.poll(Selector.java:485)
	at kafka.network.Processor.poll(SocketServer.scala:861)
	at kafka.network.Processor.run(SocketServer.scala:760)
	at java.base/java.lang.Thread.run(Thread.java:834)
[2020-10-15 11:05:06,152] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=28) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demoinput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=100,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demoinput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=100,last_stable_offset=100,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=MemoryRecords(size=0, buffer=java.nio.HeapByteBuffer[pos=0 lim=0 cap=0])}]}]} from connection 172.31.31.3:9092-172.31.31.254:46534-12;totalTime:501.671,requestQueueTime:0.03,localTime:0.127,remoteTime:500.495,throttleTime:0.303,responseQueueTime:0.133,sendTime:0.58,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
[2020-10-15 11:05:06,159] DEBUG Sessionless fetch context returning 1 partition(s) (kafka.server.SessionlessFetchContext)
[2020-10-15 11:05:06,159] DEBUG [SocketServer brokerId=1001] Connection with /172.31.31.254 disconnected (org.apache.kafka.common.network.Selector)
java.io.IOException: Broken pipe
	at java.base/sun.nio.ch.FileDispatcherImpl.writev0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.writev(SocketDispatcher.java:51)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:182)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:130)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:496)
	at java.base/java.nio.channels.SocketChannel.write(SocketChannel.java:507)
	at org.apache.kafka.common.network.PlaintextTransportLayer.write(PlaintextTransportLayer.java:152)
	at org.apache.kafka.common.network.ByteBufferSend.writeTo(ByteBufferSend.java:60)
	at org.apache.kafka.common.record.MultiRecordsSend.writeTo(MultiRecordsSend.java:93)
	at org.apache.kafka.common.network.KafkaChannel.write(KafkaChannel.java:426)
	at org.apache.kafka.common.network.Selector.write(Selector.java:648)
	at org.apache.kafka.common.network.Selector.attemptWrite(Selector.java:641)
	at org.apache.kafka.common.network.Selector.pollSelectionKeys(Selector.java:597)
	at org.apache.kafka.common.network.Selector.poll(Selector.java:485)
	at kafka.network.Processor.poll(SocketServer.scala:861)
	at kafka.network.Processor.run(SocketServer.scala:760)
	at java.base/java.lang.Thread.run(Thread.java:834)
[2020-10-15 11:05:06,159] DEBUG Completed request:RequestHeader(apiKey=FETCH, apiVersion=11, clientId=rdkafka, correlationId=26) -- {replica_id=-1,max_wait_time=500,min_bytes=1,max_bytes=52428800,isolation_level=1,session_id=0,session_epoch=-1,topics=[{topic=demooutput1602758609,partitions=[{partition=0,current_leader_epoch=-1,fetch_offset=200,log_start_offset=-1,partition_max_bytes=1048576}]}],forgotten_topics_data=[],rack_id=},response:{throttle_time_ms=0,error_code=0,session_id=0,responses=[{topic=demooutput1602758609,partition_responses=[{partition_header={partition=0,error_code=0,high_watermark=200,last_stable_offset=200,log_start_offset=0,aborted_transactions=[],preferred_read_replica=-1},record_set=MemoryRecords(size=0, buffer=java.nio.HeapByteBuffer[pos=0 lim=0 cap=0])}]}]} from connection 172.31.31.3:9092-172.31.31.254:46528-11;totalTime:500.58,requestQueueTime:0.069,localTime:0.127,remoteTime:499.905,throttleTime:0.153,responseQueueTime:0.02,sendTime:0.305,securityProtocol:PLAINTEXT,principal:User:ANONYMOUS,listener:PLAINTEXT,clientInformation:ClientInformation(softwareName=confluent-kafka-python, softwareVersion=1.5.0-rdkafka-1.5.0) (kafka.request.logger)
